define("mediaServices/services/wixMediaManager/presets",[],function(){"use strict";var a={SHAPE:{multiSelectDefault:true,canAddMediaBeforeEncodingComplete:false,tabsList:{open:["FREE_FROM_WIX"],manage:[],default:"FREE_FROM_WIX"},socialNetworksList:[],mmgrParams:{i18nPrefix:["shape","multiple_shapes"],mediaType:"picture",publicMediaRoot:"shapes",videoEncodingProfile:""}},IMAGE:{multiSelectDefault:true,canAddMediaBeforeEncodingComplete:false,tabsList:{open:["MY_IMAGE","MY_NETWORK","FREE_FROM_WIX","BIG_STOCK"],manage:["MY_IMAGE"],default:"MY_IMAGE"},socialNetworksList:["FACEBOOK","INSTAGRAM","DROPBOX","GOOGLE_DRIVE","FLICKR","PICASA"],mmgrParams:{i18nPrefix:["single_image","multiple_images"],mediaType:"picture",publicMediaRoot:"photos",videoEncodingProfile:""}},VIDEO:{multiSelectDefault:false,canAddMediaBeforeEncodingComplete:true,tabsList:{open:["MY_VIDEO"],manage:["MY_VIDEO"],default:"MY_VIDEO"},socialNetworksList:[],mmgrParams:{i18nPrefix:["video","addmultiple_video"],mediaType:"video",publicMediaRoot:"",videoEncodingProfile:"mp4-storyboard"}},MUSIC:{multiSelectDefault:true,canAddMediaBeforeEncodingComplete:false,tabsList:{open:["MY_MUSIC"],manage:["MY_MUSIC"],default:"MY_MUSIC"},socialNetworksList:[],mmgrParams:{i18nPrefix:["music","addmultiple_music"],mediaType:"music",publicMediaRoot:"",videoEncodingProfile:""}},MUSIC_PRO:{multiSelectDefault:true,canAddMediaBeforeEncodingComplete:false,tabsList:{open:["MY_MUSIC_PRO"],manage:["MY_MUSIC_PRO"],default:"MY_MUSIC_PRO"},socialNetworksList:[],mmgrParams:{i18nPrefix:["secure_music","addmultiple_secure_music"],mediaType:"secure_music",publicMediaRoot:"",videoEncodingProfile:""}},DOCUMENT:{multiSelectDefault:true,canAddMediaBeforeEncodingComplete:false,tabsList:{open:["MY_DOCUMENT"],manage:["MY_DOCUMENT"],default:"MY_DOCUMENT"},socialNetworksList:[],mmgrParams:{i18nPrefix:["document","addmultiple_document"],mediaType:"document",publicMediaRoot:"",videoEncodingProfile:""}},FLASH:{multiSelectDefault:false,canAddMediaBeforeEncodingComplete:false,tabsList:{open:["MY_FLASH"],manage:[],default:"MY_FLASH"},socialNetworksList:[],mmgrParams:{i18nPrefix:["flash","multiple_flash"],mediaType:"swf",publicMediaRoot:"",videoEncodingProfile:""}},CLIPART:{multiSelectDefault:false,canAddMediaBeforeEncodingComplete:false,tabsList:{open:["MY_IMAGE","MY_NETWORK","FREE_FROM_WIX","BIG_STOCK"],manage:[],default:"MY_IMAGE"},socialNetworksList:["FACEBOOK","INSTAGRAM","DROPBOX","GOOGLE_DRIVE","FLICKR","PICASA"],mmgrParams:{i18nPrefix:["clipart","addmultiple_clipart"],mediaType:"picture",publicMediaRoot:"clipart",videoEncodingProfile:""}},BG_IMAGE:{multiSelectDefault:false,canAddMediaBeforeEncodingComplete:false,tabsList:{open:["MY_IMAGE","MY_NETWORK","FREE_FROM_WIX","BIG_STOCK"],manage:[],default:"MY_IMAGE"},socialNetworksList:["FACEBOOK","INSTAGRAM","DROPBOX","GOOGLE_DRIVE","FLICKR","PICASA"],mmgrParams:{i18nPrefix:["background","multiple_background"],mediaType:"picture",publicMediaRoot:"backgrounds",videoEncodingProfile:""}},BG_VIDEO:{multiSelectDefault:false,canAddMediaBeforeEncodingComplete:true,tabsList:{open:["MY_VIDEO","FREE_FROM_WIX"],manage:[],default:"MY_VIDEO"},socialNetworksList:[],mmgrParams:{i18nPrefix:["video","addmultiple_video"],mediaType:"video",publicMediaRoot:"videos",videoEncodingProfile:"mp4-storyboard"}},ICON_DOCUMENT:{multiSelectDefault:false,canAddMediaBeforeEncodingComplete:false,tabsList:{open:["MY_IMAGE","MY_NETWORK","FREE_FROM_WIX","BIG_STOCK"],manage:[],default:"FREE_FROM_WIX"},socialNetworksList:["FACEBOOK","INSTAGRAM","DROPBOX","GOOGLE_DRIVE","FLICKR","PICASA"],mmgrParams:{i18nPrefix:["single_icon","multiple_icons"],mediaType:"picture",publicMediaRoot:"file_icons",videoEncodingProfile:""}},ICON_SOCIAL:{multiSelectDefault:true,canAddMediaBeforeEncodingComplete:false,tabsList:{open:["MY_IMAGE","MY_NETWORK","FREE_FROM_WIX","BIG_STOCK"],manage:[],default:"FREE_FROM_WIX"},socialNetworksList:["FACEBOOK","INSTAGRAM","DROPBOX","GOOGLE_DRIVE","FLICKR","PICASA"],mmgrParams:{i18nPrefix:["single_icon","multiple_icons"],mediaType:"picture",publicMediaRoot:"social_icons",videoEncodingProfile:""}},ICON_FAVICON:{multiSelectDefault:false,canAddMediaBeforeEncodingComplete:false,tabsList:{open:["MY_FAVICON","BIG_STOCK"],manage:[],default:"MY_FAVICON"},socialNetworksList:[],mmgrParams:{i18nPrefix:["favicon","multiple_favicons"],mediaType:"site_icon",publicMediaRoot:"",videoEncodingProfile:""}}};return a});define("mediaServices/services/wixMediaManager/constants",["util"],function(a){"use strict";return{BASE_HOST:a.serviceTopology.baseDomain,MMGR_BASE_URL:a.serviceTopology.mediaManagerUrl,MMGR_LANGUAGE_CODE:a.editorModel.languageCode,MMGR_WINDOW_STYLE:"fullscreen",MMGR_SELECTION_TYPE:["single","multiple"],MMGR_TRANSLATION_KEYS_MAP:{description:{private:"private_media.upload_restrictions_header_message",external:"social_images.upload_restrictions_header_message",public:"free_from_wix.upload_restrictions_header_message",photoStock:"bigstock_images.upload_restrictions_header_message"},title:"header",submitButton:"footer.submit",uploadButton:"uploader.upload"},MMGR_SERVICES_LIST_MAP:{FACEBOOK:"facebook",FLICKR:"flickr",INSTAGRAM:"instagram",PICASA:"picasa",GOOGLE_DRIVE:"drive",DROPBOX:"dropbox"},SINGLE:0,MULTIPLE:1,MMGR_MEDIA_TYPES:{SHAPE:"picture",IMAGE:"picture",VIDEO:"video",MP3:"music",MUSIC:"secure_music",DOC:"document",FLASH:"swf",FAVICON:"site_icon"},MMGR_TABS_MAP:{MY_SHAPE:"private",MY_IMAGE:"private",MY_IMAGE_PRO:"private",MY_VIDEO:"private",MY_VIDEO_PRO:"private",MY_MUSIC:"private",MY_MUSIC_PRO:"private",MY_DOCUMENT:"private",MY_DOCUMENT_PRO:"private",MY_FLASH:"private",MY_FAVICON:"private",MY_NETWORK:"external",FREE_FROM_WIX:"public",BIG_STOCK:"photoStock"}}});define("mediaServices/services/wixMediaManager/mmgrUtils",["lodash","mediaServices/services/wixMediaManager/constants","util"],function(a,b,c){"use strict";function d(a){return a.categoryData.mmgrParams.mediaType}function e(a){return b.MMGR_SELECTION_TYPE[a.multiSelect?b.MULTIPLE:b.SINGLE]}function f(a){var c=a.categoryData.mmgrParams.i18nPrefix;return c[a.multiSelect?b.MULTIPLE:b.SINGLE]}function g(b){var c=a.clone(b.manageMode?b.categoryData.tabsList.manage:b.categoryData.tabsList.open);for(var d=0;d<c.length;d++){c[d]=k(c[d])}return c}function h(c){var d=a.clone(c.categoryData.socialNetworksList);for(var e=0;e<d.length;e++){d[e]=b.MMGR_SERVICES_LIST_MAP[d[e]]}return d}function i(d){var e={};var f;var g=d.manageMode?d.categoryData.tabsList.manage:d.categoryData.tabsList.open;var h=d.multiSelect?"_MULTISELECT":"";f=("MMGR_API_"+d.categoryName+(d.manageMode?"_MANAGE":"_OPEN")+"_TITLE"+(d.manageMode?"":h)).toUpperCase();e[b.MMGR_TRANSLATION_KEYS_MAP.title]=d.translation.title||c.translate(f);f=("MMGR_API_"+d.categoryName+"_UPLOAD_BUTTON").toUpperCase();e[b.MMGR_TRANSLATION_KEYS_MAP.uploadButton]=c.translate(f);f=("MMGR_API_"+d.categoryName+"_SUBMIT_BUTTON"+h).toUpperCase();e[b.MMGR_TRANSLATION_KEYS_MAP.submitButton]=d.translation.submitButton||c.translate(f);a.forEach(g,function(a){var d=b.MMGR_TRANSLATION_KEYS_MAP.description[k(a)];f=("MMGR_API_"+a+"_DESCRIPTION").toUpperCase();e[d]=c.translate(f)});return e}function j(a){return a.categoryData.mmgrParams.videoEncodingProfile}function k(a){return b.MMGR_TABS_MAP[a]}return{getMMGRMediaType:d,getMMGRSelectionType:e,getMMGRI18nPrefix:f,getMMGRTabsList:g,getMMGRServicesList:h,getMMGRTranslations:i,getMMGRVideoEncodingProfile:j}});define("mediaServices/services/wixMediaManager/adapter",["lodash","jquery","mediaServices/services/wixMediaManager/presets","mediaServices/services/wixMediaManager/constants","mediaServices/services/wixMediaManager/mmgrUtils","pLoader!santa:utils"],function(a,b,c,d,e,f){"use strict";function g(a,b,e){e=e||{};var g=c[b];var h={categoryName:b,categoryData:g,multiSelect:false,path:e.path||d.MMGR_TABS_MAP[g.tabsList.default],translation:{},siteMediaToken:a.siteMediaToken,isEmailWithWixDomain:a.isEmailWithWixDomain,manageMode:true};if(e.translation&&e.translation.title){h.translation.title=e.translation.title}if(e.callback){h.callback=e.callback}if(g.tabsList.manage.length>0){i(h)}else{f.log.error(b+" is an un-managed category")}}function h(a,b,e){e=e||{};var f=c[b];var g={categoryName:b,categoryData:f,multiSelect:e.multiSelect===undefined?f.multiSelectDefault:e.multiSelect,path:e.path||d.MMGR_TABS_MAP[f.tabsList.default],translation:{},siteMediaToken:a.siteMediaToken,isEmailWithWixDomain:a.isEmailWithWixDomain,manageMode:false};if(e.callback){g.callback=function(){e.callback.apply(null,arguments);window.focus()}}if(e.translation){if(e.translation.title){g.translation.title=e.translation.title}if(e.translation.submitButton){g.translation.submitButton=e.translation.submitButton}}i(g)}function i(a){var b=l();var c={mediaGalleryBaseHost:d.MMGR_BASE_URL,baseHost:d.BASE_HOST,i18nCode:d.MMGR_LANGUAGE_CODE,windowStyle:d.MMGR_WINDOW_STYLE,selectionType:e.getMMGRSelectionType(a),mediaType:e.getMMGRMediaType(a),i18nPrefix:e.getMMGRI18nPrefix(a),canShowSelectButton:!a.manageMode,canSubmitUntranscoded:a.categoryData.canAddMediaBeforeEncodingComplete,tabsList:e.getMMGRTabsList(a),path:a.path,siteMediaToken:a.siteMediaToken,isEmailWithWixDomain:a.isEmailWithWixDomain};if(a.categoryData.mmgrParams.publicMediaRoot){c.publicMediaRoot=a.categoryData.mmgrParams.publicMediaRoot}if(a.categoryData.socialNetworksList.length>0){c.servicesList=e.getMMGRServicesList(a)}c.translations=e.getMMGRTranslations(a);if(e.getMMGRMediaType(a)===d.MMGR_MEDIA_TYPES.VIDEO){c.videoEncodingProfile=e.getMMGRVideoEncodingProfile(a)}function f(c){if(a.callback){var d=c&&c.items||null;var e=d&&{path:c.path}||null;a.callback(d,e)}b.off("close",f);b.off("items",f);j()}b.on("items",f).on("close",f);b.open(c);window.document.getElementById("mediaGalleryFrame").contentWindow.focus()}function j(){var a=b("#editor");if(a){var c=b(window);var d=c.scrollTop();a.trigger("focus");c.scrollTop(d)}}function k(){var b={};a.forEach(a.keys(c),function(a){a=a.toUpperCase();b[a]=a});return b}function l(){return window.MediaFrame}return{open:h,presets:c,manage:g,categories:k()}});define("mediaServices/services/fontsManager/fontsUploader",["lodash","wixmp","util"],function(a,b,c){"use strict";function d(d,e){if(d){var f=a.map(e,function(a){return{uploadFn:d.item.upload,source:{file:a,name:a.name,size:a.size,folderId:null,folderName:"All Media",mediaType:c.fontsManagerUtils.constants.FONTS_MEDIA_TYPE}}});b.Uploader.upload(f)}}function e(a){b.Uploader.on("fileStatusChanged",function(b){a(b)})}function f(a){b.Uploader.on("queueChanged",function(b){a(b)})}function g(){if(!b.Uploader.uploadIsInProgress){b.Uploader.clearQueue()}}function h(){return b.Uploader.uploadQueue}function i(a){var b=false;if(a.canAbort()){try{a.abort();b=true}catch(a){b=false}}return b}function j(){if(!a.isEmpty(b.Uploader.uploadQueue)&b.Uploader.uploadIsInProgress){b.Uploader.upload()}}return{upload:d,clearUploadQueue:g,getUploadQueue:h,cancelUpload:i,retryUpload:j,registerToFileStatusChanged:e,registerToQueueChange:f}});define("mediaServices/services/fontsManager/fontsManager",["lodash","wixmp","util","mediaServices/services/fontsManager/fontsUploader"],function(a,b,c,d){"use strict";var e=new b.Source(b.sources.PRIVATE);var f={};var g={};var h=c.fontsManagerUtils.constants;function i(b){return a.map(b,function(a){return c.fontsManagerUtils.getUploadedFontData(a)})}function j(){k();d.registerToFileStatusChanged(o);d.registerToQueueChange(p);r()}function k(){return e.items.list(null,{mediaType:h.FONTS_MEDIA_TYPE}).then(function(a){g=i(a.data);l(h.FONT_EVENTS_NAMES.LIST_CHANGED,g)})}function l(b,c){a.forEach(f[b],function(a){a(c)})}function m(a,b){if(f[a]){f[a].push(b)}else{f[a]=[b]}}function n(b,c){f[b]=a.reject(f[b],function(a){return a===c})}function o(a){if(a.currentFileProgress.status===h.FONT_STATUS.SUCCEEDED){k()}l(h.FONT_EVENTS_NAMES.FILE_CHANGED,a)}function p(a){l(h.FONT_EVENTS_NAMES.QUEUE_CHANGED,a)}function q(){return g}function r(){b.events.on(b.events.ITEMS.REMOVE,function(b){a.forEach(b,function(a){a.then(k).catch()})})}function s(a){e.items.remove(a)}function t(a){d.upload(e,a)}return{registerObserver:m,unregisterObserver:n,getList:q,remove:s,init:j,uploader:{upload:t,clearUploadQueue:d.clearUploadQueue,getUploadQueue:d.getUploadQueue,cancelUpload:d.cancelUpload,retryUpload:d.retryUpload}}});define("mediaServices",["lodash","mediaServices/services/wixMediaManager/adapter","mediaServices/services/fontsManager/fontsManager"],function(a,b,c){"use strict";function d(){this.mediaData={siteMediaToken:"",isEmailWithWixDomain:false};this.fontsManager=c;this.mediaManager={manage:b.manage.bind(null,this.mediaData),open:b.open.bind(null,this.mediaData),presets:b.presets,categories:b.categories}}d.prototype=a.create(Object.prototype,{constructor:d,setSiteMediaToken:function(a){this.mediaData.siteMediaToken=a||""},setIsEmailWithWixDomain:function(a){this.mediaData.isEmailWithWixDomain=a},getSiteMediaToken:function(){return this.mediaData.siteMediaToken}});return d});