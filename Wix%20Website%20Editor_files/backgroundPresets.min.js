define("backgroundPresets/components/backgroundPresetSection.rt",["react","lodash","baseUI","util"],function(a,b,c,d){"use strict";function e(a,b){this.selectPreset(a,"presetBackgrounds",b)}function f(b,f){return a.createElement("li",{className:"preset-list-item",key:"preset"+f,onClick:e.bind(this,b,f)},a.createElement(c.tooltip,{value:this.getMediaPreviewComp(b),alignment:"right",styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.CONTENT_ONLY,delay:"300",width:"294px",noArrow:true},a.createElement("div",{className:"preset-list-preset",style:this.getThumbBackdropStyle(b)},a.createElement("div",{className:"preset-list-preset-content",style:this.getThumbStyle(b)}),this.getMediaType(b)===this.mediaTypes.VIDEO?a.createElement("div",{style:this.getOverlayStyle(b),className:"preset-list-preset-overlay",key:"preset-list-preset-overlay"}):null,this.getMediaType(b)===this.mediaTypes.VIDEO?a.createElement("div",{className:"preset-list-preset-video-controls",key:"bgVideoIndicator"},a.createElement(c.symbol,{name:"bgVideoIndicator"})):null,b.thumbnail&&b.thumbnail.title?a.createElement("div",{key:"preset-title",className:"preset-title"},d.translate(b.thumbnail.title)):null)))}return function(){return a.createElement("div",{className:"bg-preset-list-section section-wrapper"},a.createElement("div",{className:"section-header"},a.createElement("div",{className:"title-line"},a.createElement("div",{className:"title"},this.props.title),a.createElement(c.infoIcon,{key:"infoIcon",className:"info-icon",text:this.props.infoTooltip}))),a.createElement.apply(this,["ul",{className:"preset-list-section-list "+("columns-"+(this.props.columns||1))},b.map(this.getPresetData(),f.bind(this))]))}});define("backgroundPresets/components/mediaPreview.rt",["react","lodash","util"],function(a,b,c){"use strict";function d(a,c){var d=b.assign({},a,c);if(a.hasOwnProperty("style")){d.style=b.defaults(d.style,a.style)}if(a.hasOwnProperty("className")&&c.hasOwnProperty("className")){d.className=c.className+" "+a.className}return d}function e(){var e=this.getMediaType();var f=c.backgroundPanelUtils;return a.createElement("div",{className:"media-preview-panel"},a.createElement("div",{className:b({"media-preview-wrapper":true,hide:e===this.mediaTypes.VIDEO&&!this.state.isPreviewReady,show:e===this.mediaTypes.VIDEO&&this.state.isPreviewReady}).transform(function(a,b,c){if(b){a.push(c)}},[]).join(" ")},a.createElement("div",d({className:"media-preview-color"},{style:this.getBackgroundColor()})),e===this.mediaTypes.IMAGE?a.createElement("div",d({className:"media-preview-image",key:"media-preview-image"},{style:this.getBackgroundStyle(e)})):null,e===this.mediaTypes.VIDEO?a.createElement("div",d({className:"media-preview-video-wrapper",key:"media-preview-video-wrapper"},{style:this.getVideoStyle()}),a.createElement("video",{autoPlay:true,loop:true,muted:true,preload:"none",ref:"videoInstance",className:"media-preview-video"},a.createElement("source",{src:this.getVideoSource("mp4"),type:"video/mp4"}),a.createElement("source",{src:this.getVideoSource("webm"),type:"video/webm"}))):null,a.createElement("div",{className:"media-preview-overlay",style:f.getOverlayStyle(this.props.data,this.getEditorAPI())})),a.createElement("div",{className:"media-preview-caption"},a.createElement("span",{className:"media-title"},this.getMediaCaption()),e===this.mediaTypes.VIDEO?a.createElement("span",{className:"video-duration",key:"video-duration"},this.getSecInMin()):null))}return function(){return e.apply(this,[])}});define("backgroundPresets/components/mediaPreview",["reactDOM","react","lodash","util","core","backgroundPresets/components/mediaPreview.rt"],function(a,b,c,d,e,f){"use strict";var g=270;var h=152;var i="480p";var j=d.imageTransform;var k=d.backgroundPanelUtils;function l(a){return c.find(a,{quality:i})}return b.createClass({displayName:"mediaPreview",mediaTypes:k.getMediaTypes(),mixins:[e.mixins.editorAPIMixin],getInitialState:function(){return{isPreviewReady:false}},componentWillUnmount:function(){if(this.getMediaType()===this.mediaTypes.VIDEO){this.getInstance().removeEventListener("timeupdate",this.onPlaying);this.removeVideoSecurely()}},componentDidMount:function(){if(this.getMediaType()===this.mediaTypes.VIDEO){this.getInstance().addEventListener("timeupdate",this.onPlaying)}},onPlaying:function(){if(!this.state.isPreviewReady){this.setState({isPreviewReady:true})}},getInstance:function(){return a.findDOMNode(this.refs.videoInstance)},removeVideoSecurely:function(){var a=this.getInstance();a.pause();c.forEach(a.children,function(a){if(a.nodeName.toLowerCase()==="source"){a.setAttribute("src","")}});a.load()},getMediaType:function(){return k.getMediaType(this.props.data)},getBackgroundColor:function(){var a=k.getColorValue(this.getEditorAPI(),this.props.data.color);return{backgroundColor:a}},getBackgroundStyle:function(a){var b=this.props.data;var c=a===this.mediaTypes.VIDEO?b.mediaRef.posterImageRef:b.mediaRef;var e;if(b.fittingType===j.fittingTypes.LEGACY_BG_FIT_AND_TILE||b.fittingType===j.fittingTypes.TILE){var f=k.isSmallerFromContainer(c.width,c.height,g,h);e=f?j.fittingTypes.TILE:j.fittingTypes.FIT_AND_TILE}else{e=j.fittingTypes.SCALE_TO_FILL}var i=k.getImageDisplayData(e,b.alignType,c.uri,c.width,c.height,g,h,85);var l=i.css.container;l.backgroundImage="url("+d.url.joinURL(k.MEDIA_URL_PREFIX,i.uri)+")";l.opacity=c.opacity;return l},getVideoSource:function(a){var b=this.props.data.mediaRef;var c=b.videoId;var e=l(b.qualities)||b.qualities[0];return d.url.joinURL(k.VIDEO_URL_PREFIX,c,e.quality,a,"file."+a)},getVideoStyle:function(){return{width:g,height:h,opacity:this.props.data.mediaRef.opacity}},getSecInMin:function(){var a=this.props.data.mediaRef.duration;var b=a%60;var c=parseInt(a/60,10);return c+":"+(b<10?"0"+b:b)},getMediaCaption:function(){var a=this.props.data.mediaRef.title;return a||""},render:f})});define("backgroundPresets/components/backgroundPresetSection",["react","lodash","core","util","color","backgroundPresets/components/backgroundPresetSection.rt","backgroundPresets/components/mediaPreview"],function(a,b,c,d,e,f,g){"use strict";var h=d.imageTransform.fittingTypes;var i=d.imageTransform.alignTypes;var j=d.backgroundPanelUtils;var k="#ffffff";var l=[{thumbWidth:238,thumbHeight:58},{thumbWidth:110,thumbHeight:58},{thumbWidth:68,thumbHeight:50},{thumbWidth:88,thumbHeight:59}];return a.createClass({displayName:"backgroundPresetSection",mixins:[c.mixins.editorAPIMixin],propTypes:{title:a.PropTypes.string,infoTooltip:a.PropTypes.string,onSelectPreset:a.PropTypes.func,columns:a.PropTypes.number,desktopPresets:a.PropTypes.array.isRequired,mobilePresets:a.PropTypes.array},mediaTypes:j.getMediaTypes(),getInitialState:function(){var a=this.props.columns-1||0;return{thumbWidth:l[a].thumbWidth,thumbHeight:l[a].thumbHeight}},componentWillReceiveProps:function(a){var b=a.columns-1||0;this.setState({thumbWidth:l[b].thumbWidth,thumbHeight:l[b].thumbHeight})},getMediaType:function(a){return j.getMediaType(a.ref)},getPresetData:function(){return this.getEditorAPI().isMobileEditor()?this.props.mobilePresets||{}:this.props.desktopPresets},getMediaPreviewComp:function(b){return this.getMediaType(b)!==this.mediaTypes.COLOR?a.createElement(g,{data:b.ref}):null},getThumbStyle:function(a){var c={};var f;var g=h.SCALE_TO_FILL;var l=i.CENTER;var m=this.getMediaType(a);if(a.thumbnail&&a.thumbnail.uri&&a.thumbnail.width&&a.thumbnail.height){f=b.omit(a.thumbnail,"title")}else if(m!==this.mediaTypes.COLOR){f=a.ref.mediaRef.posterImageRef||a.ref.mediaRef;if(a.ref.fittingType===h.LEGACY_BG_FIT_AND_TILE||a.ref.fittingType===h.TILE){var n=j.isSmallerFromContainer(f.width,f.height,this.state.thumbWidth,this.state.thumbHeight);g=n?h.TILE:h.FIT_AND_TILE}else{g=h.SCALE_TO_FILL}l=a.ref.alignType}if(f){var o=j.getImageDisplayData(g,l,f.uri,f.width,f.height,this.state.thumbWidth,this.state.thumbHeight,90);c=o.css.container;c.backgroundImage="url("+d.url.joinURL(j.MEDIA_URL_PREFIX,o.uri)+")"}var p=j.getColorValue(this.getEditorAPI(),a.ref.color||k);if(p){c.backgroundColor=new e(p).alpha(a.ref.colorOpacity||1).rgbaString()}c.width=this.state.thumbWidth+"px";c.height=this.state.thumbHeight+"px";return c},getThumbBackdropStyle:function(a){var b={};var c=h.TILE;var e=i.CENTER;if(a.thumbnailBackground&&a.thumbnailBackground.uri&&a.thumbnailBackground.width&&a.thumbnailBackground.height){var f=j.getImageDisplayData(c,e,a.thumbnailBackground.uri,a.thumbnailBackground.width,a.thumbnailBackground.height,this.state.thumbWidth,this.state.thumbHeight,90);b=f.css.container;var g=d.url.isExternalUrl(f.uri)?f.uri:d.url.joinURL(j.MEDIA_URL_PREFIX,f.uri);b.backgroundImage="url("+g+")"}b.width=this.state.thumbWidth+"px";b.height=this.state.thumbHeight+"px";return b},getOverlayStyle:function(a){var b=a.ref;var c={};var d=j.getColorValue(this.getEditorAPI(),b.colorOverlay);if(d){c.backgroundColor=new e(d).alpha(b.colorOverlayOpacity||0).rgbaString()}return c},selectPreset:function(a,c,d){this.props.onSelectPreset(b.cloneDeep(a),c,d)},render:function(){return f.apply(this)}})});define("backgroundPresets",["backgroundPresets/components/backgroundPresetSection"],function(a){"use strict";return a});