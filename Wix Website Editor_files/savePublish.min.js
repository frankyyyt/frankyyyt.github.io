define("savePublish/utils/failedPanelUtil",["lodash"],function(a){"use strict";function b(b){return a.get(b,"document.errorCode")}function c(b){return a.get(b,"document.errorType")}return{extractDocumentErrorCode:b,extractDocumentErrorType:c}});define("savePublish/managers/savePublishState",[],function(){"use strict";var a={isSaveInProgress:false,isPublishInProgress:false,isDiffSaveInProgress:false};function b(b){a.isSaveInProgress=b}function c(b){a.isPublishInProgress=b}function d(){return a.isPublishInProgress}function e(){return a.isSaveInProgress}function f(){return!a.isPublishInProgress&&!a.isSaveInProgress}function g(b){a.isDiffSaveInProgress=b}function h(){return!a.isDiffSaveInProgress&&!a.isSaveInProgress&&!a.isPublishInProgress}return{setSaveProgress:b,setPublishProgress:c,isSaveInProgress:e,isPublishInProgress:d,canSaveOrPublish:f,setDiffSaveProgress:g,canDiffSave:h}});define("savePublish/constants/savePublishErrorPanelData",[],function(){"use strict";return{SITE_NAME_TAKEN_PANEL_DATA:{titleKey:"ERROR_SITE_NOT_RENAMED_TITLE_LABEL",description:"ERROR_SITE_NOT_RENAMED_BODY_SUBTITLE",steps:["ERROR_SITE_NOT_RENAMED_STEP1_TEXT","ERROR_SITE_NOT_RENAMED_STEP2_TEXT","ERROR_SITE_NOT_RENAMED_STEP3_TEXT"],stepsTitle:"ERROR_SITE_NOT_RENAMED_TRY_STEPS"},SAVE_DISABLED_ON_SERVER_PANEL_DATA:{titleKey:"SAVE_ERROR_TITLE_LABEL",description:"Save_Publish_ServerErrorLabel_OnSave",showSteps:false,showFooterText:false},PUBLISH_DISABLED_ON_SERVER_PANEL_DATA:{titleKey:"PUBLISH_ERROR_TITLE_LABEL",description:"Save_Publish_ServerErrorLabel_OnPublish",showSteps:false,showFooterText:false},NAME_SITE_AGAIN_PANEL_DATA:{titleKey:"ERROR_NAME_SITE_AGAIN_TITLE_LABEL",description:"ERROR_NAME_SITE_AGAIN_SUBTITLE",steps:["ERROR_NAME_SITE_AGAIN_STEP1_TEXT","ERROR_NAME_SITE_AGAIN_STEP2_TEXT","ERROR_NAME_SITE_AGAIN_STEP3_TEXT"],stepsTitle:"ERROR_NAME_SITE_AGAIN_TRY_STEPS"},SAVE_ERROR_DEFAULT_PANEL_DATA:{titleKey:"SAVE_ERROR_TITLE_LABEL",description:"SAVE_PUBLISH_ERROR_BODY_DESCRIPTION",steps:["SAVE_PUBLISH_SAVE_ERROR_OPTION_1","SAVE_PUBLISH_SAVE_ERROR_OPTION_2"],stepsTitle:"SAVE_PUBLISH_ERROR_BODY_DESCRIPTION_BOLD",helpMessage:"SAVE_ERROR_LEARN_MORE_LABEL",helpLinkMessage:"SAVE_PUBLISH_ERROR_LEARN_MORE_LINK",helpLink:"8045e8e4-6f47-4913-8d74-6239f21fffec"},PUBLISH_ERROR_DEFAULT_PANEL_DATA:{titleKey:"PUBLISH_ERROR_TITLE_LABEL",description:"SAVE_PUBLISH_ERROR_BODY_DESCRIPTION",steps:["SAVE_PUBLISH_ERROR_OPTION_1","SAVE_PUBLISH_ERROR_OPTION_2"],helpMessage:"PUBLISH_ERROR_LEARN_MORE_LABEL",helpLinkMessage:"SAVE_PUBLISH_ERROR_LEARN_MORE_LINK",helpLink:"3de8a931-e665-4c9f-bcb3-7096ea89f9e3"}}});define("savePublish/constants/constants",["experiment"],function(a){"use strict";var b=2;var c=3;var d=a.getValue("se_autosaveActionCount");var e=a.getValue("se_saveAfterAutosaveCount");d=f(d,b);e=f(e,c);return{ERROR_CODES:{SAVE_PUBLISH_DISABLED_ON_SERVER:-10132},SAVE:{SAVE_FAILED_HELP_LINK:"8045e8e4-6f47-4913-8d74-6239f21fffec"},AUTOSAVE:{AUTOSAVE_TIMEOUT:10,AUTOSAVE_ACTION_COUNT:d,SAVE_AFTER_AUTOSAVE_COUNT:e,DEBOUNCE_WAIT:2e3},RENAME:{ERRORS:{SITE_NAME_TAKEN:-40003}}};function f(a,b){var c=/^config\d$/;if(c.test(a)){return Number(a.replace("config",""))}return b}});define("savePublish/utils/autosaveTimingUtil",["lodash","util","core","savePublish/constants/constants","experiment"],function(a,b,c,d,e){"use strict";var f=["editorModel","autosaveTiming","autosaveCount"];var g=["editorModel","autosaveTiming","actionCount"];var h=["editorModel","autosaveTiming","timeout"];var i={actionsPerAutosave:d.AUTOSAVE.AUTOSAVE_ACTION_COUNT,autosavesPerFull:d.AUTOSAVE.SAVE_AFTER_AUTOSAVE_COUNT,autosaveIdleSeconds:d.AUTOSAVE.AUTOSAVE_TIMEOUT};function j(){return b.url.isTrue("isqa")&&!b.url.isTrue("forceAutosave")}function k(a){var c=b.url.getParameterByName(a);return c&&Number(c)||i[a]}function l(){a.set(b,f,0)}function m(){a.set(b,g,0)}function n(){clearTimeout(a.get(b,h));if(o){o.cancel()}}var o;function p(d,g,h,i){function j(e){n(d);b.performance.finish("autosave-incremental",true,{actionsPerAutosave:k("actionsPerAutosave"),autosavesPerFull:k("autosavesPerFull"),pagesCount:d.pages.getPageIdList().length,success:!e});d.bi.event(c.bi.events.save.autosave.DIFF_SAVED,{type:i});if(b.url.isTrue("isqa")&&typeof window!=="undefined"&&window.testApi){var f=!e?"autosaveSuccessCount":"autosaveFailCount";if(a.isNaN(Number(window.testApi[f]))){window.testApi[f]=0}window.testApi[f]++}}m();var o=a.get(b,f,0)+1;a.set(b,f,o);if(o<k("autosavesPerFull")||!e.isOpen("autoFullSave")){b.performance.start("autosave-incremental");g(d,j,j)}else{h(d,l,l,"autosave")}}function q(c,d,e){n();a.set(b,h,setTimeout(function(){o(c,d,e,"idle")},k("autosaveIdleSeconds")*1e3))}function r(c,d,e){a.set(b,g,a.get(b,g,0)+1);if(a.get(b,g)>=k("actionsPerAutosave")){o(c,d,e,"num of actions")}}function s(){m();n()}function t(b,c,e){o=o||a.debounce(p,d.AUTOSAVE.DEBOUNCE_WAIT);q(b,c,e);r(b,c,e)}return{isAutomationWithoutAutosave:j,handleUserAction:t,resetAutosaveCount:l,clear:s}});define("savePublish/managers/saveManager",["lodash","core","panels","util","savePublish/utils/failedPanelUtil","baseUI","savePublish/managers/savePublishState","savePublish/constants/savePublishErrorPanelData","savePublish/utils/autosaveTimingUtil","pLoader!santa:utils","experiment"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";var l={ON_BOARDING_MIGRATION:"savePublish.panels.save.onBoardingMigrationConfirmationPanel",CHOOSE_DOMAIN:"savePublish.panels.save.chooseDomainPanel",SITE_WAS_SAVED:"savePublish.panels.save.siteWasSavedPanel",SAVE_FAILED:"savePublish.panels.common.failPanel",CONCURRENT_SAVE:"savePublish.panels.save.concurrentSavePanel",SAVE_REMINDER:"savePublish.panels.save.saveReminderPanel"};var m={SITE_SAVED_WELCOME_BACK_TITLE:"SAVE_SITE_SAVED_WELCOME_BACK_TITLE",SITE_SAVED_WELCOME_BACK_SUBTITLE:"SAVE_SITE_SAVED_WELCOME_BACK_SUBTITLE"};var n=(d.serviceTopology.editorServerRoot||"//editor.wix.com/html/editor/web")+"/renderer/edit/<%= siteId %>";var o=null;var p=null;function q(a){var b=o.domain.isDomainConnected();p={isFirstSave:o.generalInfo.isFirstSave(),isSitePublished:o.generalInfo.isSitePublished(),isDomainConnected:b,domain:b?o.generalInfo.getPublicUrl():o.domain.getFreeDomainPrefix()+o.siteName.get(),isSitePremium:o.site.isPremium(),callback:a}}function r(b){var c=o.domain.isDomainConnected();p=a.merge(p,{isDomainConnected:c,domain:c?o.generalInfo.getPublicUrl():o.domain.getFreeDomainPrefix()+o.siteName.get(),isSitePremium:o.site.isPremium()},b)}function s(){var b=20;var c=o.siteName.getUsed();var e=d.translate("Save_Publish_Site_Default_Name");var f=o.siteName.sanitize(e.slice(0,b).replace(/\-$/,"").replace(/_/g,"-"));var g=1;while(a.includes(c,f)){var h="-"+g;f=e.slice(0,b-h.length).replace(/\-$/,"").replace(/_/g,"-")+h;g++}return f}function t(){var b=o.generalInfo.getSiteId();var c=o.generalInfo.getMetaSiteId();var e=d.url.parseUrl(window.location.href).query;delete e.siteId;e.metaSiteId=c;var f=a.template(n)({siteId:b});f=d.url.setUrlParams(f,e);d.windowInteractionUtils.replaceState({},"",f)}function u(){var b="blog";if(a.size(o.wixapps.classics.getAllAppPartComps(b))>0){o.wixapps.classics.reloadApp(b)}}function v(a){var b=e.extractDocumentErrorType(a);switch(b){case o.errors.save.SITE_NAME_TAKEN:y(a,h.SITE_NAME_TAKEN_PANEL_DATA);break;case o.errors.save.SAVE_PUBLISH_DISABLED_ON_SERVER:y(a,h.SAVE_DISABLED_ON_SERVER_PANEL_DATA);break;default:y(a,h.SAVE_ERROR_DEFAULT_PANEL_DATA);break}}function w(b,d,e){var f=b||z;var g=d||y;var h=a.partial(H,f,g,e);c.panelManager.openPanel(l.CONCURRENT_SAVE,{overrideSaveMethod:h,onCancel:d,origin:e},true)}function x(b){c.panelManager.openPanel(l.SAVE_REMINDER,{saveMethod:a.partial(N,b,{origin:"remember_to_save_active_save_popup"})},true)}function y(d,f){var g=b.bi.events.save.saveFailed;var i=p.isFirstSave;var j=d&&e.extractDocumentErrorCode(d);var k={errorCode:j,biConfirm:i?g.First_Save_error_work_not_saved_error_ok_click:null,biHelp:i?g.First_Save_error_work_not_saved_error_help_center_link_click:null,biCancel:i?g.First_Save_error_work_not_saved_error_close_click:null};var m=a.chain(f).clone().defaults(h.SAVE_ERROR_DEFAULT_PANEL_DATA).assign(k).value();c.panelManager.openPanel(l.SAVE_FAILED,m,true)}function z(b,d){r();if(A()){var e=a.clone(p);e.overrideTitle=b;e.overrideSubtitle=d;c.panelManager.openPanel(l.SITE_WAS_SAVED,e,true)}}function A(){return o&&o.account.isUserOwner()&&!o.wixStores.isSiteInWixStoreTestDrive()}function B(b){b=a(b).pick("overrideTitle","overrideSubtitle").assign({defaultSiteName:s(),freeDomainPrefix:o.domain.getFreeDomainPrefix(),connectDomainHandler:a.partial(F,b.origin),freeDomainHandler:a.partial(D,b.origin)}).value();c.panelManager.openPanel(l.CHOOSE_DOMAIN,b,true)}function C(a){c.panelManager.openPanel("savePublish.panels.connectDomain",{title:"SAVE_SITE_SAVED_TITLE_TITLE",subtitle:"PREMIUM_TITLE_SUBTITLE",onConnectDomainFlowEnded:a,isFirstSave:p.isFirstSave,isFirstPublish:!p.isSitePublished,isPremium:p.isSitePremium,flowId:b.constants.CONNECT_DOMAIN.FLOWS.SAVE},true)}function D(a,b){J(b,z,K,a)}function E(){function a(a){var b={isDomainConnected:a.isDomainConnected,isSitePremium:a.isSitePremium};if(a.sitePublishedDomain){b.domain=a.sitePublishedDomain;o.generalInfo.setPublicUrl(a.sitePublishedDomain)}r(b);z(m.SITE_SAVED_WELCOME_BACK_TITLE,m.SITE_SAVED_WELCOME_BACK_SUBTITLE)}o.site.getSiteDomainInfo(a,z)}function F(a){J(s(),C.bind(this,E),K,a)}function G(a,b,c,d){if(g.isSaveInProgress()){b()}g.setSaveProgress(true);i.clear();function e(a){return function(b){i.resetAutosaveCount();g.setSaveProgress(false);a(b)}}o.savePublish.save(e(a),e(b),c,d)}function H(a,b,c){G(a,b,true,c)}function I(a){return o.errors.save.SITE_NAME_TAKEN===e.extractDocumentErrorType(a)}function J(a,b,c,d){if(!g.isSaveInProgress()){o.siteName.set(a);G(function(){t();u();b()},function b(d){if(I(d)){o.siteName.markAsUsed(a)}c(d)},d)}}function K(a,b,c,d){var f=e.extractDocumentErrorType(b);if(f===o.errors.save.CONCURRENT_SAVE){w(c,d,a)}else if(d){d(b)}else{v(b)}}function L(a){c.panelManager.openPanel(l.ON_BOARDING_MIGRATION,{onConfirm:a},true)}function M(a){return a.generalInfo.isSiteFromOnBoarding()}function N(c,d){if(!g.canSaveOrPublish()){j.log.error("Site is being saved or published!");return}if(k.isOpen("se_obMigrationFlow")&&!a.get(d,"forceOBMigration")&&M(c)){L(N.bind(this,c,a.defaults({forceOBMigration:true},d)));return}d=d||{};var e=d.callback;var f=d.origin;var h=a.partial(K,f);o=c;q(e);if(p.isFirstSave){if(k.isOpen("googleDomain")&&c.domain.doesUserOwnGoogleDomain()){J(s(),z,h,f)}else{B(d)}}else{var i=function(){var a=o.getUserPreferences();var c=b.constants.USER_PREFS.SAVE.SITE_SAVED_DONT_SHOW_AGAIN;var d=!a||a.session.get(c)!==true;if(d){z("SAVE_SITE_SAVED_SMALL_TITLE_TITLE","SAVE_SITE_SAVED_SMALL_TITLE_SUBTITLE")}else if(e){e()}};G(i,h,false,d.origin)}}function O(b,c,d,e,f){if(!g.canSaveOrPublish()){j.log.error("Site is being saved or published!");return}if(k.isOpen("se_obMigrationFlow")&&!a.get(f,"forceOBMigration")&&M(b)){L(O.bind(this,b,c,d,e,a.defaults({forceOBMigration:true},f)));return}o=b;q();if(p.isFirstSave){J(s(),c,d,e)}else{G(c,function(a){K(e,a,c,d)},false,e)}}function P(d){setTimeout(h,b.constants.SAVE_PUBLISH.SAVE_REMINDER_TIMEOUT);var e=setTimeout(i,b.constants.SAVE_PUBLISH.SAVE_TOOLTIP_TIMEOUT);if(k.isOpen("se_obMigrationFlow")){m()}function h(){if(d.generalInfo.isFirstSave()){if(g.canSaveOrPublish()&&!j()&&!d.zoomMode.isInZoomMode()){x(d);clearTimeout(e)}setTimeout(h,b.constants.SAVE_PUBLISH.SAVE_REMINDER_TIMEOUT)}}function i(){if(d.generalInfo.isFirstSave()){if(g.canSaveOrPublish()&&!j()&&!d.zoomMode.isInZoomMode()){f.tooltipManager.showForDuration("save-button-tooltip",b.constants.SAVE_PUBLISH.SAVE_TOOLTIP_DURATION);d.bi.event(b.bi.events.save.saveReminder.REMINDER_DISPLAYED,{origin:"save tool-tip"})}e=setTimeout(i,b.constants.SAVE_PUBLISH.SAVE_TOOLTIP_TIMEOUT)}}function j(){return a.some(c.panelManager.getOpenPanels(),function(b){return a.includes([l.SAVE_REMINDER,l.CHOOSE_DOMAIN],b.name)})}function m(){if(d.generalInfo&&d.generalInfo.isSiteFromOnBoarding()){setTimeout(function(){f.tooltipManager.showForDuration("save-button-tooltip",b.constants.SAVE_PUBLISH.SAVE_TOOLTIP_DURATION)},2e3)}}}function Q(b,c,d){var e=b.generalInfo&&b.generalInfo.getUserInfo().isStudio;if(!e){j.log.info("Failed saving as template. User has no permissions to save as template");return}if(g.isSaveInProgress()){d()}g.setSaveProgress(true);i.clear();g.setPublishProgress(true);R(b);function f(a,b){g.setSaveProgress(false);g.setPublishProgress(false);if(a){a(b)}}b.savePublish.saveAsTemplate(a.partial(f,c),a.partial(f,d))}function R(b){var c=b.pages.getPageIdList();a.forEach(c,function(a){S(b,a,"desktop");S(b,a,"mobile")})}function S(a,b,c){var d=a.pages.background.get(b,c);if(d&&!d.isPreset){d.isPreset=true;a.pages.background.update(b,d,c)}}function T(b,c){return a(["CONCURRENT_AUTO_SAVE","SITE_STALE_STATE_FROM_AUTO_SAVE"]).map(a.propertyOf(b.errors.save)).includes(e.extractDocumentErrorType(c))}function U(b,c){return function(d){if(T(b,d)&&k.isOpen("showConcurrentAutosaveDialog")){w(a.noop,a.noop,"autosave")}c(d)}}function V(a,b,c){function d(a){return function(b){g.setDiffSaveProgress(false);a(b)}}if(!g.canDiffSave()){return c()}g.setDiffSaveProgress(true);i.clear();var e=d(b);var f=U(a,d(c));a.savePublish.autosave(e,f)}function W(a){return a.savePublish.canAutosave()}function X(a){o=a;if(!a.generalInfo.isFirstSave()&&!i.isAutomationWithoutAutosave()){i.handleUserAction(a,V,O)}}return{save:N,saveInBackground:O,isSaveInProgress:g.isSaveInProgress,saveAsTemplate:Q,setTimerForSaveReminder:a.once(P),autosave:{canAutosave:W,handleUserAction:X,differentialSave:V}}});define("savePublish/managers/mockSaveManager",["lodash","core","panels","savePublish/constants/savePublishErrorPanelData","pLoader!santa:utils"],function(a,b,c,d,e){"use strict";var f="http://www.wix.com/";var g={CHOOSE_DOMAIN:"savePublish.panels.save.chooseDomainPanel",SITE_WAS_SAVED:"savePublish.panels.save.siteWasSavedPanel",SAVE_FAILED:"savePublish.panels.common.failPanel",CONCURRENT_SAVE:"savePublish.panels.save.concurrentSavePanel"};var h=null;var i=null;function j(b){i=a.clone(b)}function k(b){i=a.merge(i||{},b)}function l(){var b=20;var c=h.siteName.getUsed();var d=h.siteName.get();var e=d.slice(0,b);var f=1;while(a.includes(c,e)){var g="-"+f;e=d.slice(0,b-g.length)+g;f++}return e}function m(){var a={defaultSiteName:l(),freeDomainPrefix:f,connectDomainHandler:r,freeDomainHandler:q};c.panelManager.openPanel(g.CHOOSE_DOMAIN,a,true)}function n(){c.panelManager.openPanel("savePublish.panels.connectDomain",{title:"SAVE_SITE_SAVED_TITLE_TITLE",subtitle:"PREMIUM_TITLE_SUBTITLE",onConnectDomainFlowEnded:p.bind(this,"SAVE_SITE_SAVED_WELCOME_BACK_TITLE","SAVE_SITE_SAVED_WELCOME_BACK_SUBTITLE"),isFirstSave:true,isFirstPublish:true,isPremium:i.isSitePremium,flowId:b.constants.CONNECT_DOMAIN.FLOWS.SAVE},true)}function o(){c.panelManager.openPanel(g.SAVE_FAILED,d.SAVE_ERROR_DEFAULT_PANEL_DATA,true)}function p(b,d){var e=a.clone(i);e.isMockSave=true;e.overrideTitle=b;e.overrideSubtitle=d;c.panelManager.openPanel(g.SITE_WAS_SAVED,e,true)}function q(a){if(i.shouldSaveSucceed){s();k({domain:f+a});p()}else{o()}}function r(){if(i.shouldSaveSucceed){s();n()}else{o()}}function s(){e.log.info("First Save Was Performed!")}function t(){e.log.info("Save Was Performed!")}function u(){function a(a,b){h=a;if(!b.isDomainConnected){b.domain=f+l()}j(b);if(b.isFirstSave){m()}else if(b.shouldSaveSucceed){t();p("SAVE_SITE_SAVED_SMALL_TITLE_TITLE","SAVE_SITE_SAVED_SMALL_TITLE_SUBTITLE")}else{o()}}c.panelManager.openPanel("savePublish.panels.save.saveConfigurationPanel",{onConfirm:a},true)}return{save:u}});define("savePublish/panels/publish/publishInnerPanelTypes",["core"],function(a){"use strict";var b=a.constants.USER_PREFS.PUBLISH;return{EMPTY:{name:"EMPTY"},SHOUTOUT:{name:"SHOUTOUT",userPref:b.SHOUTOUT_DONT_SHOW_AGAIN},CONNECT_DOMAIN:{name:"CONNECT_DOMAIN",userPref:b.CONNECT_DOMAIN_DONT_SHOW_AGAIN},GROW_BUSINESS:{name:"GROW_BUSINESS",userPref:b.GROW_BUSINESS_DONT_SHOW_AGAIN},MUSIC_PROMO:{name:"MUSIC_PROMO",userPref:b.MUSIC_PROMO_DONT_SHOW_AGAIN},PHOTOGRAPHY_PROMO:{name:"PHOTOGRAPHY_PROMO",userPref:b.PHOTOGRAPHY_PROMO_DONT_SHOW_AGAIN}}});define("savePublish/managers/publishManager",["lodash","core","panels","pLoader!santa:utils","savePublish/utils/failedPanelUtil","savePublish/constants/savePublishErrorPanelData","savePublish/managers/savePublishState","savePublish/managers/saveManager","savePublish/panels/publish/publishInnerPanelTypes","experiment"],function(a,b,c,d,e,f,g,h,i,j){"use strict";var k="savePublish.panels.publish.config.publishConfigurationPanel";var l="savePublish.panels.publish.publishSuccessPanel";var m="savePublish.panels.common.failPanel";var n=null;var o=false;var p=0;function q(a){P(a);function b(b){o=true;if(b.shouldPublishSucceed&&!b.isSiteContributor){z(a,b)}else if(b.shouldPublishSucceed&&b.isSiteContributor){d.log.info("Contributors dont get to see any post operations except failure.");x()}else{y()}}c.panelManager.openPanel(k,{onConfirm:b})}function r(b){if(!g.canSaveOrPublish()){return}function c(c){function d(){z(b,c);x()}P(b);b.savePublish.publish(d,a.partial(u,b))}if(s(b)){w();M(b,c)}else{t(b)}}function s(a){return a.account.isUserOwner()&&!a.wixStores.isSiteInWixStoreTestDrive()}function t(b){b.savePublish.publish(x,a.partial(u,b))}function u(a,b){var c=e.extractDocumentErrorType(b);switch(c){case a.errors.save.SAVE_PUBLISH_DISABLED_ON_SERVER:y(b,f.PUBLISH_DISABLED_ON_SERVER_PANEL_DATA);break;default:y(b,f.PUBLISH_ERROR_DEFAULT_PANEL_DATA);break}x()}function v(b,c){if(!g.canSaveOrPublish()){return}if(b.generalInfo.isFirstSave()){var d={overrideTitle:"PUBLISH_BEFORE_SAVE_CHOOSE_DOMAIN_TITLE",overrideSubtitle:"PUBLISH_BEFORE_SAVE_CHOOSE_DOMAIN_SUBTITLE",callback:r.bind(this,b)};h.save(b,d);return}h.saveInBackground(b,r.bind(this,b),a.partial(u,b),c)}function w(){g.setPublishProgress(true)}function x(){g.setPublishProgress(false)}function y(d,g){var h={errorCode:e.extractDocumentErrorCode(d),biConfirm:b.bi.events.publish.Publish_Work_not_Published_Error_ok_Click,biHelp:b.bi.events.publish.Publish_Work_not_Published_Error_Help_Center_Link_Click};var i=a.chain(g).clone().defaults(f.PUBLISH_ERROR_DEFAULT_PANEL_DATA).assign(h).value();c.panelManager.openPanel(m,i,true)}function z(b,d){var e=b.generalInfo.getPublicUrl()||b.domain.getFreeDomainPrefix()+b.siteName.get();e=d.isDomainConnected?d.sitePremiumDomain:e;var f=A(b,d);if(!a.isEqual(f,i.EMPTY)){var g={isFakePanel:o,contentPanelType:f,configuration:d,currentDomain:b.site.getCurrentSiteDomain(),userPreferences:n,sitePublicUrl:e,closePanel:N.bind(null,l)};c.panelManager.openPanel(l,g,true)}}function A(a,b){var c=i.EMPTY;var d=!b.isPremiumUser&&b.isDomainConnected;if(!d){var e=K();if(B(a)){var f=e[i.MUSIC_PROMO.name].dontShowAgain;c=!f||o?i.MUSIC_PROMO:i.EMPTY}else if(C(a)){var g=e[i.PHOTOGRAPHY_PROMO.name].dontShowAgain;c=!g||o?i.PHOTOGRAPHY_PROMO:i.EMPTY}else if(D(b)){c=i.CONNECT_DOMAIN}else{var h=J(a,b,e);if(h.length){c=h[p%h.length]||i.EMPTY;p=(p+1)%h.length}}}return c}function B(a){return j.isOpen("musicPromotionFixed")&&a.promotions.music.isActive()}function C(a){return j.isOpen("photographyPromotionFixed")&&a.promotions.photography.isActive()}function D(a){return a.isFirstPublish&&!a.isDomainConnected}function E(a,b){var c=b[i.CONNECT_DOMAIN.name].dontShowAgain;return!a.isDomainConnected&&(!c||o)}function F(a,b){var c=b[i.MUSIC_PROMO.name].dontShowAgain;return j.isOpen("musicPromotionRotation")&&a.promotions.music.isActive()&&(!c||o)}function G(a,b){var c=b[i.PHOTOGRAPHY_PROMO.name].dontShowAgain;return j.isOpen("photographyPromotionRotation")&&a.promotions.photography.isActive()&&(!c||o)}function H(a,b){var c=b[i.SHOUTOUT.name].dontShowAgain;return!a.isDomainConnected&&(!c||o)}function I(a,b){var c=b[i.GROW_BUSINESS.name].dontShowAgain;return a.isPremiumUser&&a.isDomainConnected&&(!c||o)}function J(a,b,c){var d=[];var e=E(b,c);var f=F(a,c);var g=G(a,c);var h=H(b,c);var j=I(b,c);if(e){d.push(i.CONNECT_DOMAIN)}if(f){d.push(i.MUSIC_PROMO)}if(g){d.push(i.PHOTOGRAPHY_PROMO)}if(!f&&!g&&h){d.push(i.SHOUTOUT)}if(j){d.push(i.GROW_BUSINESS)}return d}function K(){var b={};var c=a.reject(i,i.EMPTY);a.forEach(c,function(a){b[a.name]=L(a.userPref)});return b}function L(a){return{dontShowThisAgainKey:a,dontShowAgain:n.session.get(a)}}function M(a,b){a.site.getSiteDomainInfo(function(c){var d=c.isDomainConnected;var e=c.sitePublishedDomain;b({isFirstSave:a.generalInfo.isFirstSave(),isPremiumUser:a.site.isPremium(),sitePremiumDomain:e,isDomainConnected:d,isFirstPublish:!a.generalInfo.isSitePublished()})})}function N(a){o=false;return c.panelManager.closePanelByName(a)}function O(a){n=a.getUserPreferences();if(n===null){a.registerInitUserPrefsCallback(function(a){n=a})}}var P=a.once(O);return{publish:r,saveAndPublish:v,configurePublish:q,isPublishInProgress:g.isPublishInProgress}});define("savePublish/panels/connectDomain/connectDomainPanel.rt",["react","lodash","panels","util","baseUI","symbols"],function(a,b,c,d,e,f){"use strict";function g(){this.onClose(false)}function h(){this.hoverOnAction(1)}function i(){this.hoverOnAction(2)}return function(){return a.createElement(c.frames.focusPanelFrame,{ref:"frame",className:"connect-domain-panel save-publish-panel",panelName:this.props.panelName,shouldHideHeader:true,frameClassName:"save-publish-panel-frame",keyboardShortcuts:this.getKeyboardShortcuts()},a.createElement("header",{className:"save-publish-panel-header"},a.createElement("button",{className:"close",onClick:g.bind(this)},a.createElement(f.symbol,{name:"headerCloseButton"})),a.createElement("span",{className:"title"},this.translateIfNeeded(this.props.title)),a.createElement("span",{className:"subtitle"},this.translateIfNeeded(this.props.subtitle))),a.createElement("div",{className:"actions"},a.createElement("a",{className:"action",onClick:this.connectToNewDomain,onMouseEnter:h.bind(this),onMouseLeave:this.resetHoverOnAction},a.createElement("div",{className:"action-graphics"},a.createElement(e.symbol,{name:"connectNewDomain"})),a.createElement("div",{className:"action-title"},this.translateIfNeeded("PREMIUM_BUTTON_1")),!this.isActionHovered(1)?a.createElement("div",{key:"optionArrow",className:"action-arrow"},a.createElement(e.symbol,{name:"arrowWithCircle"})):null,this.isActionHovered(1)?a.createElement("div",{key:"optionLink",className:"action-arrow"},a.createElement(e.symbol,{name:"openLinkInWindow"})):null),a.createElement("a",{className:"action",onClick:this.connectExistingDomain,onMouseEnter:i.bind(this),onMouseLeave:this.resetHoverOnAction},a.createElement("div",{className:"action-graphics"},a.createElement(e.symbol,{name:"connectDomainLight"})),a.createElement("div",{className:"action-title"},this.translateIfNeeded("PREMIUM_BUTTON_2")),!this.isActionHovered(2)?a.createElement("div",{key:"optionArrow",className:"action-arrow"},a.createElement(e.symbol,{name:"arrowWithCircle"})):null,this.isActionHovered(2)?a.createElement("div",{key:"optionLink",className:"action-arrow"},a.createElement(e.symbol,{name:"openLinkInWindow"})):null)),a.createElement("div",{className:"connect-domain-panel-footer"},a.createElement(e.button,{type:"button",label:"PREMIUM_BUTTON_LABEL",className:"maybe-later-button",onClick:this.maybeLater})))}});define("savePublish/panels/connectDomain/connectDomainPanel",["react","jquery","lodash","core","util","savePublish/panels/connectDomain/connectDomainPanel.rt"],function(a,b,c,d,e,f){"use strict";var g="https://premium.wix.com/wix/api/";var h="?siteGuid=<%= siteGUID %>&referralAdditionalInfo=<%= referralInfo %>";var i=g+"domainConsole"+h;return a.createClass({displayName:"connectDomainPanel",mixins:[d.mixins.editorAPIMixin,e.translationMixin],propTypes:{isPremium:a.PropTypes.bool.isRequired,isFirstSave:a.PropTypes.bool,isFirstPublish:a.PropTypes.bool,title:a.PropTypes.string,subtitle:a.PropTypes.string,onConnectDomainFlowEnded:a.PropTypes.func,flowId:a.PropTypes.oneOf(c.values(d.constants.CONNECT_DOMAIN.FLOWS)).isRequired},getInitialState:function(){return{actionIndexHovered:-1}},connectToNewDomain:function(){var a="CONNECT_NEW_DOMAIN";var b=d.bi.events.save.siteWasSavedPanel.CONNECT_NEW_DOMAIN_CLICKED;var c=this.openUpgrade.bind(this,a);if(this.props.isPremium){c=this.openConnectDomainInWindow.bind(this,a)}this.connectDomain(b,c)},connectExistingDomain:function(){var a="CONNECT_EXISTING_DOMAIN";var b=d.bi.events.save.siteWasSavedPanel.CONNECT_EXISTING_DOMAIN_CLICKED;var c=this.openUpgrade.bind(this,a);if(this.props.isPremium){c=this.openConnectDomainInWindow.bind(this,a)}this.connectDomain(b,c)},connectDomain:function(a,b){if(this.props.isFirstSave){this.sendBI(a)}var c=this.listenToTabFocusIfNeeded();b.call(this);this.onClose(c)},listenToTabFocusIfNeeded:function(){if(this.props.onConnectDomainFlowEnded){var a=function(){this.getWindow().off("focus",a);this.props.onConnectDomainFlowEnded()}.bind(this);this.getWindow().on("focus",this.onEditorFocus);return true}return false},onEditorFocus:function(){this.getWindow().off("focus",this.onEditorFocus);this.props.onConnectDomainFlowEnded()},getReferralCode:function(a){var b="edhtml_";switch(this.props.flowId){case d.constants.CONNECT_DOMAIN.FLOWS.SAVE:b+="SAVE_FLOW_";b+=this.props.isFirstSave?"FIRST_SAVE_":"SECOND_SAVE_";b+=a;break;case d.constants.CONNECT_DOMAIN.FLOWS.TOP_BAR:b+="TOP_BAR_SITE_MENU_CONNECT_DOMAIN_"+a;break;case d.constants.CONNECT_DOMAIN.FLOWS.PUBLISH:b+="PUBLISH_FLOW_";b+=this.props.isFirstPublish?"FIRST_PUBLISH_":"SECOND_PUBLISH_";b+=a;break;case d.constants.CONNECT_DOMAIN.FLOWS.PUBLISH_BUTTON:b+="PUBLISH_FLOW_CONNECT_BUTTON_";b+=this.props.isFirstPublish?"FIRST_PUBLISH_":"SECOND_PUBLISH_";b+=a;break;default:b=null}return b},openUpgrade:function(a){var b=this.getReferralCode(a);this.getEditorAPI().account.upgrade(b)},openConnectDomainInWindow:function(a){var b=this.createURLWithParams(i,a);window.open(b)},createURLWithParams:function(a,b){var d=this.getReferralCode(b);var e=c.template(a);var f=this.getEditorAPI().generalInfo.getSiteId();return e({siteGUID:f,referralInfo:d})},maybeLater:function(){this.getEditorAPI().bi.event(d.bi.events.save.siteWasSavedPanel.First_Save_Dialog_2_maybe_later_click);this.onClose(false)},onClose:function(a){this.refs.frame.close();if(!a&&this.props.onConnectDomainFlowEnded){this.props.onConnectDomainFlowEnded()}},getWindow:function(){return b(window)},resetHoverOnAction:function(){this.hoverOnAction(-1)},hoverOnAction:function(a){this.setState({actionIndexHovered:a})},isActionHovered:function(a){return this.state.actionIndexHovered===a},sendBI:function(a){this.getEditorAPI().bi.event(a)},getKeyboardShortcuts:function(){var a=this;return{enter:function(){a.maybeLater()},esc:function(){a.onClose(false)}}},render:f})});define("savePublish/panels/connectDomain/connectDomainInProgress.rt",["react","lodash","panels","util","baseUI","symbols"],function(a,b,c,d,e,f){"use strict";return function(){return a.createElement(c.frames.focusPanelFrame,{ref:"frame",className:"connect-domain-in-progress-panel save-publish-panel",panelName:this.props.panelName,shouldHideHeader:true,frameClassName:"save-publish-panel-frame",keyboardShortcuts:this.getShortcuts()},a.createElement("div",{className:"save-publish-panel-header"},a.createElement("div",{className:"title"},d.translate("PUBLISH_HANGON_TITLE")),a.createElement("div",{className:"subtitle"},d.translate("PUBLISH_HANGON_SUBTITLE")),a.createElement("button",{className:"close-button",onClick:this.onClose},a.createElement(f.symbol,{name:"headerCloseButton"}))),a.createElement("div",{className:"panel-content"},a.createElement("div",{className:"content-top-part"},a.createElement("div",{className:"content-graphics"},a.createElement(e.symbol,{name:"hangon"})),a.createElement("div",{className:"content-top-message"},"\n                ",d.translate("PUBLISH_HANGON_MAIN_TEXT"),"\n                ",a.createElement("span",{className:"public-url"},this.props.connectedDomainURL))),a.createElement("div",{className:"content-bottom-message"},"\n            ",d.translate("PUBLISH_HANGON_MEANTIME_TEXT"),"\n            ",a.createElement("a",{className:"content-bottom-message-link",onClick:this.openWorkingURL},d.translate("PUBLISH_HANGON_CLICKING_HERE_LINK")))),a.createElement("div",{className:"connect-domain-panel-footer"},a.createElement(e.button,{type:"button",className:"maybe-later-button",label:"PUBLISH_HANGON_DONE_BUTTON",onClick:this.onClose})))}});define("savePublish/panels/connectDomain/connectDomainInProgress",["react","savePublish/panels/connectDomain/connectDomainInProgress.rt"],function(a,b){"use strict";return a.createClass({displayName:"connectDomainInProgress",propTypes:{connectedDomainURL:a.PropTypes.string.isRequired,currentPublicURL:a.PropTypes.string.isRequired},getShortcuts:function(){return{esc:this.onClose,enter:this.onClose}},openWorkingURL:function(){window.open(this.props.currentPublicURL)},onClose:function(){this.refs.frame.close()},render:b})});define("savePublish/panels/common/failPanel.rt",["react","lodash","util","baseUI","panels"],function(a,b,c,d,e){"use strict";function f(b,d){return a.createElement("li",{key:b},c.translate(b))}return function(){return a.createElement(e.frames.messagePanelFrame,{ref:"frame",editorAPI:this.getEditorAPI(),panelName:this.props.panelName,className:"fail-panel",panelTitle:c.translate(this.props.titleKey),confirmLabel:"SAVE_PUBLISH_ERROR_BUTTON_OK",onConfirm:this.onConfirm,onCancel:this.onCancel,footerText:this.props.showFooterText?this.getFooterText():null,keyboardShortcuts:this.getShortcuts()},a.createElement("div",{className:"content-wrapper"},a.createElement("div",{className:"icon"},a.createElement(d.symbol,{name:"plaster"})),a.createElement("div",{className:"textual"},a.createElement("p",{className:"description",dangerouslySetInnerHTML:{__html:c.translate(this.props.description)}}),this.props.showSteps&&this.props.stepsTitle?a.createElement("div",{key:"stepsTitle",className:"steps-title"},c.translate(this.props.stepsTitle)):null,this.props.showSteps?a.createElement.apply(this,["ol",{key:"steps"},b.map(this.props.steps,f.bind(this))]):null)))}});define("savePublish/panels/common/failPanel",["react","core","util","panels","savePublish/panels/common/failPanel.rt"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"failPanel",mixins:[b.mixins.editorAPIMixin],propTypes:{titleKey:a.PropTypes.string.isRequired,description:a.PropTypes.string.isRequired,stepsTitle:a.PropTypes.string,steps:a.PropTypes.array.isRequired,helpMessage:a.PropTypes.string.isRequired,helpLinkMessage:a.PropTypes.string.isRequired,helpLink:a.PropTypes.string.isRequired,errorCode:a.PropTypes.number,biEvent:a.PropTypes.object,biParams:a.PropTypes.object,failHelpId:a.PropTypes.string,biConfirm:a.PropTypes.object,biHelp:a.PropTypes.object,biCancel:a.PropTypes.object},getDefaultProps:function(){return{showSteps:true,showFooterText:true,panelName:"savePublish.panels.common.failPanel"}},getShortcuts:function(){var a=this;return{esc:function(){a.refs.frame.onCancel()},enter:function(){a.refs.frame.onConfirm()}}},getErrorCodeMessage:function(){return this.props.errorCode!==undefined&&this.props.errorCode!==null?" (Error Code: "+this.props.errorCode+")":""},getFooterText:function(){return a.DOM.p({className:"fail-panel-help-text"},a.DOM.span({className:"text-part"},c.translate(this.props.helpMessage)),a.DOM.a({onClick:this.openHelpLink,className:"link-part"},c.translate(this.props.helpLinkMessage)),a.DOM.span({className:"error-code-part"},this.getErrorCodeMessage()))},onCancel:function(){if(this.props.biCancel){this.getEditorAPI().bi.event(this.props.biCancel)}},onConfirm:function(){if(this.props.biConfirm){this.getEditorAPI().bi.event(this.props.biConfirm)}},openHelpLink:function(){if(this.props.biHelp){this.getEditorAPI().bi.event(this.props.biHelp)}var a={panel_name:this.props.panelName,origin:b.constants.BI.HELP.ORIGIN.PANEL,learn_more:true};d.panelManager.openHelpCenter(this.props.helpLink,null,a);
d.panelManager.closePanelByName(this.props.panelName)},sendPanelLoadedBiEvent:function(){if(this.props.biEvent&&this.props.biParams){this.getEditorAPI().bi.event(this.props.biEvent,this.props.biParams)}},componentDidMount:function(){this.sendPanelLoadedBiEvent()},render:e})});define("savePublish/panels/common/commonPanels",["savePublish/panels/common/failPanel"],function(a){"use strict";return{failPanel:a}});define("savePublish/panels/save/chooseDomainPanel.rt",["react","lodash","panels","baseUI","symbols"],function(a,b,c,d,e){"use strict";function f(a){this.handleDomainOptionSelected(a.value)}function g(){var c=this.getOptions()[this.DomainStates.FREE];return a.createElement("label",{className:b({"domain-option":true,checked:this.state.domainChoice===this.DomainStates.FREE}).transform(function(a,b,c){if(b){a.push(c)}},[]).join(" ")},a.createElement("span",{className:"domain-option-label"},c.label),a.createElement("input",{className:"domain-option-radio-button",type:"radio",name:"domain-options",value:c.value,checked:this.state.domainChoice===c.value,onChange:f.bind(this,c)}),a.createElement("span",{}),a.createElement("div",{className:"domain-input"},a.createElement(d.domainInput,{value:c.domain,onChange:this.handleDomainChanged,prefix:c.prefix,isEditable:c.isEditable,domainValidator:c.domainValidator,biHandler:this.domainInputBiReporter})))}function h(a){this.handleDomainOptionSelected(a.value)}function i(){var c=this.getOptions()[this.DomainStates.BUY];return a.createElement("label",{className:b({"domain-option":true,checked:this.state.domainChoice===this.DomainStates.BUY}).transform(function(a,b,c){if(b){a.push(c)}},[]).join(" ")},a.createElement("span",{className:"domain-option-label"},c.label),a.createElement("input",{className:"domain-option-radio-button",type:"radio",name:"domain-options",value:c.value,checked:this.state.domainChoice===c.value,onChange:h.bind(this,c)}),a.createElement("span",{}),a.createElement("span",{className:"connect-domain-example"},c.domain))}return function(){return a.createElement(c.frames.focusPanelFrame,{ref:"frame",className:"choose-domain-panel save-publish-panel",panelName:this.props.panelName,shouldHideHeader:true,frameClassName:"save-publish-panel-frame",keyboardShortcuts:this.getKeyboardShortcuts()},a.createElement("header",{className:"save-publish-panel-header"},a.createElement("button",{className:"close",onClick:this.close},a.createElement(e.symbol,{name:"headerCloseButton"})),a.createElement("span",{className:"title"},this.getTitle()),a.createElement("span",{className:"subtitle"},this.getSubtitle())),g.apply(this,[]),i.apply(this,[]),a.createElement(d.button,{className:"choose-domain-action-button",shouldTranslate:false,label:this.getActionButtonLabel(),onClick:this.handleAction,disabled:this.state.isActionDisabled}))}});define("savePublish/panels/save/chooseDomainPanel",["react","lodash","core","util","panels","savePublish/panels/save/chooseDomainPanel.rt"],function(a,b,c,d,e,f){"use strict";return a.createClass({displayName:"chooseDomainPanel",mixins:[c.mixins.editorAPIMixin],propTypes:{defaultSiteName:a.PropTypes.string.isRequired,freeDomainPrefix:a.PropTypes.string.isRequired,freeDomainHandler:a.PropTypes.func.isRequired,connectDomainHandler:a.PropTypes.func.isRequired,overrideTitle:a.PropTypes.string,overrideSubtitle:a.PropTypes.string},DomainStates:{FREE:"free",BUY:"buy"},getInitialState:function(){var a=this.getEditorAPI().siteName.validate(this.props.defaultSiteName);return{domainChoice:this.DomainStates.FREE,siteName:this.props.defaultSiteName,sanitizedSiteName:this.props.defaultSiteName,isActionDisabled:!a.success}},getTitle:function(){return d.translate(this.props.overrideTitle||"SAVE_CHOOSE_DOMAIN_TITLE_TITLE")},getSubtitle:function(){return d.translate(this.props.overrideSubtitle||"SAVE_CHOOSE_DOMAIN_TITLE_SUBTITLE")},getOptions:function(){var a={};a[this.DomainStates.FREE]={value:"free",label:d.translate("SAVE_CHOOSE_DOMAIN_BODY_RADIO_BUTTON_1"),prefix:this.props.freeDomainPrefix,domain:this.state.siteName,isEditable:this.state.domainChoice===this.DomainStates.FREE,domainValidator:this.getEditorAPI().siteName.validate};a[this.DomainStates.BUY]={value:"buy",label:d.translate("SAVE_CHOOSE_DOMAIN_BODY_RADIO_BUTTON_2_LINE1"),domain:d.translate("SAVE_CHOOSE_DOMAIN_BODY_RADIO_BUTTON_2_LINE2"),isEditable:false};return a},getNextDomainOptionValue:function(){return this.state.domainChoice===this.DomainStates.FREE?this.DomainStates.BUY:this.DomainStates.FREE},getActionButtonLabel:function(){return d.translate("SAVE_CHOOSE_DOMAIN_BUTTON_SAVENCONTINUE")},handleDomainChanged:function(a){var b={};b.isActionDisabled=!a.isValid;b.siteName=a.value;b.sanitizedSiteName=a.sanitizedValue;this.setState(b)},handleDomainOptionSelected:function(a){if(!b.isEqual(this.state.domainChoice,a)){var c={domainChoice:a};if(a===this.DomainStates.BUY){c.isActionDisabled=false;c.siteName=this.props.defaultSiteName;c.sanitizedSiteName=this.props.defaultSiteName}else{var d=this.getEditorAPI().siteName.validate(this.props.defaultSiteName);c.isActionDisabled=!d.success}this.setState(c);this.reportDomainClickedBI(a)}},handleAction:function(){this.reportActionButtonClickedBI(this.state.domainChoice);if(this.state.isActionDisabled){throw new Error("Should not get to handleAction if continue button is disabled")}if(this.state.domainChoice===this.DomainStates.FREE){this.refs.frame.close();this.props.freeDomainHandler(this.state.sanitizedSiteName)}else if(this.state.domainChoice===this.DomainStates.BUY){this.refs.frame.close();this.props.connectDomainHandler()}return},reportActionButtonClickedBI:function(a){var b=this.getEditorAPI();var d=a===this.DomainStates.BUY?"connect your own domain":"free WIX domain";b.bi.event(c.bi.events.save.chooseDomainPanel.ACTION_BUTTON_CLICKED,{value_selected:d})},reportDomainClickedBI:function(a){var b=this.getEditorAPI();var d=a===this.DomainStates.BUY?"connect your own domain":"free WIX domain";b.bi.event(c.bi.events.save.chooseDomainPanel.DOMAIN_OPTION_CLICKED,{selection:d})},getUserStatus:function(){var a="";if(!this.props.isSitePublished){a+="not_"}a+="published_";if(!this.props.isDomainConnected){a+="not_"}a+="connected";return a},domainInputBiReporter:function(a){var b={user_status:"not_published_not_connected",panel_name:this.props.panelName,save_or_publish:"save",is_first_save_or_publish:1};this.getEditorAPI().bi.event(c.bi.events.domainInput[a],b)},close:function(){this.refs.frame.close()},getKeyboardShortcuts:function(){var a=this;return{enter:function(){if(!a.state.isActionDisabled){a.handleAction()}},esc:function(){a.close()},tab:function(b){a.handleDomainOptionSelected(a.getNextDomainOptionValue());b.preventDefault()}}},render:f})});define("savePublish/panels/save/siteWasSavedPanel.rt",["react","lodash","panels","baseUI","util","symbols"],function(a,b,c,d,e,f){"use strict";function g(a,c){var d=b.assign({},a,c);if(a.hasOwnProperty("style")){d.style=b.defaults(d.style,a.style)}if(a.hasOwnProperty("className")&&c.hasOwnProperty("className")){d.className=c.className+" "+a.className}return d}function h(){var b=this.getInnerPanel();return a.createElement("div",{className:"wrapper"},a.createElement("div",{className:"domain-input"},a.createElement(d.domainInputWithEditButtons,this.getDomainInputProps())),this.shouldDisplayInnerPanel()?a.createElement(b,g({key:"innerPanel",className:"inner-panel "+this.getInnerPanelClass()},this.getInnerPanelProps())):null,a.createElement("div",{className:"site-saved-footer"},!this.props.isFirstSave?a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:true,key:"dontShowAgainCheckbox",className:"dont-show-again",label:"SAVE_PUBLISH_DO_NOT_SHOW_AGAIN_LABEL",valueLink:{value:this.state.doNotShowAgain,requestChange:this.handleDontShowAgainClicked}}):null,this.props.isSitePremium&&!this.props.isDomainConnected&&this.props.isFirstSave?a.createElement("span",{key:"needHelpConnectingDomain",className:"help-connecting-domain"},e.translate("SAVE_SITE_SAVED_NEED_HELP_LABEL")+" ",a.createElement("a",{target:"_blank",href:e.translate("SAVE_SITE_SAVED_NEED_HELP_URL"),onClick:this.handleNeedHelpConnectingDomainClicked},e.translate("SAVE_SITE_SAVED_NEED_HELP_LINK"))):null,a.createElement("div",{className:"footer-buttons"},this.props.isSitePublished?a.createElement(d.button,{onClick:this.continueToPublish,key:"publishButton",className:"publish-button btn-confirm-secondary",label:"SAVE_SITE_SAVED_WHATS_NEXT_PUBLISH_LINK",disabled:this.state.isContinueDisabled}):null,a.createElement(d.button,{className:"continue-button btn-confirm-primary",label:"SAVE_SITE_SAVED_BUTTON_OK",onClick:this.continueEditing,disabled:this.state.isContinueDisabled}))))}return function(){return a.createElement(c.frames.focusPanelFrame,{ref:"frame",className:this.getPanelClass(),panelName:this.props.panelName,shouldHideHeader:true,frameClassName:"save-publish-panel-frame",keyboardShortcuts:this.getKeyboardShortcuts()},a.createElement("header",{className:"save-publish-panel-header"},a.createElement("button",{className:"close",onClick:this.close},a.createElement(f.symbol,{name:"headerCloseButton"})),a.createElement("span",{className:"title"},this.getPanelTitle()),a.createElement("span",{className:"subtitle"},this.getPanelSubtitle())),h.apply(this,[]))}});define("savePublish/panels/content/generalContent.rt",["react","lodash","baseUILib","baseUI"],function(a,b,c,d){"use strict";return function(){return a.createElement("div",{className:this.getClassName()},a.createElement("div",{className:"main-title-wrapper"},a.createElement(c.divider,{long:true}),a.createElement("div",{className:"main-title"},this.translateIfNeeded(this.props.mainTitle)),a.createElement(c.divider,{long:true})),a.createElement("div",{className:"middle-spacer"}),a.createElement("div",{className:"bottom-section"},a.createElement("div",{className:"left-side"},this.props.symbolName?a.createElement(d.symbol,{name:this.props.symbolName,key:"symbol"}):null,this.props.imageSrc?a.createElement("img",{key:"image",src:this.props.imageSrc,style:this.props.imageStyle||{}}):null),a.createElement("div",{className:"right-side"},a.createElement("div",{className:"title"},this.translateIfNeeded(this.props.title)),this.props.subtitle?a.createElement("div",{key:"subtitle",className:"subtitle",dangerouslySetInnerHTML:{__html:this.translateIfNeeded(this.props.subtitle)}}):null,a.createElement("a",{className:"general-content-action",onClick:this.props.actionCallback},this.translateIfNeeded(this.props.actionLabel)))))}});define("savePublish/panels/content/generalContent",["react","panels","util","savePublish/panels/content/generalContent.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"generalContent",mixins:[c.translationMixin],propTypes:{symbolName:a.PropTypes.string,imageSrc:a.PropTypes.string,imageStyle:a.PropTypes.object,mainTitle:a.PropTypes.string.isRequired,title:a.PropTypes.string.isRequired,subtitle:a.PropTypes.string,actionCallback:a.PropTypes.func.isRequired,actionLabel:a.PropTypes.string.isRequired,className:a.PropTypes.string},getClassName:function(){return"general-content"+(this.props.className?" "+this.props.className:"")},render:d})});define("savePublish/panels/content/connectDomain.rt",["react","lodash","savePublish/panels/content/generalContent"],function(a,b,c){"use strict";function d(a,c){var d=b.assign({},a,c);if(a.hasOwnProperty("style")){d.style=b.defaults(d.style,a.style)}if(a.hasOwnProperty("className")&&c.hasOwnProperty("className")){d.className=c.className+" "+a.className}return d}return function(){return a.createElement(c,d({className:"connect-domain-content "+this.props.className},this.getGeneralContentProps()))}});define("savePublish/panels/content/connectDomain",["lodash","core","react","panels","util","savePublish/panels/content/connectDomain.rt","experiment"],function(a,b,c,d,e,f,g){"use strict";var h="savePublish.panels.connectDomainInProgress";var i=g.isOpen("spanishUpgradeText")?"UPGRADE_NOW_FOR_SPAIN_ONLY":"SAVE_PUBLISH_WHATS_NEXT_UPGRADE_LINK";function j(b){var c=b.campaigns.personalSale.getDiscountValue();var d=b.campaigns.personalSale.getAssetPath();var f=[d,"connectDomain_"+c+".svg"].join("/");var g=a.template(e.translate("SAVE_PUBLISH_WHATS_NEXT_PERSONAL_SALE_TEXT_DYNAMIC"));return{symbolName:"",className:"personal-sale-campaign",imageSrc:e.media.getAssetUrl(f),subtitle:g({discount:c})}}return c.createClass({displayName:"connectDomain",mixins:[b.mixins.editorAPIMixin],propTypes:{className:c.PropTypes.string,closePanel:c.PropTypes.func.isRequired,sitePublishedDomain:c.PropTypes.string,isDomainConnected:c.PropTypes.bool,isFirstPublish:c.PropTypes.bool,isSitePremium:c.PropTypes.bool,isFirstSave:c.PropTypes.bool,actionCallback:c.PropTypes.func,flowId:c.PropTypes.oneOf(a.values(b.constants.CONNECT_DOMAIN.FLOWS)).isRequired},getGeneralContentProps:function(){var b=this.getEditorAPI();var c={className:"",symbolName:"connectDomain",mainTitle:e.translate("SAVE_SITE_SAVED_WHATS_NEXT_LABEL"),title:e.translate("SAVE_PUBLISH_WHATS_NEXT_CONNECT_LINE1"),actionLabel:e.translate(this.props.isSitePremium?"SAVE_PUBLISH_WHATS_NEXT_CONNECT_LINK":i),shouldTranslate:false,actionCallback:this.panelAction,subtitle:e.translate("SAVE_PUBLISH_WHATS_NEXT_CONNECT_LINE2")};if(b.campaigns.personalSale.isActiveCampaign()&&!this.props.isSitePremium){a.assign(c,j(b))}return c},panelAction:function(){if(this.props.actionCallback){this.props.actionCallback()}this.props.closePanel();var a=this.isSiteBeingConnectedToDomain();if(a){this.openConnectDomainInProgressPanel()}else if(!this.props.isDomainConnected&&this.props.isSitePremium){this.getEditorAPI().account.openConnectDomain(this.props.flowId)}else{this.getEditorAPI().account.upgrade(this.getUpgradeReferralCode())}},getUpgradeReferralCode:function(){var a="edhtml_";switch(this.props.flowId){case b.constants.CONNECT_DOMAIN.FLOWS.PUBLISH:var c=this.props.isFirstPublish?"FIRST_PUBLISH":"SECOND_PUBLISH";a+="PUBLISH_FLOW_"+c;break;case b.constants.CONNECT_DOMAIN.FLOWS.SAVE:a+="SAVE_FLOW_SECOND_SAVE_AND_PUBLISHED";break;default:a=null}return a},isSiteBeingConnectedToDomain:function(){return this.isUnconnectedDomainPremium()&&!a.isEmpty(this.props.sitePublishedDomain)&&!a.includes(this.props.sitePublishedDomain,"wix.com")},isUnconnectedDomainPremium:function(){return!this.props.isDomainConnected&&this.props.isSitePremium},openConnectDomainInProgressPanel:function(){d.panelManager.openPanel(h,{connectedDomainURL:this.props.sitePublishedDomain,currentPublicURL:this.props.currentDomain},true)},render:f})});define("savePublish/panels/content/publishContent.rt",["react","lodash","savePublish/panels/content/generalContent"],function(a,b,c){"use strict";return function(){return a.createElement(c,b.assign({},{className:this.getClassName()},this.getGeneralContentProps()))}});define("savePublish/panels/content/publishContent",["react","core","panels","savePublish/panels/content/publishContent.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"publishContent",mixins:[b.mixins.editorAPIMixin],propTypes:{closePanel:a.PropTypes.func.isRequired,publishMethod:a.PropTypes.func.isRequired,className:a.PropTypes.string,actionCallback:a.PropTypes.func},getClassName:function(){return"publish-site-content"+(this.props.className?" "+this.props.className:"")},getGeneralContentProps:function(){return{symbolName:"publishSite",mainTitle:"SAVE_SITE_SAVED_WHATS_NEXT_LABEL",title:"SAVE_SITE_SAVED_WHATS_NEXT_PUBLISH_LINE",actionLabel:"SAVE_SITE_SAVED_WHATS_NEXT_PUBLISH_LINK",actionCallback:this.publishSite}},publishSite:function(){this.props.closePanel();this.props.publishMethod();if(this.props.actionCallback){this.props.actionCallback()}},render:d})});define("savePublish/panels/save/siteWasSavedPanel",["react","lodash","core","util","savePublish/constants/constants","savePublish/constants/savePublishErrorPanelData","savePublish/managers/publishManager","savePublish/panels/save/siteWasSavedPanel.rt","savePublish/panels/content/connectDomain","savePublish/panels/content/publishContent","pLoader!santa:utils"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";var l={PUBLISH:"PUBLISH",CONNECT_DOMAIN:"CONNECT_DOMAIN"};function m(a){var b=a.lastIndexOf("/");return{prefix:a.slice(0,b+1),siteName:a.slice(b+1)}}return a.createClass({displayName:"siteWasSavedPanel",mixins:[a.addons.LinkedStateMixin,c.mixins.editorAPIMixin],propTypes:{domain:a.PropTypes.string.isRequired,isSitePremium:a.PropTypes.bool,isFirstSave:a.PropTypes.bool,isDomainConnected:a.PropTypes.bool,isSitePublished:a.PropTypes.bool,isMockSave:a.PropTypes.bool,overrideTitle:a.PropTypes.string,overrideSubtitle:a.PropTypes.string,callback:a.PropTypes.func},getInitialState:function(){var a={isContinueDisabled:false,doNotShowAgain:null,domain:this.props.domain};if(!this.props.isFirstSave){var b=this.getEditorAPI().getUserPreferences();if(b){a.doNotShowAgain=!!b.session.get(c.constants.USER_PREFS.SAVE.SITE_SAVED_DONT_SHOW_AGAIN)}}return a},getPanelTitle:function(){return d.translate(this.props.overrideTitle||"SAVE_SITE_SAVED_TITLE_TITLE")},getPanelSubtitle:function(){return d.translate(this.props.overrideSubtitle||"SAVE_SITE_SAVED_TITLE_SUBTITLE")},getDomainInputProps:function(){var a;var b=this.state.domain;var c=!this.props.isDomainConnected;if(c){var d=m(b);a={prefix:d.prefix,value:d.siteName,isEditable:true,domainValidator:this.getEditorAPI().siteName.validate,domainHandler:this.props.isMockSave?null:this.renameSiteAndProcessResult,onChange:this.handleDomainEditingStatusChanged}}else{a={value:b,isEditable:false}}a.biHandler=this.domainInputBiReporter;return a},getInnerPanelType:function(){if(!this.props.isSitePublished){return l.PUBLISH}else if(!this.props.isDomainConnected){return l.CONNECT_DOMAIN}},getInnerPanel:function(){var a=this.getInnerPanelType();switch(a){case l.PUBLISH:return j;case l.CONNECT_DOMAIN:return i}},getPanelClass:function(){var a="site-was-saved-panel";var b=this.getInnerPanelClass();a+=b?" contains-"+b:"";if(this.props.isSitePremium&&this.props.isSitePublished&&this.props.isDomainConnected){a+=" narrow-domain-input"}return a+" save-publish-panel"},getInnerPanelClass:function(){var a=this.getInnerPanelType();switch(a){case l.PUBLISH:return"publish-inner-panel";case l.CONNECT_DOMAIN:return"connect-domain-inner-panel"}},getInnerPanelProps:function(){var a={sitePublishedDomain:this.props.domain,isDomainConnected:this.props.isDomainConnected,isFirstPublish:!this.props.isSitePublished,isSitePremium:this.props.isSitePremium,isFirstSave:this.props.isFirstSave,flowId:c.constants.CONNECT_DOMAIN.FLOWS.SAVE,closePanel:this.close};var b=this.getInnerPanelType();switch(b){case l.PUBLISH:a.publishMethod=this.props.isMockSave?g.configurePublish.bind(g,this.getEditorAPI()):g.publish.bind(g,this.getEditorAPI());if(!this.props.isMockSave){a.actionCallback=function(){this.reportPublishClickedBI();this.getEditorAPI().bi.event(c.bi.events.publish.PUBLISH_CLICK,{origin:"saveSuccessPanel"})}.bind(this)}break;case l.CONNECT_DOMAIN:if(!this.props.isMockSave){a.actionCallback=this.reportConnectDomainClickedBI}break}return a},shouldDisplayInnerPanel:function(){return!this.props.isSitePublished||!this.props.isDomainConnected},continueToPublish:function(){if(!this.props.isMockSave){this.getEditorAPI().bi.event(c.bi.events.publish.PUBLISH_CLICK,{origin:"saveSuccessPanel"});this.reportBIWithUserStatus(c.bi.events.save.siteWasSavedPanel.SECOND_SAVE_PUBLISH_NOW_BUTTON_CLICKED)}this.close();g.publish(this.getEditorAPI())},continueEditing:function(){if(!this.props.isMockSave){if(this.props.isFirstSave){this.getEditorAPI().bi.event(c.bi.events.save.siteWasSavedPanel.FIRST_SAVE_ACTION_BUTTON_CLICKED,{})}else{this.reportBIWithUserStatus(c.bi.events.save.siteWasSavedPanel.SECOND_SAVE_ACTION_BUTTON_CLICKED)}}if(this.state.isContinueDisabled){throw new Error("Should not get to continueEditing if continue button is disabled")}if(this.state.doNotShowAgain){var a=this.getEditorAPI().getUserPreferences();if(a){a.session.set(c.constants.USER_PREFS.SAVE.SITE_SAVED_DONT_SHOW_AGAIN,this.state.doNotShowAgain)}else{k.log.error("siteWasSavedPanel tried to use userPreferences while they are not initialized")}}this.close()},reportBIWithUserStatus:function(a){var b={user_status:this.getUserStatus()};this.getEditorAPI().bi.event(a,b)},getUserStatus:function(){var a="";if(!this.props.isSitePublished){a+="not_"}a+="published_";if(!this.props.isDomainConnected){a+="not_"}a+="connected";return a},renameSiteAndProcessResult:function(a,c,d){var g=this.getEditorAPI();g.siteName.rename(a,function a(){c()},function a(c){var h=c&&c.errorCode;if(h===e.RENAME.ERRORS.SITE_NAME_TAKEN){d("SAVE_SITE_NAME_ALREADY_EXISTS")}else{d();var i=b.chain(f.NAME_SITE_AGAIN_PANEL_DATA).clone().defaults(f.SAVE_ERROR_DEFAULT_PANEL_DATA).assign({errorCode:h}).value();g.panelManager.openPanel("savePublish.panels.common.failPanel",i,true)}})},handleDomainEditingStatusChanged:function(a){var b={};if(a){var c=m(this.props.domain).prefix;b.isContinueDisabled=false;b.domain=c+a}else{b.isContinueDisabled=true}this.setState(b)},handleNeedHelpConnectingDomainClicked:function(){this.getEditorAPI().bi.event(c.bi.events.save.siteWasSavedPanel.HELP_CONNECTING_DOMAIN_CLICKED,{})},handleDontShowAgainClicked:function(a){this.setState({doNotShowAgain:a});this.getEditorAPI().bi.event(c.bi.events.save.siteWasSavedPanel.SECOND_SAVE_DONT_SHOW_AGAIN_CLICKED,{toggle:a,user_status:this.getUserStatus()})},reportPublishClickedBI:function(){this.getEditorAPI().bi.event(c.bi.events.save.siteWasSavedPanel.PUBLISH_NOW_CLICKED,{user_status:this.getUserStatus(),is_first_save:this.props.isFirstSave?1:0})},reportConnectDomainClickedBI:function(){this.getEditorAPI().bi.event(c.bi.events.save.siteWasSavedPanel.SECOND_SAVE_CONNECT_DOMAIN_CLICKED,{user_status:this.getUserStatus()})},domainInputBiReporter:function(a){if(!this.props.isMockSave){var b={user_status:this.getUserStatus(),panel_name:this.props.panelName,save_or_publish:"save",is_first_save_or_publish:this.props.isFirstSave?1:0};this.getEditorAPI().bi.event(c.bi.events.domainInput[a],b)}},componentWillUnmount:function(){if(this.props.callback){this.props.callback()}},close:function(){this.refs.frame.close()},getKeyboardShortcuts:function(){var a=this;return{enter:function(){if(!a.state.isContinueDisabled){a.continueEditing()}},esc:function(){a.close()}}},render:h})});define("savePublish/panels/save/concurrentSavePanel.rt",["react","lodash","panels","baseUI","symbols","util"],function(a,b,c,d,e,f){"use strict";return function(){return a.createElement(c.frames.confirmationPanelFrame,{ref:"frame",panelName:this.props.panelName,className:"concurrent-save-panel save-publish-panel",panelTitle:f.translate(this.getTitle()),confirmLabel:"SAVE_ERROR_CONCURRENT_EDITING_SAVE_BUTTON",cancelLabel:"SAVE_ERROR_CONCURRENT_EDITING_DONT_SAVE_BUTTON",onConfirm:this.overrideSave,onCancel:this.handleCancel},a.createElement("div",{className:"content-wrapper"},a.createElement("div",{className:"error-logo"},a.createElement(d.symbol,{name:"plaster"})),a.createElement("div",{className:"description-wrapper"},a.createElement("span",{className:"description-line",dangerouslySetInnerHTML:{__html:f.translate(this.getBodyText()[0])}}),this.isAutosave()?a.createElement("br",{}):null,a.createElement("span",{className:"description-line"+" "+b({initialPadding:this.isAutosave()}).transform(function(a,b,c){if(b){a.push(c)}},[]).join(" "),dangerouslySetInnerHTML:{__html:f.translate(this.getBodyText()[1])}}))))}});define("savePublish/panels/save/concurrentSavePanel",["react","core","savePublish/panels/save/concurrentSavePanel.rt","pLoader!santa:utils"],function(a,b,c,d){"use strict";return a.createClass({displayName:"concurrentSavePanel",mixins:[b.mixins.editorAPIMixin],PropTypes:{overrideSaveMethod:a.PropTypes.func.isRequired,onCancel:a.PropTypes.func},isAutosave:function(){return this.props.origin==="autosave"},getTitle:function(){if(this.isAutosave()){return"AUTOSAVE_ERROR_CONCURRENT_EDITING_TITLE"}return"SAVE_PUBLISH_MULTIPLE_TABS_ERRROR_TOOLTIP_TITLE"},getBodyText:function(){if(this.isAutosave()){return["AUTOSAVE_ERROR_CONCURRENT_EDITING_BODY_LINE1","AUTOSAVE_ERROR_CONCURRENT_EDITING_BODY_LINE2"]}return["SAVE_PUBLISH_MULTIPLE_TABS_ERRROR_TOOLTIP_LINE1","SAVE_PUBLISH_MULTIPLE_TABS_ERRROR_TOOLTIP_LINE2"]},overrideSave:function(){if(this.props.overrideSaveMethod){this.props.overrideSaveMethod(this.getEditorAPI);this.getEditorAPI().bi.event(b.bi.events.save.saveFailed.CONCURRENT_SAVE,{selection:"save"})}else{d.log.info("Mock Overriding Save")}this.close()},handleCancel:function(){if(this.props.overrideSaveMethod){this.getEditorAPI().bi.event(b.bi.events.save.saveFailed.CONCURRENT_SAVE,{selection:"don't save"})}this.close();if(this.props.onCancel){this.props.onCancel()}},close:function(){this.refs.frame.close()},render:c})});define("savePublish/panels/save/saveConfigurationPanel.rt",["react","lodash","panels","baseUI"],function(a,b,c,d){"use strict";function e(a,c){var d=b.assign({},a,c);if(a.hasOwnProperty("style")){d.style=b.defaults(d.style,a.style)}if(a.hasOwnProperty("className")&&c.hasOwnProperty("className")){d.className=c.className+" "+a.className}return d}return function(){return a.createElement(c.frames.emptyPanelFrame,e({ref:"frame",className:"save-configuration-panel"},this.getFrameProps()),a.createElement("a",{className:"close-button",onClick:this.close},"x"),a.createElement("h2",{style:{textAlign:"center"}},"Save Testing Configuration"),a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:true,className:"checkbox-field",shouldTranslate:false,label:"First save",valueLink:this.linkState("isFirstSave")}),a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:true,className:"checkbox-field",shouldTranslate:false,label:"Save succeeds",valueLink:this.linkState("shouldSaveSucceed")}),a.createElement("p",{},a.createElement("br",{}),"Premium Interaction:"),a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:true,className:"checkbox-field",shouldTranslate:false,label:"Site is/upgraded-to premium",value:this.state.isSitePremium,onChange:this.premiumToggled}),a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:true,className:"checkbox-field",shouldTranslate:false,label:"Domain is/will-be connected",value:this.state.isDomainConnected,onChange:this.domainConnectedToggled}),a.createElement(d.textInput,{className:"domain-text-field",shouldTranslate:false,label:"Custom Domain",valueLink:this.linkState("domain"),disabled:!this.state.isDomainConnected}),a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:true,className:"checkbox-field"+(this.state.isFirstSave?" disabled":""),shouldTranslate:false,label:"Site is published",valueLink:this.linkState("isSitePublished"),diabled:this.state.isFirstSave}),a.createElement("button",{className:"concurrent-save-button",shouldTranslate:false,onClick:this.openConcurrentSave},"Concurrent Save"),a.createElement("button",{className:"save-reminder-button",shouldTranslate:false,onClick:this.openSaveReminder},"Save Reminder"),a.createElement("div",{className:"save-configuration-footer"},a.createElement(d.button,{className:"confirm-button",shouldTranslate:false,label:"Start Save",onClick:this.onConfirm})))}});define("savePublish/panels/save/saveConfigurationPanel",["react","core","panels","savePublish/panels/save/saveConfigurationPanel.rt","pLoader!santa:utils"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"SaveConfigurationPanel",mixins:[a.addons.LinkedStateMixin,b.mixins.editorAPIMixin],propTypes:{onConfirm:a.PropTypes.func.isRequired},getInitialState:function(){return{isSitePremium:false,isFirstSave:true,isDomainConnected:false,domain:"http://www.my-domain.com",isSitePublished:false,shouldSaveSucceed:true}},getFrameProps:function(){return{panelName:this.props.panelName}},openConcurrentSave:function(){c.panelManager.openPanel("savePublish.panels.save.concurrentSavePanel",{overrideSaveMethod:function(){e.log.info("Override Save")}},true)},openSaveReminder:function(){c.panelManager.openPanel("savePublish.panels.save.saveReminderPanel",{saveMethod:this.onConfirm},true)},componentWillUpdate:function(a,b){if(b.isFirstSave){if(b.isSitePublished){this.setState({isSitePublished:false,isFirstSave:true})}}},premiumToggled:function(){var a=!this.state.isSitePremium;this.setState({isSitePremium:a,isDomainConnected:!a?false:this.state.isDomainConnected})},domainConnectedToggled:function(){var a=!this.state.isDomainConnected;this.setState({isDomainConnected:a,isSitePremium:a||this.state.isSitePremium})},onConfirm:function(){this.props.onConfirm(this.getEditorAPI(),{isSitePremium:this.state.isSitePremium,isFirstSave:this.state.isFirstSave,isDomainConnected:this.state.isDomainConnected,domain:this.state.domain,isSitePublished:this.state.isSitePublished,shouldSaveSucceed:this.state.shouldSaveSucceed})},close:function(){this.refs.frame.close()},render:d})});define("savePublish/panels/save/saveReminderPanel.rt",["react","lodash","util","baseUI","panels","experiment"],function(a,b,c,d,e,f){"use strict";return function(){return!f.isOpen("disableSaveReminder")?a.createElement(e.frames.messagePanelFrame,{ref:"frame",editorAPI:this.getEditorAPI(),key:"saveReminder",panelName:this.props.panelName,className:"save-reminder-panel save-publish-panel",panelTitle:c.translate("SAVE_REMINDER_MSG_TITLE"),confirmLabel:"SAVE_REMINDER_MSG_BUTTON",onConfirm:this.handleSave,keyboardShortcuts:this.getKeyboardShortcuts()},a.createElement("div",{className:"content-wrapper"},a.createElement("div",{className:"icon"},a.createElement(d.symbol,{name:"saveYourWork"})),a.createElement("div",{className:"message"},c.translate("SAVE_REMINDER_MSG_BODY")))):null}});define("savePublish/panels/save/saveReminderPanel",["react","lodash","core","savePublish/panels/save/saveReminderPanel.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"saveReminderPanel",mixins:[c.mixins.editorAPIMixin],propTypes:{saveMethod:a.PropTypes.func.isRequired},componentWillMount:function(){this.getEditorAPI().bi.event(c.bi.events.save.saveReminder.REMINDER_DISPLAYED,{origin:"pop up message"})},handleSave:function(){this.getEditorAPI().bi.event(c.bi.events.save.saveReminder.SAVE_CLICKED,{});this.close();this.props.saveMethod()},getKeyboardShortcuts:function(){var a=this;return{enter:function(){a.close();a.handleSave()},esc:function(){a.close()}}},close:function(){this.refs.frame.close()},render:d})});define("savePublish/panels/save/onBoardingMigrationConfirmationPanel.rt",["react","lodash","panels","baseUI"],function(a,b,c,d){"use strict";return function(){return a.createElement(c.frames.focusPanelFrame,{ref:"frame",key:"onBoardingMigrationConfirmationPanel",shouldHideHelp:true,className:"save-on-boarding-site-confirm-panel",title:this.translateIfNeeded("ADI_EDITOR_MIGRATION_SAVEPOPUP_TITLE"),panelName:this.props.panelName},a.createElement("div",{className:"save-on-boarding-site-confirm-content"},a.createElement("div",{className:"image-container"},a.createElement(d.symbol,{name:"obMigrationBeforeSave"})),a.createElement("div",{className:"description-container"},a.createElement("span",{className:"description-text"},this.translateIfNeeded("ADI_EDITOR_MIGRATION_SAVEPOPUP_TEXT"))),a.createElement("div",{className:"footer-buttons"},a.createElement(d.button,{onClick:this.navigateToOnBoarding,className:"btn-confirm-secondary btn-md footer-button",label:"ADI_EDITOR_MIGRATION_SAVEPOPUP_BUTTON_ADI"}),a.createElement(d.button,{onClick:this.saveDocument,className:"btn-confirm-primary btn-md footer-button",label:"ADI_EDITOR_MIGRATION_SAVEPOPUP_BTN_SAVE"}))))}});define("savePublish/panels/save/onBoardingMigrationConfirmationPanel",["react","panels","util","core","savePublish/panels/save/onBoardingMigrationConfirmationPanel.rt"],function(a,b,c,d,e){"use strict";var f={NAVIGATE_TO_OB:"Go Back to Wix ADI",SAVE:"Save Changes"};function g(a,b){a.bi.event(d.bi.events.ON_BOARDING_MIGRATION.PANEL_ACTION_CLICKED,{action:b})}return a.createClass({displayName:"onBoardingMigrationConfirmationPanel",
propTypes:{panelName:a.PropTypes.string.isRequired,onConfirm:a.PropTypes.func.isRequired},mixins:[c.translationMixin,d.mixins.editorAPIMixin],saveDocument:function(){g(this.getEditorAPI(),f.SAVE);this.props.onConfirm();this.close()},navigateToOnBoarding:function(){g(this.getEditorAPI(),f.NAVIGATE_TO_OB);window.location=c.editorModel.onboardingEditorUrl},close:function(){b.panelManager.closePanelByName(this.props.panelName)},render:e})});define("savePublish/panels/save/saveYourSitePanel.rt",["react","lodash","util","baseUI","panels"],function(a,b,c,d,e){"use strict";return function(){return a.createElement(e.frames.messagePanelFrame,{ref:"frame",panelName:this.props.panelName,className:"save-your-site-panel",panelTitle:c.translate(this.props.title),confirmLabel:"TOPBAR_SETTINGS_BUTTON_SAVE",onConfirm:this.handleSave,keyboardShortcuts:this.keyboardShortcuts},a.createElement("div",{className:"content-wrapper"},a.createElement("div",{className:"logo"},a.createElement(d.symbol,{name:"saveYourWork"})),a.createElement("div",{className:"message"},c.translate(this.props.messageBody))))}});define("savePublish/panels/save/saveYourSitePanel",["react","lodash","core","savePublish/managers/saveManager","savePublish/panels/save/saveYourSitePanel.rt"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"saveYourSitePanel",mixins:[c.mixins.editorAPIMixin],propTypes:{title:a.PropTypes.string.isRequired,messageBody:a.PropTypes.string.isRequired},getInitialState:function(){this.keyboardShortcuts={enter:this.handleSave,esc:this.close};return{}},handleSave:function(){this.close();d.save(this.getEditorAPI())},close:function(){this.refs.frame.close()},render:e})});define("savePublish/panels/save/savePanels",["savePublish/panels/save/chooseDomainPanel","savePublish/panels/save/siteWasSavedPanel","savePublish/panels/save/concurrentSavePanel","savePublish/panels/save/saveConfigurationPanel","savePublish/panels/save/saveReminderPanel","savePublish/panels/save/onBoardingMigrationConfirmationPanel","savePublish/panels/save/saveYourSitePanel"],function(a,b,c,d,e,f,g){"use strict";return{chooseDomainPanel:a,siteWasSavedPanel:b,concurrentSavePanel:c,saveConfigurationPanel:d,saveReminderPanel:e,onBoardingMigrationConfirmationPanel:f,saveYourSitePanel:g}});define("savePublish/panels/publish/config/publishConfigurationPanel.rt",["react","lodash","panels","baseUI"],function(a,b,c,d){"use strict";return function(){return a.createElement(c.frames.emptyPanelFrame,{ref:"publishFrame",className:"save-configuration-panel",panelName:this.props.panelName},a.createElement("a",{className:"close-button",onClick:this.close},"x"),a.createElement("h2",{style:{textAlign:"center"}},"Publish Testing Configuration"),a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:true,className:"checkbox-field",shouldTranslate:false,label:"Is Contributor to site",valueLink:this.linkState("isSiteContributor")}),a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:true,className:"checkbox-field",shouldTranslate:false,label:"Did Publish Succeed",valueLink:this.linkState("shouldPublishSucceed")}),a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:true,className:"checkbox-field",shouldTranslate:false,label:"Site is Premium",valueLink:this.linkState("isPremiumUser")}),a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:true,className:"checkbox-field",shouldTranslate:false,label:"First Publish",valueLink:this.linkState("isFirstPublish")}),a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:true,className:"checkbox-field",shouldTranslate:false,label:"Is Domain Connected",valueLink:this.linkState("isDomainConnected")}),a.createElement(d.textInput,{className:"domain-text-field",shouldTranslate:false,label:"Site address (Domain Name)",valueLink:this.linkState("sitePremiumDomain")}),a.createElement(d.button,{className:"confirm-button",disabled:!this.state.isPremiumUser&&this.state.isDomainConnected&&this.state.shouldPublishSucceed,shouldTranslate:false,label:"Start Publish",onClick:this.onConfirm}))}});define("savePublish/panels/publish/config/publishConfigurationPanel",["react","savePublish/panels/publish/config/publishConfigurationPanel.rt"],function(a,b){"use strict";return a.createClass({displayName:"publishConfigurationPanel",mixins:[a.addons.LinkedStateMixin],propTypes:{onConfirm:a.PropTypes.func.isRequired},getInitialState:function(){return{isSiteContributor:false,isFirstPublish:true,isDomainConnected:false,isPremiumUser:true,shouldPublishSucceed:true,sitePremiumDomain:"http://www.published-site-domain.com"}},onConfirm:function(){this.props.onConfirm({isSiteContributor:this.state.isSiteContributor,isFirstPublish:this.state.isFirstPublish,isDomainConnected:this.state.isDomainConnected,sitePremiumDomain:this.state.sitePremiumDomain,isPremiumUser:this.state.isPremiumUser,shouldPublishSucceed:this.state.shouldPublishSucceed})},close:function(){this.refs.publishFrame.close()},render:b})});define("savePublish/panels/publish/content/postPublishPromotePanel.rt",["react","lodash","baseUILib","baseUI"],function(a,b,c,d){"use strict";function e(b,c){return a.createElement("div",{className:"promote"},b.symbol?a.createElement("div",{key:"promotionSymbol-"+b.key,className:"promote-symbol promote-symbol-"+b.key},a.createElement(d.symbol,{name:b.symbol})):null,b.img&&!b.symbol?a.createElement("div",{key:"promotionImg-"+b.key,className:"promote-image",style:{backgroundImage:"url("+b.img+")"}}):null,a.createElement("div",{className:"description"},b.description),a.createElement("a",{onClick:b.action},b.actionTitle))}return function(){return a.createElement("div",{className:"panel-shout-out"},a.createElement("div",{className:"promote-title-wrapper"},a.createElement(c.divider,{long:true}),a.createElement("div",{className:"promote-title"},this.getTitle()),a.createElement(c.divider,{long:true})),a.createElement.apply(this,["div",{className:"promotion-content"},b.map(this.getPanelContent(),e.bind(this))]))}});define("savePublish/panels/publish/content/shoutoutPanel",["lodash","react","core","util","savePublish/panels/publish/content/postPublishPromotePanel.rt"],function(a,b,c,d,e){"use strict";return b.createClass({displayName:"shoutoutPanel",mixins:[c.mixins.editorAPIMixin],propTypes:{isUserPremium:b.PropTypes.bool,languageCode:b.PropTypes.string,metaSiteId:b.PropTypes.string.isRequired,sitePublicUrl:b.PropTypes.string,siteNameSEO:b.PropTypes.string,siteDescriptionSEO:b.PropTypes.string,isFirstPublish:b.PropTypes.bool,userStatus:b.PropTypes.string},getTitle:function(){return d.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_TITLE")},getPanelContent:function(){var a={key:"facebook",symbol:"publishFacebook",description:d.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_1_TITLE"),actionTitle:d.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_1_LINK"),action:this.openFacebook};var b={key:"twitter",symbol:"publishTwitter",description:d.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_2_TITLE"),actionTitle:d.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_2_LINK"),action:this.openTwitter};var c={key:"shoutout",symbol:"publishShoutout",description:d.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_3_TITLE"),actionTitle:d.translate("PUBLISH_CONGRATULATIONS_WHATS_NEXT_3_LINK"),action:this.openShoutout};return[a,b,c]},openFacebook:function(){this.sendSecondPublishBI(c.bi.events.publish.Second_Publish_facebook_Share_click);c.utils.social.openFacebook(this.props.sitePublicUrl,this.props.languageCode,this.props.siteNameSEO,this.props.siteDescriptionSEO)},openTwitter:function(){this.sendSecondPublishBI(c.bi.events.publish.Second_Publish_Twitter_share_click);c.utils.social.openTwitter(this.props.sitePublicUrl,this.props.isUserPremium)},openShoutout:function(){this.sendSecondPublishBI(c.bi.events.publish.Second_Publish_ShoutOut_Share_click);c.utils.social.openShoutout(this.props.metaSiteId)},sendSecondPublishBI:function(a){if(!this.props.isFirstPublish&&this.props.userStatus){this.getEditorAPI().bi.event(a,{user_status:this.props.userStatus})}},render:e})});define("savePublish/panels/publish/content/growBusinessPanel",["react","core","util","savePublish/panels/publish/content/postPublishPromotePanel.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"growBusinessPanel",mixins:[b.mixins.editorAPIMixin],propTypes:{metaSiteId:a.PropTypes.string.isRequired,isFirstPublish:a.PropTypes.bool,userStatus:a.PropTypes.string},getTitle:function(){return c.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_TITLE")},getPanelContent:function(){var a={key:"newsletter",symbol:"publishShoutout",description:c.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_1_TITLE"),actionTitle:c.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_1_LINK"),action:this.openShoutout};var b={key:"mail",symbol:"promoteMail",description:c.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_2_TITLE"),actionTitle:c.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_2_LINK"),action:this.getYourOwnMailbox};var d={key:"traffic",symbol:"promoteContact",description:c.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_3_TITLE"),actionTitle:c.translate("PUBLISH_CONGRATULATIONS_NEXT_PROMOTE_3_LINK"),action:this.getTrafficApps};return[a,b,d]},openShoutout:function(){this.sendPublishBI(b.bi.events.publish.First_Publish_Send_ShoutOut_link_click,b.bi.events.publish.Second_Publish_ShoutOut_Share_click);b.utils.social.openShoutout(this.props.metaSiteId)},getYourOwnMailbox:function(){this.sendPublishBI(b.bi.events.publish.First_Publish_get_own_Mailbox_link_click,b.bi.events.publish.Second_Publish_get_own_Mailbox_click);window.open("https://premium.wix.com/wix/api/googleMailBoxConsole?referralAdditionalInfo=da_quick_actions")},getTrafficApps:function(){this.sendPublishBI(b.bi.events.publish.First_Publish_Traffic_Apps_link_click,b.bi.events.publish.Second_Publish_Traffic_Apps_click);var a=["http://www.wix.com/my-account/sites/",this.props.metaSiteId,"/apps/all?referralInfo=premium_publish"].join("");window.open(a)},sendPublishBI:function(a,b){if(this.props.isFirstPublish&&this.props.userStatus){this.getEditorAPI().bi.event(a,{user_status:this.props.userStatus})}else if(!this.props.isFirstPublish&&this.props.userStatus){this.getEditorAPI().bi.event(b,{user_status:this.props.userStatus})}},render:d})});define("savePublish/panels/content/musicPromoContent.rt",["react","lodash","savePublish/panels/content/generalContent"],function(a,b,c){"use strict";function d(a,c){var d=b.assign({},a,c);if(a.hasOwnProperty("style")){d.style=b.defaults(d.style,a.style)}if(a.hasOwnProperty("className")&&c.hasOwnProperty("className")){d.className=c.className+" "+a.className}return d}return function(){return a.createElement(c,d({className:"music-promo-content "+this.props.className},this.getGeneralContentProps()))}});define("savePublish/panels/content/musicPromoContent",["react","lodash","core","util","staticAssets","savePublish/panels/content/musicPromoContent.rt"],function(a,b,c,d,e,f){"use strict";return a.createClass({displayName:"musicPromoContent",propTypes:{className:a.PropTypes.string,closePanel:a.PropTypes.func.isRequired},mixins:[c.mixins.editorAPIMixin],getGeneralContentProps:function(){var a,b;var c=d.browserUtil.getDevicePixelRatio();if(c>=2){a=d.media.getMediaUrl(e.staticAssetsMap["savePublish/panels/content/musicPromotionRetina.png"]);b={width:110.5}}else{a=d.media.getMediaUrl(e.staticAssetsMap["savePublish/panels/content/musicPromotion.png"])}var f={className:"",imageSrc:a,imageStyle:b,mainTitle:d.translate("SAVE_SITE_SAVED_WHATS_NEXT_LABEL"),title:d.translate("MUSIC_PROMOTION_PUBLISH_WHATS_NEXT_TITLE"),subtitle:d.translate("MUSIC_PROMOTION_PUBLISH_WHATS_NEXT_BODY1"),actionLabel:d.translate("MUSIC_PROMOTION_PUBLISH_WHATS_NEXT_BUTTON"),shouldTranslate:false,actionCallback:this.handleActionClicked};return f},handleActionClicked:function(){var a=c.bi.events.musicPromotionPopup.submit_video_clicked;var b={origin:"post-publish-link"};this.getEditorAPI().bi.event(a,b);var e=d.translate("MUSIC_PROMOTION_PUBLISH_WHATS_NEXT_BUTTON_URL");this.props.closePanel();window.open(e)},render:f})});define("savePublish/panels/content/photographyPromoContent.rt",["react","lodash","savePublish/panels/content/generalContent"],function(a,b,c){"use strict";function d(a,c){var d=b.assign({},a,c);if(a.hasOwnProperty("style")){d.style=b.defaults(d.style,a.style)}if(a.hasOwnProperty("className")&&c.hasOwnProperty("className")){d.className=c.className+" "+a.className}return d}return function(){return a.createElement(c,d({className:"photo-promo-content "+this.props.className},this.getGeneralContentProps()))}});define("savePublish/panels/content/photographyPromoContent",["react","lodash","core","util","staticAssets","savePublish/panels/content/photographyPromoContent.rt"],function(a,b,c,d,e,f){"use strict";return a.createClass({displayName:"photographyPromoContent",propTypes:{className:a.PropTypes.string,closePanel:a.PropTypes.func.isRequired},mixins:[c.mixins.editorAPIMixin],getGeneralContentProps:function(){var a,b;var c=d.browserUtil.getDevicePixelRatio();if(c>=2){a=d.media.getMediaUrl(e.staticAssetsMap["savePublish/panels/content/photoPromotionRetina.gif"]);b={width:"100%"}}else{a=d.media.getMediaUrl(e.staticAssetsMap["savePublish/panels/content/photoPromotion.gif"])}return{className:"",imageSrc:a,imageStyle:b,mainTitle:d.translate("SAVE_SITE_SAVED_WHATS_NEXT_LABEL"),title:d.translate("PHOTO_PROMO_PUBLISH_HEADER"),subtitle:d.translate("PHOTO_PROMO_PUBLISH_TEXT"),actionLabel:d.translate("PHOTO_PROMO_PUBLISH_CTA"),shouldTranslate:false,actionCallback:this.handleActionClicked}},handleActionClicked:function(){var a=c.bi.events.photographyPromotionPopup.submit_video_clicked;var b={origin:"post-publish-link"};this.getEditorAPI().bi.event(a,b);var e=d.translate("PHOTO_PROMO_PUBLISH_CTA_URL");this.props.closePanel();window.open(e)},render:f})});define("savePublish/panels/publish/publishSuccessPanel.rt",["react","lodash","panels","util","baseUI","symbols"],function(a,b,c,d,e,f){"use strict";function g(a,c){var d=b.assign({},a,c);if(a.hasOwnProperty("style")){d.style=b.defaults(d.style,a.style)}if(a.hasOwnProperty("className")&&c.hasOwnProperty("className")){d.className=c.className+" "+a.className}return d}function h(){var b=this.getInnerPanel();return a.createElement(c.frames.focusPanelFrame,g({ref:"frame",className:this.getFrameClass(),frameClassName:"save-publish-panel-frame",keyboardShortcuts:this.getShortcuts()},this.getFrameProps()),a.createElement("header",{className:"save-publish-panel-header"},a.createElement("button",{className:"close",onClick:this.props.closePanel},a.createElement(f.symbol,{name:"headerCloseButton"})),a.createElement("span",{className:"title"},d.translate("PUBLISH_CONGRATULATIONS_TITLE_TITLE")),a.createElement("span",{className:"subtitle"},d.translate("PUBLISH_CONGRATULATIONS_TITLE_SUBTITLE"))),a.createElement("div",{className:"address-bar-wrapper"},a.createElement("span",{className:"address"},a.createElement(e.domainInput,{value:this.getSiteUrl(),isEditable:false,biHandler:this.domainInputBiReporter})),a.createElement(e.button,{className:"view-site-button",label:"SAVE_PUBLISH_BUTTON_VIEW",onClick:this.viewYourSite})),b!==null?a.createElement("div",{key:"innerPanel",className:"publish-inner-panel"},b):null,a.createElement("div",{className:"publish-success-footer"},this.isDontShowAgainCheckboxVisible()&&b!==null?a.createElement(e.toggle,{key:"dontShowAgain",name:"checkbox",labelAfterSymbol:true,className:"dont-show-again",label:"SAVE_PUBLISH_DO_NOT_SHOW_AGAIN_LABEL",onChange:this.toggleDontShowAgain}):null,a.createElement("div",{className:"footer-buttons"},this.isSecondaryButtonDisplayed()?a.createElement(e.button,{key:"secondaryFooterButton",className:"btn-confirm-secondary",label:this.getSecondaryButtonText(),onClick:this.handleSecondaryButtonClicked}):null,a.createElement(e.button,{className:"btn-confirm-primary",label:this.getPrimaryButtonText(),onClick:this.handlePrimaryButtonClicked}))))}return function(){return h.apply(this,[])}});define("savePublish/panels/publish/publishSuccessPanel",["react","lodash","core","savePublish/panels/publish/publishInnerPanelTypes","savePublish/panels/publish/content/shoutoutPanel","savePublish/panels/publish/content/growBusinessPanel","savePublish/panels/content/connectDomain","savePublish/panels/content/musicPromoContent","savePublish/panels/content/photographyPromoContent","savePublish/panels/publish/publishSuccessPanel.rt","experiment"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";var l="savePublish.panels.connectDomainInProgress";return a.createClass({displayName:"publishSuccessPanel",mixins:[a.addons.LinkedStateMixin,c.mixins.editorAPIMixin],propTypes:{isFakePanel:a.PropTypes.bool,contentPanelType:function(a,c,e){if(!a[c]||!b.some(d,a[c])){return new Error("Invalid prop `"+c+"` supplied to "+e+". Validation failed.")}},configuration:a.PropTypes.object.isRequired,currentDomain:a.PropTypes.string.isRequired,userPreferences:a.PropTypes.object,sitePublicUrl:a.PropTypes.string.isRequired,closePanel:a.PropTypes.func.isRequired},componentDidMount:function(){this.sendPanelMountedBI()},getInitialState:function(){return{dontShowAgain:false}},getShortcuts:function(){var a=this;return{esc:function(){a.refs.frame.close()},enter:this.handlePrimaryButtonClicked}},getFrameProps:function(){return{panelName:this.props.panelName,shouldHideHeader:true}},getInnerContentClass:function(){if(this.props.contentPanelType===d.EMPTY){return null}var a=this.props.contentPanelType.name;switch(a){case d.SHOUTOUT.name:return"grow-business-inner-panel";case d.CONNECT_DOMAIN.name:return"connect-domain-inner-panel";case d.GROW_BUSINESS.name:return"grow-business-inner-panel";case d.MUSIC_PROMO.name:return"music-promo-inner-panel";case d.PHOTOGRAPHY_PROMO.name:return"photo-promo-inner-panel";default:return""}},getFrameClass:function(){var a="publish-success-panel save-publish-panel";var b=this.getInnerContentClass();a+=b?" contains-"+b:"";return a},onDoneAndBI:function(a){this.sendActionButtonClickedBI(a);this.onDone()},onDone:function(){if(this.state.dontShowAgain||this.props.isFakePanel){var a=this.props.contentPanelType.userPref;if(a){var b=this.state.dontShowAgain;this.setDontShowPanelValue(a,b)}}this.props.closePanel()},isDontShowAgainCheckboxVisible:function(){var a=this.props.configuration.isFirstPublish;return!a&&!b.isEqual(this.props.contentPanelType,d.EMPTY)},isSecondaryButtonDisplayed:function(){return k.isOpen("publishUpgradeButtons")&&!this.props.configuration.isDomainConnected&&this.props.contentPanelType.name===d.CONNECT_DOMAIN.name},setDontShowPanelValue:function(a,b){if(a){this.props.userPreferences.session.set(a,b)}},viewYourSite:function(){this.sendViewSiteBI();var a=this.getEditorAPI().site.getSitePublicUrl();if(this.props.configuration.isDomainConnected){a=this.props.configuration.sitePremiumDomain}window.open(a)},getSiteUrl:function(){return this.props.configuration.sitePremiumDomain||this.props.sitePublicUrl},getInnerPanel:function(){if(this.props.contentPanelType===d.EMPTY){return null}var b=this.props.contentPanelType.name;var c=null;var j=null;switch(b){case d.SHOUTOUT.name:c=e;j=this.getShoutoutPanelProps();break;case d.CONNECT_DOMAIN.name:c=g;j=this.getConnectDomainPanelProps(this.props.configuration);break;case d.GROW_BUSINESS.name:c=f;j={metaSiteId:this.getEditorAPI().generalInfo.getMetaSiteId(),userStatus:this.getUserStatus(),isFirstPublish:this.props.configuration.isFirstPublish};break;case d.MUSIC_PROMO.name:c=h;j={closePanel:this.onDone};break;case d.PHOTOGRAPHY_PROMO.name:c=i;j={closePanel:this.onDone};break;default:break}if(c){return a.createElement(c,j)}return null},getShoutoutPanelProps:function(){var a=this.getEditorAPI();return{isUserPremium:this.props.configuration.isPremiumUser,languageCode:a.getLanguageCode(),metaSiteId:a.generalInfo.getMetaSiteId(),sitePublicUrl:this.props.sitePublicUrl,siteNameSEO:a.site.getSEOSiteName(),siteDescriptionSEO:a.site.getSEOSiteDescription(),userStatus:this.getUserStatus(),isFirstPublish:this.props.configuration.isFirstPublish}},getConnectDomainPanelProps:function(a){return{isFirstPublish:a.isFirstPublish,isDomainConnected:a.isDomainConnected,currentDomain:this.props.sitePublicUrl,sitePublishedDomain:a.sitePremiumDomain,isSitePremium:a.isPremiumUser,isFirstSave:a.isFirstSave,closePanel:this.onDone,flowId:c.constants.CONNECT_DOMAIN.FLOWS.PUBLISH,actionCallback:this.sendConnectDomainClickedBI}},getPrimaryButtonText:function(){if(!this.isSecondaryButtonDisplayed()){return"SAVE_PUBLISH_BUTTON_DONE"}else if(this.props.configuration.isPremiumUser){return"Save_Publish_POST_CONNECT_NOW"}return k.isOpen("spanishUpgradeText")?"Save_Publish_POST_UPGRADE_NOW":"Save_Publish_POST_UPGRADE_NOW"},getSecondaryButtonText:function(){return"Save_Publish_POST_CONNECT_LATER"},handlePrimaryButtonClicked:function(){var a=this.props.configuration.isFirstPublish;var b=c.bi.events.publish;var d=a?b.First_Publish_Done_click:b.Second_Publish_Done_click;if(this.isSecondaryButtonDisplayed()){if(this.isConnectDomainInProgress()){this.openConnectDomainInProgressPanel();d=b.publish_flow_connect_domain_now_button_click}else if(this.props.configuration.isPremiumUser){this.getEditorAPI().account.openConnectDomain(c.constants.CONNECT_DOMAIN.FLOWS.PUBLISH_BUTTON,a);d=b.publish_flow_connect_domain_now_button_click}else{var e="edhtml_PUBLISH_FLOW_UPGRADE_BUTTON_"+(a?"FIRST_PUBLISH":"SECOND_PUBLISH");this.getEditorAPI().account.upgrade(e);d=b.publish_flow_upgrade_now_button_click}}this.onDoneAndBI(d)},handleSecondaryButtonClicked:function(){var a=this.props.configuration.isFirstPublish;var b=c.bi.events.publish;var d=a?b.First_Publish_Done_click:b.Second_Publish_Done_click;if(this.isSecondaryButtonDisplayed()){if(this.props.configuration.isPremiumUser){d=b.publish_flow_connect_domain_later_button_click}else{d=b.publish_flow_upgrade_later_button_click}}this.onDoneAndBI(d)},isConnectDomainInProgress:function(){var a=this.props.configuration.sitePremiumDomain;var c=this.props.configuration.isDomainConnected;var d=this.props.configuration.isPremiumUser;var e=!b.isEmpty(a)&&!b.includes(a,"wix.com");return d&&e&&!c},openConnectDomainInProgressPanel:function(){this.getEditorAPI().panelManager.openPanel(l,{connectedDomainURL:this.props.configuration.sitePremiumDomain,currentPublicURL:this.props.sitePublicUrl},true)},sendPanelMountedBI:function(){var a=c.bi.events.publish.publish_success_panel_opened_with_content;var b={is_first_publish:this.props.configuration.isFirstPublish,message:this.props.contentPanelType.name};this.sendBI(a,b)},sendConnectDomainClickedBI:function(){var a=null;var b=null;if(this.props.configuration.isFirstPublish){a=c.bi.events.publish.First_Publish_connect_domain_click}else{a=c.bi.events.publish.Second_Publish_connect_domain_click}if(this.props.configuration.isSitePremium&&!this.props.configuration.isDomainConnected){b={user_status:"Not Connected Premium"}}else if(!this.props.configuration.isSitePremium){b={user_status:"free user"}}if(a.fields.message){b.message=this.props.contentPanelType.name}if(a&&b){this.sendBI(a,b)}},sendActionButtonClickedBI:function(a){var b=this.props.configuration.isFirstPublish;var c={user_status:this.getUserStatus()};if(a.fields.is_first_publish){c.is_first_publish=b}if(a.fields.message){c.message=this.props.contentPanelType.name}this.sendBI(a,c)},sendViewSiteBI:function(){this.sendBI(c.bi.events.publish.publish_view_your_site_click,{is_first_publish:this.props.configuration.isFirstPublish?1:0,panel_name:"savePublish.panels.publish.publishSuccessPanel",user_status:this.getUserStatus()})},getUserStatus:function(){var a=this.props.configuration.isPremiumUser;var b=this.props.configuration.isDomainConnected;var c=null;if(!a){c="free user"}else if(a&&b){c="Connected Premium"}else if(a&&!b){c="Not Connected Premium"}return c},toggleDontShowAgain:function(){var a=!this.state.dontShowAgain;this.sendToggleDontShowAgainBI(a);this.setState({dontShowAgain:a})},sendToggleDontShowAgainBI:function(a){a=a?1:0;if(this.props.configuration.isFirstPublish){this.sendBI(c.bi.events.publish.First_Publish_dont_show_again_click,{toggle:a,user_status:this.getUserStatus()})}else{this.sendBI(c.bi.events.publish.Second_Publish_dont_show_again_click,{toggle:a})}},domainInputBiReporter:function(a){var b={user_status:this.getUserStatus(),panel_name:this.props.panelName,save_or_publish:"publish",is_first_save_or_publish:this.props.configuration.isFirstPublish?1:0};this.sendBI(c.bi.events.domainInput[a],b)},sendBI:function(a,b){this.getEditorAPI().bi.event(a,b)},render:j})});define("savePublish/panels/publish/publishPanels",["savePublish/panels/publish/config/publishConfigurationPanel","savePublish/panels/publish/publishSuccessPanel","savePublish/panels/publish/content/shoutoutPanel"],function(a,b,c){"use strict";return{config:{publishConfigurationPanel:a},publishSuccessPanel:b,shoutOut:c}});define("savePublish",["lodash","savePublish/managers/saveManager","savePublish/managers/mockSaveManager","savePublish/managers/publishManager","savePublish/panels/connectDomain/connectDomainPanel","savePublish/panels/connectDomain/connectDomainInProgress","savePublish/panels/common/commonPanels","savePublish/panels/save/savePanels","savePublish/panels/publish/publishPanels"],function(a,b,c,d,e,f,g,h,i){"use strict";return{save:b.save,saveAsTemplate:b.saveAsTemplate,saveInBackground:b.saveInBackground,autosave:b.autosave,configureSave:c.save,isSaveInProgress:b.isSaveInProgress,isPublishInProgress:d.isPublishInProgress,setTimerForSaveReminder:b.setTimerForSaveReminder,panels:{connectDomain:e,connectDomainInProgress:f,common:g,publish:i,save:h},publish:d.publish,saveAndPublish:d.saveAndPublish,configurePublish:d.configurePublish}});