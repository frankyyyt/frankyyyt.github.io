define("textControls/utils/richTextManager",[],function(){"use strict";var a=[];return{latestCopiedLinks:a}});define("textControls/utils/constants",["lodash"],function(a){"use strict";var b={h1:{seoTag:"h1",label:"FONT_0_LABEL",tag:"h1",displayName:"text_editor_theme_1",cssClass:"font_0"},h2:{seoTag:"h2",label:"FONT_2_LABEL",tag:"h2",displayName:"text_editor_theme_2",cssClass:"font_2"},h3:{seoTag:"h3",label:"FONT_3_LABEL",tag:"h3",displayName:"text_editor_theme_3",cssClass:"font_3"},h4:{seoTag:"h4",label:"FONT_4_LABEL",tag:"h4",displayName:"text_editor_theme_4",cssClass:"font_4"},h5:{seoTag:"h5",label:"FONT_5_LABEL",tag:"h5",displayName:"text_editor_theme_5",cssClass:"font_5"},h6:{seoTag:"h6",label:"FONT_6_LABEL",tag:"h6",displayName:"text_editor_theme_6",cssClass:"font_6"},p:{seoTag:"p",label:"FONT_7_LABEL",tag:"p",displayName:"text_editor_theme_7",cssClass:"font_7"},div:{seoTag:"p",label:"FONT_8_LABEL",tag:"div",displayName:"text_editor_theme_8",cssClass:"font_8"},address:{seoTag:"p",label:"FONT_9_LABEL",tag:"address",displayName:"text_editor_theme_9",cssClass:"font_9"}};return{MAX_TEXT_LENGTH:6e4,CK_OFF:2,CK_ON:1,IMAGE_WHITE_LIST_ATTRIBUTES:["src","style","wix-comp"],FORBIDDEN_TAGS:["script","iframe","embed","object","meta"],SENSITIVE_ATTRIBUTES:["href","src","style"],FORBIDDEN_TAGS_AND_ATTRIBUTES:["script","iframe","embed","object","meta","expression","id","comp","dataquery","propertyquery","styleid","skin","skinpart","y","x","scale","angle","idprefix","state","container","listposition","hasproxy","vcfield","vcview","vctype","pos","onAbort","onActivate","onAfterPrint","onAfterUpdate","onBeforeActivate","onBeforeCopy","onBeforeCut","onBeforeDeactivate","onBeforeEditFocus","onBeforePaste","onBeforePrint","onBeforeUnload","onBeforeUpdate","onBegin","onBlur","onBounce","onCellChange","onChange","onClick","onContextMenu","onControlSelect","onCopy","onCut","onDataAvailable","onDataSetChanged","onDataSetComplete","onDblClick","onDeactivate","onDrag","onDragEnd","onDragLeave","onDragEnter","onDragOver","onDragDrop","onDragStart","onDrop","onEnd","onError","onErrorUpdate","onFilterChange","onFinish","onFocus","onFocusIn","onFocusOut","onHashChange","onHelp","onInput","onKeyDown","onKeyPress","onKeyUp","onLayoutComplete","onLoad","onLoseCapture","onMediaComplete","onMediaError","onMessage","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseWheel","onMove","onMoveEnd","onMoveStart","onOffline","onOnline","onOutOfSync","onPaste","onPause","onPopState","onProgress","onPropertyChange","onReadyStateChange","onRedo","onRepeat","onReset","onResize","onResizeEnd","onResizeStart","onResume","onReverse","onRowsEnter","onRowExit","onRowDelete","onRowInserted","onScroll","onSeek","onSelect","onSelectionChange","onSelectStart","onStart","onStop","onStorage","onSyncRestored","onSubmit","onTimeError","onTrackChange","onUndo","onUnload","onURLFlip","seekSegmentTime"],DEFAULT_STYLES_MAP:b,CLASS_TO_FONT:{font_0:{tag:"h1",class:"font_0"},font_2:{tag:"h2",class:"font_2"},font_3:{tag:"h3",class:"font_3"},font_4:{tag:"h4",class:"font_4"},font_5:{tag:"h5",class:"font_5"},font_6:{tag:"h6",class:"font_6"},font_7:{tag:"p",class:"font_7"},font_8:{tag:"p",class:"font_8"},font_9:{tag:"p",class:"font_9"}},PALETTE_SEQUENCES:["color_11","color_12","color_13","color_14","color_15","color_16","color_17","color_18","color_19","color_20","color_21","color_22","color_23","color_24","color_25","color_26","color_27","color_28","color_29","color_30","color_31","color_32","color_33","color_34","color_35"],TEXT_LIST_TYPES:{textListNone:"nonelist",textListNumbers:"numberedlist",textListBullets:"bulletedlist"},TEXT_BACK_COLOR_TYPES:{textListNone:"noColor"},TEXT_LIST_TYPES_RTL:{textListNone:"nonelist",textListNumbersRight:"numberedlist",textListBulletsRight:"bulletedlist"},ALIGNMENT_TYPES:{textAlignLeft:"justifyleft",textAlignCenter:"justifycenter",textAlignRight:"justifyright",textAlignBlock:"justifyblock"},EFFECTS:{effect_0:{label:"-",value:2},effect_1:{label:"A",value:"rgba(255, 255, 255, 0.6) 1px 1px 1px, rgba(0, 0, 0, 0.6) -1px -1px 1px"},effect_2:{label:"B",value:"rgba(0, 0, 0, 0.298039) 0px 5px 0px"},effect_3:{label:"C",value:"rgba(0, 0, 0, 0.4) 0px 4px 5px"},effect_4:{label:"D",value:"rgba(0, 0, 0, 0.498039) -1px -1px 0px, rgba(0, 0, 0, 0.498039) -1px 1px 0px, rgba(0, 0, 0, 0.498039) 1px 1px 0px, rgba(0, 0, 0, 0.498039) 1px -1px 0px"},effect_5:{label:"E",value:"rgb(255, 255, 255) -1px -1px 0px, rgb(255, 255, 255) -1px 1px 0px, rgb(255, 255, 255) 1px 1px 0px, rgb(255, 255, 255) 1px -1px 0px"},effect_6:{label:"F",value:"rgb(255, 255, 255) 0px 0px 6px"},effect_7:{label:"G",value:"rgb(200, 200, 200) 1px 1px 0px, rgb(180, 180, 180) 0px 2px 0px, rgb(160, 160, 160) 0px 3px 0px, rgba(140, 140, 140, 0.498039) 0px 4px 0px, rgb(120, 120, 120) 0px 0px 0px, rgba(0, 0, 0, 0.498039) 0px 5px 10px"},effect_8:{label:"H",value:"rgb(255, 255, 255) 3px 3px 0px, rgba(0, 0, 0, 0.2) 6px 6px 0px"},effect_9:{label:"I",value:"rgba(10, 189, 240, 0.298039) 3px 3px 0px, rgba(254, 1, 1, 0.298039) -3px -3px 0px"}},FONT_SIZE:{MIN:6,MAX:215},BLOG_CK_EDITOR_FONT_STYLES:{type:"map",metaData:{isPreset:true,isHidden:false,description:"",isPersistent:false},items:{font_0:{seoTag:"h1",label:"FONT_0_LABEL"},font_1:{seoTag:"h2",label:"FONT_1_LABEL"},font_2:{seoTag:"h2",label:"FONT_2_LABEL"},font_3:{seoTag:"h3",label:"FONT_3_LABEL"},font_4:{seoTag:"h4",label:"FONT_4_LABEL"},font_5:{seoTag:"h5",label:"FONT_5_LABEL"},font_6:{seoTag:"h6",label:"FONT_6_LABEL"},font_7:{seoTag:"p",label:"FONT_7_LABEL"},font_8:{seoTag:"p",label:"FONT_8_LABEL"},font_9:{seoTag:"p",label:"FONT_9_LABEL"},font_10:{seoTag:"p",label:"FONT_10_LABEL"}},id:"CK_EDITOR_FONT_STYLES"},BLOG_EDITOR_STYLES:{type:"map",metaData:{isPersistent:false},items:{h1:{tag:"h1",cssClass:"font_3"},h2:{tag:"h2",cssClass:"font_4"},h3:{tag:"h3",cssClass:"font_5"},h4:{tag:"h4",cssClass:"font_6"},h5:{tag:"h5",cssClass:"font_7"},h6:{tag:"h6",cssClass:"font_8"},p:{tag:"p",cssClass:"font_9"},div:{tag:"div",cssClass:"font_8",label:"default",seoTag:"hatul"}},id:"WIXAPPS_EDITOR_STYLES"},DEFAULT_STYLE_CLASS:"font_100",FALLBACK_STYLE_CLASS:"font_8",STYLE_COMMANDS:["bold","fontSize","fontFamily","foreColor","italic"],TEXT_BLOCKS:a.keys(b).concat(["ul","ol"]),LANG_TO_EXAMPLE_KEY:{latin:"","latin-ext":"text_editor_font_example_latin_ext_constant",cyrillic:"text_editor_font_example_cyrillic_constant",japanese:"text_editor_text_editor_font_example_japanese_constant",korean:"text_editor_font_example_korean_constant",arabic:"text_editor_font_example_arabic_constant",hebrew:"text_editor_font_example_hebrew_constant"},FONT_GROUPS:{"my-uploads":"text_editor_font_dropdown_my_fonts",latin:"text_editor_font_dropdown_all_fonts","latin-ext":"add_languages_eastern_european",cyrillic:"add_languages_cyrillic",japanese:"add_languages_japanese",korean:"add_languages_korean",arabic:"add_languages_arabic",hebrew:"add_languages_hebrew"}}});define("textControls/utils/colorUtils",["lodash","textControls/utils/constants","util"],function(a,b,c){"use strict";function d(d,f){d=c.colors.getColorInHex(d);var g=a.findKey(f,function(a){return a===d});if(!e(g,b.PALETTE_SEQUENCES)){return d}return g}function e(b,c){return a.includes(c,b)}function f(b){var c=[];a.forEach(b,function(a,b){var d=b.split("_")[1];c[d]=a});return{color:c}}function g(b,d){var e={};a.forEach(d,function(a,d){var f=b+d;e[f]=c.colors.getColorInHex(a)});return e}function h(a){return a==="noColor"||!a?b.CK_OFF:a}return{getColorValueFromTheme:d,isColorInPaletteSequences:e,getThemeColorData:f,getHexColorsMap:g,getColorPickerValue:h}});define("textControls/utils/fontUtils",["lodash","util","pLoader!santa:fonts","pLoader!santa:utils","pLoader","textControls/utils/colorUtils","experiment"],function(a,b,c,d,e,f,g){"use strict";var h=g.isOpen("se_fontsRefactor");var i=g.isOpen("fontsUpload");var j=d.fonts.uploadedFontsUtils;var k=d.fonts.fontsParser;function l(a,b,c,d){if(a){var e=k.collectFontsFromTextDataArray([a]);var f=n(e,b,c);d.fonts=d.fonts.concat(e);if(f){d.urls.push(f)}}}function m(b,d,e,f){var g=a(b).map(function(a){return c.fontUtils.getFontFamily(a).replace(/\+/g," ").toLowerCase()}).uniq().value();var h=n(g,e,f);d.fonts=d.fonts.concat(g);if(h){d.urls.push(h)}}function n(a,b,d){var e=c.fontUtils.getFontsUrlWithParams(a,b,d);if(e){return e}return""}function o(a,d){var f=e.getRootUrl("santa");var g=c.fontUtils.getWixStoredFontsCssUrlsWithParams(f,a);if(d==="WixSite"){g=g.concat(b.serviceTopology.publicStaticsUrl+"/css/Helvetica/fontFace.css")}return g}function p(a,b,c,d){var e={fonts:[],urls:[]};l(a,b,c,e);m(d,e,b,c);e.urls=e.urls.concat(o(c,b));return e}function q(b,d,e){if(a.isString(b)){return c.fontUtils.parseStyleFont(b,e,d)}return null}function r(b,d,e){var f=[];if(h){f=b.fonts.getFontsOptions()}else{var g=b.generalInfo.getDocumentType();d=d||b.theme.fonts.getCharacterSet();f=c.fontUtils.getCurrentSelectablefontsWithParams(g,d)}if(i&&!e){var j=b.mediaServices.fontsManager.getList();if(!a.isEmpty(j)){var k=a.map(j);k=a.sortBy(k,"displayName");f.unshift({lang:"my-uploads",fonts:k})}}return f}function s(a){return k.collectFontsFromTextDataArray([a])}function t(b,d,e){var g=f.getThemeColorData(b);var h=a.groupBy(d,"cssClass");var i="";a.forEach(e,function(a,b){var d="font: "+c.fontCss.fontToCSSWithColor(a,g.color);var e=u(b,h);i+=e+"{"+d+"}"});return i}function u(b,c){var d="";if(c[b]){a.forEach(c[b],function(a){d+=a.tag+", "})}d+="."+b;return d}function v(a){a=a.toLowerCase();return c.fontMetadata[a]}function w(b){var d=a.clone(c.fontMetadata);if(b!=="WixSite"){d=a.omit(d,function(a){return a.permissions==="studio"})}a.forEach(d,function(a,b){a.cssFontFamily=c.fontUtils.getFontFamilyWithFallbacks(b)});return d}function x(b,d){var e={};a.forEach(c.fontMetadata,function(a,b){if(a.cdnName){e[b]=b}});var f=n(a.keys(e),b,d);return{missingFontsNames:e,missingFontsUrl:f}}function y(a){return this.stringifyFont(a,false)}function z(a){if(a===true){return"700"}else if(a===false){return"normal"}return a}function A(a){if(a===true){return"italic"}else if(a===false){return"normal"}return a}function B(c,d,e){var f=A(c.italic)+" "+c.variant+" "+z(c.bold)+" "+c.size+"/"+c.lineHeight+" "+c.family.replace(/\s/g,"+");if(d&&c.color){var g=b.colors.getColorInHex(c.color);if(e){var h=a.findKey(e,function(a){return a===g});if(h){g="{"+h+"}"}}f+=" "+g}return f}function C(a){return typeof a==="string"?a.toLowerCase().replace(/['"\s]/g,""):a}function D(b,d){var e=b;var f={};var g={};if(i){e=c.fontUtils.getCurrentSelectablefontsWithParams(d,c.fontUtils.POSSIBLE_CHARACTERS_SETS)}a.forEach(e,function(b){a.forEach(b.fonts,function(a){f[C(a.cssFontFamily)]=a;g[a.fontFamily]=a.cssFontFamily})});return{normalizedCssToFont:f,fontFamilyToCss:g}}function E(){return"url("+b.media.getMediaUrl("textEditor/fonts.v3.png")+")"}function F(b){var d=a.filter(c.fontMetadata,{provider:"google"});return c.fontUtils.getGoogleFontsUrl(d,b)}function G(a,b,c){var d=[];var e=this.getGoogleFontsUrl(a);if(e){d.push(e)}var f=this.getFontsToLoad("",b,a,c).urls;if(f){d=d.concat(f)}return d}function H(a){return j.getUploadedFontFaceStyles(a,b.serviceTopology.mediaRootUrl)}function I(b){return a(b).values().map(function(a){return c.fontUtils.getFontFamily(a)}).value()}return{getStyleFont:q,getFontsToLoad:p,parseStyleFont:c.fontUtils.parseStyleFont,stringifyFontWithoutColor:y,stringifyFont:B,createFontsCssString:t,getCurrentSelectableFontsWithParams:r,getFont:v,getWixStoredFontsCss:o,getFontsMetadata:w,getAllCustomFontsUrls:x,getFontsUrlWithParams:n,normalizeFontCss:C,calcFontsMaps:D,getFontsSpriteUrl:E,getGoogleFontsUrl:F,getAllCssLinks:G,getUploadedFontFace:H,isUploadedFont:j.isUploadedFontFamily,getUploadedId:j.getUploadedId,getUsedFontsInTextComp:s,getThemeFontFamilies:I}});define("textControls/utils/dataUtils",["lodash","jquery","textControls/utils/constants"],function(a,b,c){"use strict";var d="";function e(a){return a.replace(/<!--[^>]*>/g,"")}function f(b){var c=[];a.forEach(b.children,function(a){if(h(a)){c.push(a)}else{g(a);m(a);f(a)}})}function g(b){var c=i(b)?k(b):j(b);a.forEach(c,function(a){b.removeAttribute(d+a)},this)}function h(b){return a.some(c.FORBIDDEN_TAGS,function(a){return b.nodeName.toLowerCase()===d+a},this)}function i(a){return a.nodeName.toLowerCase()==="img"}function j(b){var d=c.FORBIDDEN_TAGS_AND_ATTRIBUTES;if(b.nodeName.toLowerCase()==="a"){a.pull(d,"dataquery")}return d}function k(b){var d=a.difference(l(b),c.IMAGE_WHITE_LIST_ATTRIBUTES);return d}function l(b){var c=a.map(b.attributes,function(a){return a.nodeName.toLowerCase()});return c}function m(b){var d;a.forEach(c.SENSITIVE_ATTRIBUTES,function(c){d=b.getAttribute(c);if(d){d=d.toLowerCase();if(c!=="style"&&a.includes(d,"script")||a.includes(d,"expression")){b.removeAttribute(c)}}})}function n(a){return o(a).replace(/[\u200b\s]/g,"").length<1}function o(a){var b=window.document.createElement("div");b.innerHTML=a;return b.textContent}function p(a){var b=[/<script[\s\S]*?<\/script>/gi,/<noscript[\s\S]*?<\/noscript>/gi];for(var c=0;c<b.length;c++){a=a.replace(b[c],"")}return a}function q(b){return b.nodeName&&a.includes(c.TEXT_BLOCKS,b.nodeName.toLowerCase())}function r(d){if(!a.isString(d)){return d}var e=b.parseHTML(d.trim());var f=b("<div>");var g;a.forEach(e,function(a){if(!q(a)){if(a.textContent.trim().length>0){g=g||b("<p>").addClass(c.DEFAULT_STYLES_MAP.div.cssClass);g.append(a)}}else{if(g){f.append(g);g=undefined}f.append(a)}});if(g){f.append(g)}return f.html()}return{removeHtmlComments:e,removeScripts:p,removeRedundantNodesAndAttributes:f,isEmptyHtmlText:n,getTextContentFromHtml:o,wrapOrphans:r}});define("textControls/utils/ckUtils",["textControls/utils/constants","textControls/utils/fontUtils","util","textControls/utils/dataUtils","jquery","lodash","experiment"],function(a,b,c,d,e,f,g){"use strict";var h=g.isOpen("se_fontsRefactor");var i=g.isOpen("fontsUpload");function j(a,b){var c=a.editable().getDocument();f.forEach(b.urls,function(a){c.appendStyleSheet(a)})}function k(a){return f.reduce(a,function(a,b,c){var d="."+c+"{ color:"+b+";}";var e=".back"+c+"{background-color:"+b+";}";return a+d+e},"")}function l(a,c,d,e){var f=b.createFontsCssString(a,c,d);var g=k(a);e.execCommand("wixCss",{id:"theme_fonts",value:f,force:true});e.execCommand("wixCss",{id:"theme_colors",value:g,force:true})}function m(a,b,c){a.execCommand("wixCss",{id:"theme_fonts",value:b,force:true});a.execCommand("wixCss",{id:"theme_colors",value:c,force:true})}function n(a,b){f.forEach(b,function(b,c){a.execCommand("wixCss",{id:"wix-style-link-"+c,value:b,isLink:true})})}function o(a,c,d,e,g,i,k,o,q,r){if(h){var s=f.union(b.getUsedFontsInTextComp(c),b.getThemeFontFamilies(e));n(a,o);m(a,q,r);p(s,a)}else{l(k,d,e,a);j(a,b.getFontsToLoad(c,g,i,e))}}function p(a,c){f(a).filter(function(a){return b.isUploadedFont(a)}).forEach(function(a){c.execCommand("wixCss",{id:a,value:b.getUploadedFontFace([a])})}).value()}function q(b,c){b.on("beforeCommandExec",function(b){var d=b.data.name;if(d!=="fontFamily"){return}var e=b.data.commandData;if(!e||e===a.CK_OFF){return}var f=e.replace(/"/g,"").split(",");c(f)})}var r=0;function s(a,b,d,g,k,l,m){var n;var o={experiments:f.clone(f.get(window,"editorModel.runningExperiments")),removePlugins:d?"autogrow":""};n=CKEDITOR.replace(b,o);n.on("instanceReady",function(b){var n=b.editor;var o=n.document.$.defaultView.frameElement;B();if(c.url.isTrue("isqa")){o.id="CurrentTextEditor_"+r;r++}n.on("change",a.handleDataChange);n.on("selectionChange",a.handleSelectionChange);n.on("selectionCheck",a.handleSelectionChange);n.editable().on("copy",a.handleCutOrCopy);n.editable().on("cut",a.handleCutOrCopy);n.on("resize",function(b){var c=b.data.newHeight;if(f.isNumber(c)&&c!==b.data.oldHeight){a.handleHeightChange(c)}});n.on("externalPasteHandle",a.handlePaste);e(o).bind("mousewheel",function(a){if(d){a.preventDefault();a.stopPropagation()}});e(o).css("display","block");if(!f.isEmpty(g)){S(n,g,k,l)}s();function s(){t(n);if(l.layout){A(n,l.layout.height,l.layout.width)}J(n);G(n);if(a.handleCKCreated){a.handleCKCreated()}}n.on("focus",a.handleFocus);q(n,function(a){if(!h){var b=m(a);j(n,b)}if(i){p(a,n)}})});return n}function t(a){a.resetUndo()}function u(){return f.get(window,"CKEDITOR.WIX.status")==="ready"}function v(a){return a&&a.status==="ready"}function w(a,b){b.execCommand("wixLink",{dataQuery:"#"+a})}function x(a){a.getCommand("wixSelectLinks").exec()}function y(a){a.execCommand("selectAll")}function z(a){a.setReadOnly(true);a.getSelection().removeAllRanges()}function A(a,b,c){a.resize(c||"100%",b,true,false,false)}function B(){if(CKEDITOR.plugins.autogrow&&CKEDITOR.plugins.autogrow.refreshHeightConfig){CKEDITOR.plugins.autogrow.refreshHeightConfig()}}function C(a,b){a.setKeystroke(CKEDITOR.CTRL+66,false);if(b){a.setKeystroke(CKEDITOR.CTRL+66,"unBold")}else{a.setKeystroke(CKEDITOR.CTRL+66,"bold")}}function D(a,b){a.setKeystroke(CKEDITOR.CTRL+73,false);if(b){a.setKeystroke(CKEDITOR.CTRL+73,"unItalic")}else{a.setKeystroke(CKEDITOR.CTRL+73,"italic")}}function E(a){var b=a.getSelection();if(v(a)){b.ignoreFillingCharRemoveOnSelectionChange();a.focus();b.resumeFillingCharRemoveOnSelectionChange()}}function F(a,b){var c=a.editable().getDocument().$;var d=e(c).find("#transparentSelectionCss");if(b){if(d.length===0){e(c).find("head").append('<style id="transparentSelectionCss">body ::selection{background: transparent;} body::-moz-selection{background: transparent;}</style>')}}else if(d){d.remove()}}function G(a){var b=a.editable().getDocument().$;e(b).find("head").append('<style id="overflowCss">body {overflow: hidden !important;}</style>')}function H(a){var b=a.editable().getDocument().$;e(b).find("head").find("#overflowCss").remove()}function I(a){var b=a.editable().getDocument().$;e(b).scrollTop(0)}function J(a){var b=a.editable().getDocument().$;var d=c.serviceTopology.scriptsLocationMap.santa+"/static/css/viewer.css";var f='<link rel="stylesheet" href="'+d+'" type="text/css" charset="utf-8"></link>';e(b).find("head").append(f)}function K(a,b,c){var d=c.undoManager.currentImage;var e=b?"afterUndo":"afterRedo";var f=b?"undo":"redo";var g=c.getCommand(f);if(g){g.on(e,function(){if(d.equalsContent(c.undoManager.currentImage)){a()}})}}function L(c,d,e){var f=c.getCommand("formatBlock").state;if(f===a.CK_OFF){f={tag:"p",class:"font_8"}}return b.getStyleFont(f.class,d,e)}function M(a,b,c){if(window.CKEDITOR&&CKEDITOR.env.ie&&!c){return}var d=a.document.$.body;var e=!b;d.setAttribute("contenteditable",e)}function N(a){var b=a.getSelection();return f.isEmpty(b&&b.getSelectedText())}function O(a,b,c){b.getCommand(a).canUndo=c}function P(a,b,c){b.getCommand(a).editorFocus=c}function Q(a){a.undoManager.undo()}function R(a){return d.removeHtmlComments(a.WIX.getData())}function S(a,b,c,d){if(a.editable()){a.getCommand("wixSetHtml").exec(b);if(d.selectAllOnInit){y(a)}o(a,R(a),c,d.themeFonts,d.documentType,d.languages,d.themeColors,d.fontsUrls,d.themeFontsCss,d.themeColorsCss)}}return{createCKInstance:s,isCKLoaded:u,isEditorReady:v,getData:R,createLink:w,selectAll:y,prepareClosing:z,focus:E,toggleSelectionToTransparent:F,updateThemeStyles:l,loadFontsToCK:j,afterUndoRedoCallback:K,refreshHeightConfig:B,setOverflowCss:G,removeOverflowCss:H,scrollCkToTop:I,toggleBoldShortcutKey:C,toggleItalicShortcutKey:D,getTagFontStyle:L,setCkReadOnly:M,isNoSelection:N,toggleCommandUndoManager:O,toggleCommandFocus:P,execUndoCommand:Q,setData:S,resetUndo:t,expandSelectionToLinks:x,loadLinksToCK:n,loadColorsAndThemeCssToCK:m}});define("textControls/utils/ckBridge",[],function(){"use strict";function a(a,b){return a.getCommand(b)}function b(b,c){var d=a(b,c);if(d){return d.state}return""}function c(b,c){var d=a(b,c);return d&&d.canPerformCmd&&d.canPerformCmd(b)}function d(a,b,c){a.execCommand(b,c)}function e(a,b){a.fire(b)}function f(b,c){var d=a(b,c);if(d){d.refresh(b)}}return{getCmdState:b,execCmd:d,canPerformCmd:c,refresh:f,fire:e}});define("textControls/utils/shadowUtils",["lodash","util"],function(a,b){"use strict";function c(){return new RegExp(/(rgba?\([^\)]*\))/g)}function d(){return new RegExp(/(#[0-9a-f]{3,6})/g)}function e(a){var b=f(a);return b.replace(/\s+/g,"").toLowerCase()}function f(a){var c=d();var e=a.match(c);var f=a;if(e!==null){for(var g=0;g<e.length;g++){var h=b.colors.hexToRgb(e[g]);var i=b.colors.rgbObjectToString(h);f=f.replace(e[g],i)}}return f}function g(b,d){var e=c();var f=b.match(e);var g=d.match(e);return a.isEqual(f,g)||i(f,g)}function h(a,b){for(var c=0;c<3;c++){if(a[c]!==b[c]){return false}}return Math.floor(a[3]*1e3)===Math.floor(b[3]*1e3)}function i(a,b){if(a.length!==b.length){return false}for(var c=0;c<a.length;c++){if(a[c].indexOf("rgba")===0&&b[c].indexOf("rgba")===0){var d=j(a[c]),e=j(b[c]);if(!h(d,e)){return false}}else if(a[c]!==b[c]){return false}}return true}function j(a){return a.replace("rgba(","").replace(")","").split(",")}function k(a,b){var d=a.replace(c(),""),e=b.replace(c(),"");return d===e}function l(a,b){return g(a,b)&&k(a,b)}function m(a,b){var c=e(a),d=e(b);return c===d||l(c,d)}return{cssTextShadowCompare:m}});define("textControls/utils/styleCommandsUtils",["lodash","textControls/utils/constants","textControls/utils/fontUtils","experiment"],function(a,b,c,d){"use strict";function e(c){return a.includes(b.STYLE_COMMANDS,c)}function f(a,e,f,g){if(f){switch(a){case"fontSize":return e===b.CK_OFF?parseInt(f.size,10):parseInt(e,10);case"bold":return f.weight==="normal"&&e===b.CK_OFF?b.CK_OFF:b.CK_ON;case"italic":return f.style==="normal"&&e===b.CK_OFF?b.CK_OFF:b.CK_ON;case"fontFamily":if(e===b.CK_OFF){var h=c.getFont(f.family);if(h){return c.getFont(f.family).fontFamily}if(d.isOpen("fontsUpload")&&c.isUploadedFont(f.family)){return c.normalizeFontCss(f.family)}return""}if(d.isOpen("fontsUpload")&&c.isUploadedFont(e)){return c.normalizeFontCss(e)}var i=c.normalizeFontCss(e);if(g[i]){return g[i].fontFamily}return"";case"foreColor":return e===b.CK_OFF?f.cssColor:e}return e}}return{isStyleCommand:e,calculateStyledValue:f}});define("textControls/mixins/textEditorMixin",["lodash","util","textControls/utils/ckUtils","textControls/utils/ckBridge","textControls/utils/constants","textControls/utils/colorUtils","textControls/utils/shadowUtils","textControls/utils/styleCommandsUtils","textControls/utils/fontUtils","experiment"],function(a,b,c,d,e,f,g,h,i,j){"use strict";var k=b.browserUtil;var l=j.isOpen("fontsUpload");function m(a,b){a.execCommand(b)}function n(a){if(!k.isIE()){c.expandSelectionToLinks(a)}}function o(a){a.openLinkDialog()}function p(a){if(a&&a.type==="EmailLink"&&!a.subject){a.subject=""}}function q(a){return c.isNoSelection(a)?"text_editor_link_disabled":"text_editor_link_disabled_2"}function r(a){a.execCommand("wixUnlink")}return{isCkReady:function(){return this.richTextInput&&c.isEditorReady(this.richTextInput.editor)},execCommand:function(a,b){if(!this.isCkReady()){return}this.richTextInput.lockChangeHandler();d.execCmd(this.richTextInput.editor,a,b);this.richTextInput.unlockChangeHandler();d.fire(this.richTextInput.editor,"selectionCheck")},getLinkValue:function(){if(this.isCkReady()){d.refresh(this.richTextInput.editor,"wixLink");return d.getCmdState(this.richTextInput.editor,"wixLink")}return null},getValue:function(a){if(this.isCkReady()){var b=d.getCmdState(this.richTextInput.editor,a);if(h.isStyleCommand(a)){var e=c.getTagFontStyle(this.richTextInput.editor,this.richTextInput.props.themeColors,this.richTextInput.props.themeFonts);if(e){return h.calculateStyledValue(a,b,e,this.richTextInput.fontsMaps.normalizedCssToFont)}}return b}return""},getBooleanValue:function(a){if(this.isCkReady()){return this.getValue(a)===e.CK_ON}return false},getCommandState:function(a){if(this.isCkReady()){return d.getCmdState(this.richTextInput.editor,a)}return""},getListType:function(){if(this.isCkReady()){if(this.getBooleanValue(e.TEXT_LIST_TYPES.textListNumbers)){return e.TEXT_LIST_TYPES.textListNumbers}else if(this.getBooleanValue(e.TEXT_LIST_TYPES.textListBullets)){return e.TEXT_LIST_TYPES.textListBullets}}return e.TEXT_LIST_TYPES.textListNone},getTextAlignment:function(){if(this.isCkReady()){var b=this;return a.find(e.ALIGNMENT_TYPES,function(a){return b.getBooleanValue(a)})}return""},selectionChange:function(){this.forceUpdate()},componentDidMount:function(){this.richTextInput.registerOnSelectionChange(this.selectionChange)},componentWillUnmount:function(){this.richTextInput.unregisterOnSelectionChange(this.selectionChange)},changeFontFamily:function(a){if(l&&i.isUploadedFont(a)){this.execCommand("fontFamily",a);this.focus();return}this.execCommand("fontFamily",this.richTextInput.fontsMaps.fontFamilyToCss[a]);this.focus()},execListCommand:function(a){var b=this.getListType();if(a!==b){if(a===e.TEXT_LIST_TYPES.textListNone){this.execCommand(b)}else{this.execCommand(a)}}this.focus()},execLineHeightCommand:function(a){if(a==="auto"){this.execCommand("lineHeight",e.CK_OFF)}else{this.execCommand("lineHeight",a+"em")}},changeAlignment:function(a){if(a!==this.getTextAlignment()){this.execCommand(a)}this.focus()},changeTextShadow:function(a){var b=this.getValue("textShadow");var c=b!==a?a:e.CK_OFF;this.execCommand("textShadow",c)},getTextShadowValue:function(){if(this.isCkReady()){var b=this.getValue("textShadow");if(b!==e.CK_OFF){var c=a.findKey(e.EFFECTS,function(a){if(a.value!==e.CK_OFF){return g.cssTextShadowCompare(a.value,b)}});if(c){return c}}}return"EFFECT_0"},getLetterSpacingValue:function(){if(this.isCkReady()){var a=this.getValue("letterSpacing");if(a===e.CK_OFF){return 0}return parseFloat(a)}return""},getLineHeightValue:function(){if(this.isCkReady()){var a=this.getValue("lineHeight");if(a===e.CK_OFF){return"auto"}return parseFloat(a)}return""},getBackColorValue:function(){if(this.isCkReady()){var b=this.getValue("backColor");if(b===e.CK_OFF){return null}if(a.startsWith(b,"back")){return this.richTextInput.props.themeColors[b.replace("back","")]}return b}},getForeColorValue:function(){var b=this.getValue("foreColor");if(a.startsWith(b,"color")){return this.richTextInput.props.themeColors[b]}return b},prepareColorPickerParams:function(a,d){var e=a?"foreColor":"backColor";var g=a?this.getValue(e):this.getBackColorValue();var h=b.colors.getColorInHex(g);var i=f.getColorValueFromTheme(g,this.richTextInput.props.themeColors);var j=!c.isNoSelection(this.richTextInput.editor);g=i?i:b.colors.getColorInHex(g);if(!d&&this.richTextInput.refs.toolbar){d=this.richTextInput.refs.toolbar.getColorPickerPosition(a)}return{colorCommand:e,colorValue:g,originalColor:h,isOriginalColorFromTheme:a&&this.isColorFromTheme(),themeColorValue:i,previewOnHover:j,position:d}},execColorPickerChangeCommand:function(b,d,f,g,h){if(!this.isColorPickerClosed()){c.toggleCommandUndoManager(d,this.richTextInput.editor,!g);c.setCkReadOnly(this.richTextInput.editor,false);if(a.startsWith(b,"color")&&a.startsWith(d,"back")){b="back"+b}if(h&&b===f){this.execCommand(d,e.CK_OFF)}else{this.execCommand(d,b)}c.setCkReadOnly(this.richTextInput.editor,true)}},openColorPicker:function(a,b){var d=this;var e=this.prepareColorPickerParams(a,b);c.setCkReadOnly(d.richTextInput.editor,true);this.richTextInput.props.openColorPicker(e.colorValue,function(a,b){var c=f.getColorPickerValue(a);d.execColorPickerChangeCommand(c,e.colorCommand,e.originalColor,b,e.isOriginalColorFromTheme)},e.position,e.previewOnHover);if(this.richTextInput.props.panelManager){this.richTextInput.props.panelManager.registerObserver(this.colorPickerObserver)}this.richTextInput.isColorPickerOpen=true;this.richTextInput.forceIsCustomStyleValue=this.isCustomStyle()},isColorFromTheme:function(){return this.getCommandState("foreColor")===e.CK_OFF},handleColorClick:function(a,b){this.openColorPicker(a,b)},isPanelClosed:function(b){return a.findIndex(this.richTextInput.props.panelManager.getOpenPanels(),{name:b})===-1},isColorPickerClosed:function(){var a=this.richTextInput.props.colorPickerPanelName||"panels.toolPanels.colorPicker.colorPickerPanel";return this.isPanelClosed(a)},colorPickerObserver:function(){var a=this.isColorPickerClosed();c.toggleSelectionToTransparent(this.richTextInput.editor,!a);if(a){this.focus();c.setCkReadOnly(this.richTextInput.editor,false);this.richTextInput.props.panelManager.unregisterObserver(this.colorPickerObserver);this.richTextInput.isColorPickerOpen=false;this.richTextInput.forceIsCustomStyleValue=undefined}},getFormatBlockValue:function(){if(this.isCkReady()){var a=this.getValue("formatBlock");return a.class}return""},execFormatBlockCommand:function(a){var b=e.CLASS_TO_FONT[a];this.execCommand("formatBlock",b);this.focus()},execNoBackColor:function(){return this.execCommand("backColor",e.CK_OFF)},focus:function(){if(this.richTextInput){var a=this.richTextInput.editor;setTimeout(function(){c.focus(a)},0)}},isCustomStyle:function(){if(this.richTextInput.forceIsCustomStyleValue!==undefined){return this.richTextInput.forceIsCustomStyleValue}var b=false;var c=this;a.forEach(e.STYLE_COMMANDS,function(a){if(c.getCommandState(a)!==e.CK_OFF){b=true}});if(this.getCommandState("unBold")!==e.CK_OFF||this.getCommandState("unItalic")!==e.CK_OFF){b=true}return b},canPerformSaveTheme:function(){return this.isCustomStyle()&&!this.richTextInput.editor.WIX.isMultipleBlockSelection()},getBoldProps:function(){var b={name:"textBold",instanceId:"textBold",tooltipValue:this.getTooltipValue("bold","B")};var d=c.getTagFontStyle(this.richTextInput.editor,this.richTextInput.props.themeColors,this.richTextInput.props.themeFonts);if(!d||d.weight==="normal"){b.value=this.getBooleanValue("bold");b.onChange=a.partial(m,this,"bold");c.toggleBoldShortcutKey(this.richTextInput.editor,false)}else{b.value=!this.getBooleanValue("unBold");b.onChange=a.partial(m,this,"unBold");c.toggleBoldShortcutKey(this.richTextInput.editor,true)}return b},getItalicProps:function(){var b={name:"textItalic",instanceId:"textItalic",tooltipValue:this.getTooltipValue("italic","I")};var d=c.getTagFontStyle(this.richTextInput.editor,this.richTextInput.props.themeColors,this.richTextInput.props.themeFonts);if(!d||d.style==="normal"){b.value=this.getBooleanValue("italic");b.onChange=a.partial(m,this,"italic");c.toggleItalicShortcutKey(this.richTextInput.editor,false)}else{b.value=!this.getBooleanValue("unItalic");b.onChange=a.partial(m,this,"unItalic");c.toggleItalicShortcutKey(this.richTextInput.editor,true)}return b},getUnderlineProps:function(){return{name:"textUnderline",instanceId:"textUnderline",tooltipValue:this.getTooltipValue("underline","U"),value:this.getBooleanValue("underline"),onChange:a.partial(m,this,"underline")}},getLinkProps:function(){return{name:"textLink",instanceId:"textLink",tooltipValue:this.shouldEnableLinkButton()?this.getTooltipValue("link"):q(this.richTextInput.editor),value:this.hasLink(),onChange:a.partial(o,this),disabled:!this.shouldEnableLinkButton(),onUnlink:a.partial(r,this),onExpand:a.partial(n,this.richTextInput.editor)}},shouldEnableLinkButton:function(){return this.isCkReady()&&d.canPerformCmd(this.richTextInput.editor,"wixLink")},getBulletsItems:function(){var a=this.getBooleanValue("bidiltr")?e.TEXT_LIST_TYPES:e.TEXT_LIST_TYPES_RTL;return a},getBulletsIconName:function(){var a=this.getBooleanValue("bidiltr")?"textListBullets":"textListBulletsRight";return a},hasLink:function(){return this.getLinkValue()!==null},getCurrentLinkData:function(){var b=this.getLinkValue();if(b!==null&&b!==e.CK_OFF){if(b.charAt(0)==="#"){b=b.substring(1)}return a.find(this.richTextInput._links,{id:b})}},isLinkDialogClosed:function(){var a=this.richTextInput.props.linkDialogPanelName||"panels.toolPanels.linkPanel";return this.isPanelClosed(a)},linkDialogObserver:function(){if(this.isLinkDialogClosed()){this.focus();this.richTextInput.props.panelManager.unregisterObserver(this.linkDialogObserver);this.richTextInput.isLinkDialogOpen=false}},openLinkDialog:function(){var d=this;var e=this.getCurrentLinkData();var f=e&&e.id;if(k.isIE()){c.expandSelectionToLinks(this.richTextInput.editor)}function g(){
d.execCommand("wixUnlink")}function h(a){a.id=b.guidUtils.getUniqueId("textLink","_");d.richTextInput._links.push(a);c.createLink(a.id,d.richTextInput.editor)}this.richTextInput.props.openLinkDialog(e,a.once(function(a){var b=false;p(a);if(f){b=true;if(a){h(a)}else{g()}}else if(a){b=true;h(a)}if(b){d.richTextInput.callOnChangeIfExists({text:c.getData(d.richTextInput.editor),linkList:d.richTextInput._links})}}));if(this.richTextInput.props.panelManager){this.richTextInput.props.panelManager.registerObserver(this.linkDialogObserver)}this.richTextInput.isLinkDialogOpen=true},linkFontSize:function(){return{value:this.getValue("fontSize"),requestChange:function(a,b){this.richTextInput.forceIsCustomStyleValue=this.isCustomStyle();if(b){this.execCommandWithoutFocus("fontSize",a+"px")}else{this.execCommand("fontSize",a+"px")}}.bind(this)}},handleFontSizeEnd:function(){this.richTextInput.forceIsCustomStyleValue=undefined;this.props.textSettingsPanel.forceUpdate();this.focus()},linkSpacing:function(){return{value:this.getLetterSpacingValue(),requestChange:function(a,b){if(b){this.execCommandWithoutFocus("letterSpacing",a+"em")}else{this.execCommand("letterSpacing",a+"em")}}.bind(this)}},execCommandWithoutFocus:function(a,b){c.toggleCommandFocus(a,this.richTextInput.editor,false);this.execCommand(a,b);c.toggleCommandFocus(a,this.richTextInput.editor,true)},registerSaveThemeUndoRedoHandler:function(a,b){c.afterUndoRedoCallback(a,b,this.richTextInput.editor)}}});define("textControls/mixins/textTooltipMixin",["react","baseUI","core"],function(a,b,c){"use strict";return{getTooltipValue:function(a,b){if(a==="bold"||a==="italic"||a==="underline"){return this.getTooltipWithShortcut(a,b)}return"text_editor_buttons_tooltip_"+a},getTooltipWithShortcut:function(d,e){return a.createElement(b.popoverTemplates.keyboardShortcutTooltip,{label:"text_editor_buttons_tooltip_"+d,shortcut:c.constants.KEYBOARD_SPECIAL_KEY.label+" + "+e})}}});define("textControls/comps/iconButton.rt",["react","lodash","symbols","baseUI"],function(a,b,c,d){"use strict";return function(){return a.createElement(d.tooltip,{value:this.props.tooltipValue,disabled:!this.props.tooltipValue,styleType:d.uiConstants.TOOLTIP.STYLE_TYPE.SMALL},a.createElement("div",{className:"icon-button-container"},a.createElement("button",{className:this.getClassName(),onClick:this.handleClick,style:this.props.style,disabled:this.props.disabled},this.props.name?a.createElement("span",{key:"key"+this.props.name},a.createElement(c.symbol,{name:this.props.name})):null,a.createElement("span",{},this.props.children),this.props.popupMode?a.createElement(d.arrowButton,{key:"iconButtonArrow",withoutBorder:true}):null)))}});define("textControls/comps/iconButton",["react","lodash","textControls/comps/iconButton.rt","baseUI"],function(a,b,c,d){"use strict";function e(a){var b={};switch(a){case"textOutdentLeft":case"textOutdentRight":b.category="decrease";break;case"textIndentLeft":case"textIndentRight":b.category="increase";break;case"textWriteDirectionLeft":b.category="RTL";break;case"textWriteDirectionRight":b.category="LTR";break}return b}return a.createClass({displayName:"iconButton",render:c,mixins:[d.reportUIChangeMixin],propTypes:{isSelected:a.PropTypes.bool,buttonMode:a.PropTypes.bool,popupMode:a.PropTypes.bool},contextTypes:{reportUIChange:a.PropTypes.func},getDefaultProps:function(){return{isSelected:false,buttonMode:true,popupMode:false}},getClassName:function(){var a="";if(this.props.className){a+=" "+this.props.className}if(this.props.isSelected){a+=" selected"}if(this.props.buttonMode&&!this.props.popupMode){a+=" icon-button"}if(this.props.popupMode){a+=" icon-button popup"}return a.trim()},handleClick:function(){var a=e(this.props.name);this.reportUIChange(a,this.props.name||this.props.biName);this.props.onClick()}})});define("textControls/comps/colorDrop.rt",["react","lodash"],function(a,b){"use strict";return function(){return a.createElement("span",{},!this.props.isBackColor&&!this.props.colorDropOnly?a.createElement("span",{key:"backColorDrop"},a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"symbol-textForeColor","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"22px",height:"18px"},a.createElement("path",{fill:this.props.fill?this.props.fill:"none","fill-rule":"evenodd",d:"M 17 3C 17 3 27.03 17 17 17 6.9 17 17 3 17 3Z"}),a.createElement("path",{"fill-rule":"evenodd",d:"M 16.96 18C 13.35 18 12 14.95 12 13.03 12 9.97 15.69 4.09 16.12 3.43 16.12 3.43 16.95 2.12 16.95 2.12 16.95 2.12 17.8 3.42 17.8 3.42 18.23 4.08 22 9.97 22 13.03 22 15.09 20.44 18 16.96 18ZM 16.96 3.97C 16.96 3.97 13 10.18 13 13.03 13 14.52 14.02 16.99 16.96 16.99 19.89 16.99 21 14.52 21 13.03 21 10.18 16.96 3.97 16.96 3.97ZM 3.6 9.02C 3.6 9.02 2 13.03 2 13.03 2 13.03-0 13.03-0 13.03-0 13.03 5 1 5 1 5 1 6 0 6 0 6 0 7 0 7 0 7 0 8 1 8 1 8 1 11 7.01 11 7.01 11 7.01 11 11.02 11 11.02 11 11.02 9.4 9.02 9.4 9.02 9.4 9.02 3.6 9.02 3.6 9.02ZM 7 3.01C 7 3.01 6 3.01 6 3.01 6 3.01 4.4 7.01 4.4 7.01 4.4 7.01 8.6 7.01 8.6 7.01 8.6 7.01 7 3.01 7 3.01Z"}))):null,this.props.isBackColor&&!this.props.colorDropOnly?a.createElement("span",{key:"foreColorDrop"},a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"symbol-textBackColor","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"28px",height:"21px"},a.createElement("path",{fill:this.props.fill?this.props.fill:"none","fill-rule":"evenodd",d:"M 23 6C 23 6 33.03 20 23 20 12.9 20 23 6 23 6Z"}),a.createElement("path",{"fill-rule":"evenodd",d:"M 22.96 21C 19.35 21 18 17.95 18 16.03 18 12.98 21.69 7.09 22.12 6.43 22.12 6.43 22.95 5.12 22.95 5.12 22.95 5.12 23.8 6.42 23.8 6.42 24.23 7.09 28 12.97 28 16.03 28 18.09 26.44 21 22.96 21ZM 22.96 6.97C 22.96 6.97 19 13.18 19 16.03 19 17.52 20.02 20 22.96 20 25.89 20 27 17.52 27 16.03 27 13.18 22.96 6.97 22.96 6.97ZM 14 6.01C 14 6.01 15 10.02 15 10.02 15 10.02 12 10.02 12 10.02 12 10.02 13 6.01 13 6.01 13 6.01 14 6.01 14 6.01ZM 18 10.02C 18 10.02 15 4.01 15 4.01 15 4.01 14 3.01 14 3.01 14 3.01 13 3.01 13 3.01 13 3.01 12 4.01 12 4.01 12 4.01 6.63 16.03 6.63 16.03 6.63 16.03 9 16.03 9 16.03 9 16.03 11 12.02 11 12.02 11 12.02 16 12.02 16 12.02 16 12.02 16.79 13 16.79 13 16.32 14.18 16 15.26 16 16.03 16 16.93 16.3 18.07 16.98 19.04 16.98 19.04 6 19.04 6 19.04 4.9 19.04 4 18.14 4 17.03 4 17.03 4 15.03 4 15.03 4 15.03 3 15.03 3 15.03 2.45 15.03 2 14.58 2 14.03 2 13.47 2.45 13.02 3 13.02 3 13.02 4 13.02 4 13.02 4 13.02 4 11.02 4 11.02 4 11.02 3 11.02 3 11.02 2.45 11.02 2 10.57 2 10.02 2 9.47 2.45 9.02 3 9.02 3 9.02 4 9.02 4 9.02 4 9.02 4 7.01 4 7.01 4 7.01 2 7.01 2 7.01 1.45 7.01 1 6.57 1 6.01 1 5.46 1.45 5.01 2 5.01 2 5.01 4 5.01 4 5.01 4 5.01 4 2 4 2 4 2 1 2 1 2 0.45 2 0 1.56 0 1 0 0.45 0.45 0 1 0 1 0 4 0 4 0 4 0 20 0 20 0 21.1 0 22 0.9 22 2 22 2 22 4.01 22 4.01 22 4.01 21 5.01 21 5.01 21 5.01 19.43 7.1 18 10.02Z"}))):null,this.props.colorDropOnly?a.createElement("span",{key:"colorDrop"},a.createElement("svg",{width:"13px",height:"20px",viewBox:"0 0 13 20",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},a.createElement("g",{fill:this.props.fill?this.props.fill:"none","fill-rule":"evenodd"},a.createElement("g",{stroke:"#FFFFFF"},a.createElement("path",{d:"M6.444,1.22000003 L5.521,2.66700003 C5.055,3.39800003 0.968,9.90800003 0.968,13.287 C0.968,15.411 2.457,18.783 6.454,18.783 C10.302,18.783 12.032,15.569 12.032,13.287 C12.032,9.90200003 7.857,3.39000003 7.381,2.65900003 L6.444,1.22000003 L6.444,1.22000003 Z"}))))):null)}});define("textControls/comps/colorDrop",["react","lodash","textControls/comps/colorDrop.rt"],function(a,b,c){"use strict";return a.createClass({propTypes:{fill:a.PropTypes.string},displayName:"colorDrop",render:c})});define("textControls/comps/textColor.rt",["react","lodash","textControls/comps/colorDrop","textControls/comps/iconButton"],function(a,b,c,d){"use strict";return function(){return a.createElement("span",{},a.createElement(d,{onClick:this.props.onClick,tooltipValue:this.props.tooltipValue,biName:this.getBiName()},a.createElement(c,{isBackColor:this.props.isBackColor,fill:this.props.value})))}});define("textControls/comps/textColor",["react","lodash","textControls/comps/textColor.rt","textControls/utils/ckUtils"],function(a,b,c){"use strict";return a.createClass({displayName:"textColor",propTypes:{tooltipValue:a.PropTypes.string,value:a.PropTypes.string,isBackColor:a.PropTypes.bool,onClick:a.PropTypes.func.isRequired},getDefaultProps:function(){return{isBackColor:false}},getBiName:function(){var a=this.props.isBackColor?"textHighlight":"textColor";return a},render:c})});define("textControls/comps/fontFamily.rt",["react","lodash","baseUI","symbols","experiment"],function(a,b,c,d,e){"use strict";function f(a,b,c){this.handleOptionsVisible(c)}function g(b,d,e,f,g,h){return a.createElement(c.dropDown.option,{shouldTranslate:false,value:g.value,key:g.value,searchText:g.label},a.createElement("div",{className:"font-option-container"},a.createElement("span",{className:"font-label"},g.label),a.createElement("span",{className:"font-example"},this.translateIfNeeded(g.example)),b&&g.isNew?a.createElement("span",{key:"font-badge",className:"font-badge"},this.translateIfNeeded("text_editor_fonts_dropdown_new_badge")):null))}function h(d,e,f,h){return a.createElement.apply(this,[c.dropDown.optgroup,{label:f.groupName,key:f.groupName},b.map(f.items,g.bind(this,d,e,f,h)),this.isMissingFont()?a.createElement(c.dropDown.option,{key:"textStyleCustom",value:this.props.value,style:{display:"none"},className:"missing-uploaded-font"},a.createElement("div",{className:"font-option-container"},a.createElement("span",{className:"font-label"},this.getMissingFontName()))):null])}function i(b,c,e,f){return a.createElement("div",{key:f,className:"font-family-footer-link "+e.className,onClick:e.onClick},e.symbol?a.createElement(d.symbol,{name:e.symbol,key:"footerLinkIcon-"+f}):null,a.createElement("span",{},this.translateIfNeeded(e.label)))}function j(a,b,c){this.handleOptionsVisible(c)}function k(b,d,e,f){return a.createElement(c.dropDown.option,{shouldTranslate:false,value:e.value,className:"font-option "+(this.props.optionsClass?this.props.optionsClass:""),key:this.props.value,searchText:e.label},a.createElement("div",{className:"font-option-container"},a.createElement("span",{className:"font-label"},e.label),a.createElement("span",{className:"font-example"},this.translateIfNeeded(e.example)),b&&e.isNew?a.createElement("span",{key:"font-badge",className:"font-badge"},this.translateIfNeeded("text_editor_fonts_dropdown_new_badge")):null))}function l(b,c,d,e){return a.createElement("span",{key:e,className:"font-family-footer-label",onClick:d.onClick},this.translateIfNeeded(d.label))}function m(){var d=e.isOpen("newFontsBadge");var g=e.isOpen("fontsUpload");return a.createElement("div",{style:{display:"inline"}},g?a.createElement.apply(this,[c.dropDown.combobox,{key:"font-family-with-fonts-upload-changes",label:this.props.label,ref:"combobox",optionsWidth:this.getOptionsWidth(),valueLink:this.props.valueLink,value:this.props.value,className:"font-family-dd "+(this.props.toolbarMode?"toolbar-mode":""),onChange:this.props.onChange,infoText:this.props.infoText,onOptionsVisible:f.bind(this,d,g),infoTitle:this.props.infoTitle},b.map(this.state.fontsItems,h.bind(this,d,g)),this.props.footerLinks?a.createElement(c.dropDown.footer,{key:"font_family_footer",className:"footer-content"},a.createElement.apply(this,["div",{className:"footer-links-container fonts-upload"},b.map(this.props.footerLinks,i.bind(this,d,g))])):null]):null,!g?a.createElement.apply(this,[c.dropDown.combobox,{key:"font-family-without-fonts-upload-changes",label:this.props.label,ref:"combobox",optionsWidth:this.props.optionsWidth,valueLink:this.props.valueLink,value:this.props.value,className:"font-family-dd "+(this.props.toolbarMode?"toolbar-mode":""),onChange:this.props.onChange,infoText:this.props.infoText,onOptionsVisible:j.bind(this,d,g),infoTitle:this.props.infoTitle},b.map(this.getFontOptionsWithoutGroups(),k.bind(this,d,g)),this.props.footerLinks?a.createElement(c.dropDown.footer,{key:"font_family_footer"},a.createElement.apply(this,["div",{className:"footer-links-container"},b.map(this.props.footerLinks,l.bind(this,d,g))])):null]):null)}return function(){return a.createElement(c.tooltip,{value:this.props.tooltipValue,disabled:!this.props.tooltipValue,styleType:this.props.tooltipStyleType},m.apply(this,[]))}});define("textControls/comps/fontFamily",["react","lodash","jquery","textControls/comps/fontFamily.rt","util","textControls/utils/constants","textControls/utils/fontUtils","experiment"],function(a,b,c,d,e,f,g,h){"use strict";var i=h.isOpen("fontsUpload");var j=i?36:24;var k=["Adobe Caslon","Avenir","Avenir Light","Belinda","Brandon Grotesque","Bree","Cinzel","DIN Neuzeit Grotesk","Futura","Futura Light","Kepler","Libre Baskerville","Linotype Didot","Lulo Clean","Monotype Baskerville","Peaches & Cream","Playfair Display","Proxima Nova","Sail","Trend"];function l(a){return c(a).find("li:not(.missing-uploaded-font)")}function m(a){if(b.includes(k,a.label)){b.assign(a,{isNew:true})}}function n(a){var b=a.scrollTop;return Math.round(b/j)}function o(a,b,c){var d=a.clientHeight;var e=Math.round(d/j);return Math.min(b+e,c.length)}return a.createClass({displayName:"fontFamily",render:d,mixins:[e.translationMixin],propTypes:{infoText:a.PropTypes.string,label:a.PropTypes.string,onClose:a.PropTypes.func,doNotFocus:a.PropTypes.bool,footerLinks:a.PropTypes.arrayOf(a.PropTypes.shape({label:a.PropTypes.string.isRequired,onClick:a.PropTypes.func.isRequired})),fonts:a.PropTypes.arrayOf(a.PropTypes.shape({fonts:a.PropTypes.array.isRequired,lang:a.PropTypes.string.isRequired}).isRequired)},getUploadedFontName:function(a){var c=a.split(",")[2];c=c.replace(e.fontsManagerUtils.constants.ORIGINAL_FONT_PREFIX,"");c=b.startCase(c);return c},getMissingFontName:function(){if(this.isMissingFont()){var a=g.getFontsMetadata();if(g.isUploadedFont(this.props.value)){return this.getUploadedFontName(this.props.value)}if(a&&a[this.props.value]){return a[this.props.value].displayName}return""}},getInitialState:function(){return{fontsItems:this.getFontsItems(this.props.fonts)}},getDefaultProps:function(){return{optionsWidth:284}},componentWillReceiveProps:function(a){if(!b.isEqual(this.props.fonts,a.fonts)){this.setState({fontsItems:this.getFontsItems(a.fonts)})}},getFontsItems:function(a){var c=[];var d=a;b.forEach(d,function(a){var d={groupName:f.FONT_GROUPS[a.lang],items:[]};b.forEach(a.fonts,function(b){if(b.permissions!=="legacy"){var c={label:b.displayName,value:b.fontFamily,example:f.LANG_TO_EXAMPLE_KEY[a.lang],cssFontFamily:b.cssFontFamily};if(h.isOpen("newFontsBadge")){m(c)}d.items.push(c)}});c.push(d)});return c},getFontOptionsWithoutGroups:function(){return b(this.state.fontsItems).pluck("items").flattenDeep().value()},getFlattenItemsWithGropus:function(){var a=[];b.forEach(this.state.fontsItems,function(c){a.push(c.groupName);b.forEach(c.items,function(b){a.push(b)})});return a},handleOptionsVisible:function(a){if(a){this.addFontFamilyAttrToList(a)}},addFontFamilyAttrToList:function(a){var c=l(a);var d;if(i){d=this.getFlattenItemsWithGropus()}else{d=this.getFontOptionsWithoutGroups()}var e=n(a);var f=o(a,e,c);for(var g=e;g<f;g++){var h=d[g];var j=c[g].firstChild;if(j&&b.includes(j.classList,"font-option-container")){j.style.fontFamily=h&&h.cssFontFamily}}},isExpanded:function(){return this.refs.combobox.isExpanded()},getOptionsWidth:function(){return i&&this.props.footerLinks?336:this.props.optionsWidth},isMissingFont:function(){var a=this.getFontOptionsWithoutGroups();return!b.find(a,{value:this.props.value})}})});define("textControls/comps/textStyle.rt",["react","lodash","baseUI"],function(a,b,c){"use strict";function d(b,d){return a.createElement(c.dropDown.option,{value:b.cssClass,key:b.displayName+b.family,className:"style-option "+(this.props.optionsClass?this.props.optionsClass:"")},a.createElement("div",{className:"style-option-header"},a.createElement("div",{className:"style-color-container"},a.createElement("span",{className:"style-color",style:{backgroundColor:b.cssColor}})),a.createElement("span",{className:"style-name",style:this.getDisplayStyle(b)},this.translateIfNeeded(b.displayName))),a.createElement("div",{className:"style-option-footer"},a.createElement("span",{className:"style-size"},b.size),a.createElement("span",{className:"style-tag"},"<",b.seoTag,">")),a.createElement("div",{className:"style-option-label"},a.createElement("span",{className:"display-name"},this.translateIfNeeded(b.displayName)),a.createElement("span",{className:"custom-style-indicator"},"*")))}return function(){return a.createElement(c.tooltip,{value:this.props.tooltipValue,disabled:!this.props.tooltipValue,styleType:this.props.tooltipStyleType},a.createElement("div",{style:{display:"inline"}},a.createElement.apply(this,[c.dropDown.select,{label:this.props.label,value:this.props.value,onChange:this.props.onChange,ref:"dropdown",infoText:this.props.infoText,infoTitle:this.props.infoTitle,optionsWidth:this.props.optionsWidth,className:"text-style-dd "+(this.props.toolbarMode?"toolbar-mode":"")+" "+(this.props.className?this.props.className:""),setSelectedAnyway:true,doNotFocus:this.props.doNotFocus},b.map(this.getStyleOptions(),d.bind(this)),this.isCustom()?a.createElement(c.dropDown.option,{key:"textStyleCustom",value:this.props.value,className:"style-option",style:{display:"none"}},"\n                ",this.state.nullLabel,"\n            "):null])))}});define("textControls/comps/textStyle",["react","lodash","textControls/comps/textStyle.rt","textControls/utils/constants","textControls/utils/fontUtils","util"],function(a,b,c,d,e,f){"use strict";return a.createClass({displayName:"textStyle",mixins:[f.translationMixin],propTypes:{nullLabel:a.PropTypes.string},getNullLabelFromProps:function(){return this.props.nullLabel||this.translateIfNeeded("list_design_panel_Customize_TextField_CustomTheme_DropdownItem_Label")},getInitialState:function(){return{nullLabel:this.getNullLabelFromProps()}},getDefaultProps:function(){return{stylesMap:d.DEFAULT_STYLES_MAP,toolbarMode:false,optionsWidth:264}},getStyleOptions:function(){return b.map(this.props.stylesMap,function(a){var c=e.getStyleFont(a.cssClass,this.props.themeColors,this.props.themeFonts);return b.assign(c,b.pick(a,["seoTag","cssClass","displayName"]))},this)},getDisplayStyle:function(a){var b={fontWeight:a.weight,fontFamily:a.family+","+a.fontWithFallbacks,fontSize:parseInt(a.size,10)<=28?a.size:"28px",fontStyle:a.style};return b},isExpanded:function(){return this.refs.dropdown.isExpanded()},render:c,isCustom:function(){return!b.some(this.props.stylesMap,{cssClass:this.props.value})}})});define("textControls/comps/textPopup.rt",["react","lodash","textControls/comps/iconButton"],function(a,b,c){"use strict";return function(){return a.createElement("div",{className:"text-popup-control"},a.createElement("span",{},a.createElement(c,{ref:"popupButton",isSelected:this.state.popupOpen,style:{width:this.props.width},onClick:this.togglePopup,popupMode:true,name:this.props.iconName},this.props.label?a.createElement("span",{key:"textPopupLabel"},this.props.label):null)),a.createElement("div",{className:"tri with-shadow",style:{visibility:this.state.popupOpen?"visible":"hidden"}}),a.createElement("div",{className:"text-popup with-shadow",ref:"popupContainer",style:{visibility:this.state.popupOpen?"visible":"hidden"}},a.createElement("span",{},this.props.children)),a.createElement("div",{className:"tri cover-shadow",style:{visibility:this.state.popupOpen?"visible":"hidden"}}))}});define("textControls/comps/textPopup",["reactDOM","react","lodash","util","textControls/comps/textPopup.rt"],function(a,b,c,d,e){"use strict";return b.createClass({displayName:"textPopup",propTypes:{label:b.PropTypes.string,iconName:b.PropTypes.string,width:b.PropTypes.number},mixins:[d.outerClickMixin],getInitialState:function(){return{popupOpen:false}},togglePopup:function(){var a=!this.state.popupOpen;this.setState({popupOpen:a});if(a){this.setPopupPosition()}},hide:function(){if(this.state.popupOpen){this.setState({popupOpen:false})}},onOuterClick:function(){this.hide()},setPopupPosition:function(){var b=a.findDOMNode(this.refs.popupButton).getBoundingClientRect();if(this.refs.popupContainer){var c=a.findDOMNode(this.refs.popupContainer);var d=0-c.getBoundingClientRect().width/2;var e=b.height+10;c.style.setProperty("bottom",e+"px");c.style.setProperty("right",d+"px")}},render:e})});define("textControls/comps/lineHeight.rt",["react","lodash","baseUI"],function(a,b,c){"use strict";function d(a){this.selectionChange(a)}return function(){return a.createElement("div",{className:"control-line-height"},this.props.infoText||this.props.infoTitle?a.createElement(c.infoIcon,{key:"lineHeightInfo",title:this.props.infoTitle,text:this.props.infoText}):null,a.createElement(c.radioButtons,{value:this.getSelectedOption(),label:"text_editor_line_spacing_label",onChange:d.bind(this),options:this.props.options}),a.createElement("div",{style:{display:b.isNumber(this.state.value)?"block":"none"}},a.createElement(c.slider,{value:this.props.value,min:.5,max:3,stepperMax:9,stepperStep:.01,step:.1,onChange:this.handleSliderChange,onSlideEnd:this.props.onSlideEnd})))}});define("textControls/comps/lineHeight",["react","lodash","textControls/comps/lineHeight.rt","baseUI"],function(a,b,c,d){"use strict";return a.createClass({displayName:"lineHeight",render:c,mixins:[d.inputMixin],propTypes:{infoText:a.PropTypes.string,infoTitle:a.PropTypes.string,options:a.PropTypes.arrayOf(a.PropTypes.shape({label:a.PropTypes.string.isRequired,value:a.PropTypes.string.isRequired})),label:a.PropTypes.string,value:a.PropTypes.oneOfType([a.PropTypes.string,a.PropTypes.number])},getInitialState:function(){var a=this.getValueFromProps();return{value:a}},getDefaultProps:function(){return{options:[{value:"auto",label:"text_editor_line_spacing_automatic"},{value:"custom",label:"text_editor_line_spacing_customize"}]}},getSelectedOption:function(){var a=this.state.value==="auto"?"auto":"custom";return a},handleSliderChange:function(a){this.handleControlChange(a)},selectionChange:function(a){if(a==="auto"){this.handleControlChange(a)}else{this.handleControlChange(1.2)}},handleControlChange:function(a){if(b.isNumber(a)){this.setState({value:a})}this.callOnChangeIfExists(a)},componentWillReceiveProps:function(a){var b=this.getValueFromProps(a);if(this.getValueFromProps(this.props)!==b){this.setState({value:b})}}})});define("textControls/comps/iconsDropDown.rt",["react","lodash","baseUI"],function(a,b,c){"use strict";function d(b,d){return a.createElement(c.dropDown.option,{value:b,className:"icons-dd-option",key:d},a.createElement(c.symbol,{name:d}))}return function(){return a.createElement(c.tooltip,{value:this.props.tooltipValue,disabled:!this.props.tooltipValue,styleType:this.props.tooltipStyleType},a.createElement("div",{style:{display:"inline-block",verticalAlign:"middle"}},a.createElement.apply(this,[c.dropDown.select,{ref:"dropdown",shouldTranslate:false,value:this.props.value,onChange:this.props.onChange,className:"icons-dd "+this.props.className,optionsWidth:56,template:this.props.fixedIconName?this.getFixedIcon:undefined,doNotFocus:this.props.doNotFocus},b.map(this.props.items,d.bind(this))])))}});define("textControls/comps/iconsDropDown",["react","lodash","textControls/comps/iconsDropDown.rt","baseUI"],function(a,b,c,d){"use strict";return a.createClass({displayName:"iconsDropDown",propTypes:{fixedIconName:a.PropTypes.string},render:c,getFixedIcon:function(){if(this.props.fixedIconName){return a.createElement(d.symbol,{name:this.props.fixedIconName})}},isExpanded:function(){return this.refs.dropdown.isExpanded()}})});define("textControls/comps/textBackgroundColor.rt",["react","lodash","textControls/comps/colorDrop","textControls/comps/textColor","textControls/utils/constants","baseUI"],function(a,b,c,d,e,f){"use strict";function g(){this.props.onClick()}function h(b,c){return a.createElement(f.dropDown.option,{value:b,className:"icons-dd-option",key:c},a.createElement(f.symbol,{name:c}))}return function(){return a.createElement("span",{},!this.shouldRenderDropOwn()?a.createElement(d,{onClick:g.bind(this),tooltipValue:this.props.tooltipValue,key:"backColorButton",tooltipStyleType:this.props.tooltipStyleType,isBackColor:true,value:this.props.color}):null,this.shouldRenderDropOwn()?a.createElement(f.tooltip,{value:this.props.tooltipValue,styleType:this.props.tooltipStyleType,key:"backColorDropdown"},a.createElement("span",{},a.createElement.apply(this,[f.dropDown.select,{ref:"dropdown",shouldTranslate:false,value:this.getDropDownValue(),onChange:this.handleChange,className:"back-color-dd",optionsWidth:40,toggleIcon:false,template:this.getTemplate,setSelectedAnyway:true,doNotFocus:this.props.doNotFocus},b.map(e.TEXT_BACK_COLOR_TYPES,h.bind(this)),this.props.colorDrop?a.createElement(f.dropDown.option,{key:"colorDropOption",value:"customColor",className:"icons-dd-option"},a.createElement(c,{colorDropOnly:true,fill:this.props.color})):null]))):null)}});define("textControls/comps/textBackgroundColor",["react","lodash","textControls/comps/textBackgroundColor.rt","baseUI","textControls/comps/colorDrop"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"backColorDropDown",render:c,getDefaultProps:function(){return{colorDrop:true}},shouldRenderDropOwn:function(){return this.props.color!==null},getDropDownValue:function(){return this.props.color===null?"noColor":"customColor"},getTemplate:function(){return a.createElement(e,{fill:this.props.color,isBackColor:true})},handleChange:function(a){if(a==="noColor"&&this.props.handleNoColor){this.props.handleNoColor()}if(a==="customColor"&&this.props.onClick){this.props.onClick()}},isExpanded:function(){return this.refs.dropdown.isExpanded()}})});define("textControls/comps/textLinkControl.rt",["react","lodash","baseUI"],function(a,b,c){"use strict";return function(){return a.createElement("span",{},!this.shouldRenderDropDown()?a.createElement(c.toggleButton,b.assign({},{key:"linkToggleButton"},this.props)):null,this.shouldRenderDropDown()?a.createElement(c.tooltip,{value:this.props.tooltipValue,styleType:this.props.tooltipStyleType,key:"textLinkDropdown"},a.createElement("span",{},a.createElement(c.dropDown.select,{ref:"dropdown",shouldTranslate:false,onChange:this.handleChange,className:"text-link-dd",optionsWidth:40,toggleIcon:false,value:"link",setSelectedAnyway:true,onExpand:this.props.onExpand,doNotFocus:true},a.createElement(c.dropDown.option,{value:"unlink",className:"link-dd-option"},a.createElement("div",{className:"link-icon-container"},a.createElement(c.symbol,{name:"textUnlink",key:"textUnlink"}))),a.createElement(c.dropDown.option,{value:"link",className:"link-dd-option"},a.createElement("div",{className:"link-icon-container"},a.createElement(c.symbol,{name:"textLink",key:"textLink"})))))):null)}});define("textControls/comps/textLinkControl",["react","lodash","textControls/comps/textLinkControl.rt"],function(a,b,c){"use strict";return a.createClass({displayName:"textLinkControl",render:c,shouldRenderDropDown:function(){return this.props.value===true&&!this.props.disabled},handleChange:function(a){if(a==="unlink"){this.props.onUnlink()}else if(a==="link"){this.props.onChange()}},isExpanded:function(){return this.refs.dropdown.isExpanded()}})});define("textControls/comps/textToolBar.rt",["react","lodash","textControls/comps/iconButton","textControls/comps/textColor","textControls/comps/fontFamily","textControls/comps/textStyle","textControls/comps/textPopup","textControls/comps/lineHeight","textControls/comps/iconsDropDown","textControls/comps/textBackgroundColor","textControls/comps/textLinkControl","textControls/utils/constants","baseUI","experiment"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){"use strict";function o(a,b){this.execFormatBlockCommand(b)}function p(a,b){this.changeFontFamily(b)}function q(a,b){this.execCommand("fontSize",b+"px")}function r(a){this.openColorPicker(true)}function s(a){this.handleColorClick(false)}function t(a){this.execCommand("resetThemeAndStyles")}function u(a){this.toggleToolbar()}function v(a,b){this.changeAlignment(b)}function w(a,b){this.execListCommand(b)}function x(a){this.execCommand("outdent")}function y(a){this.execCommand("indent")}function z(a,b){this.execLineHeightCommand(b)}function A(a,b){this.execCommand("letterSpacing",b+"em")}function B(a){this.execCommand("bidiltr")}function C(a){this.execCommand("bidirtl")}function D(){var n=m.uiConstants.TOOLTIP.STYLE_TYPE.SMALL;return a.createElement("div",{className:"rich-text-toolbar",key:"richTextToolBar"},a.createElement("section",{},a.createElement(f,{value:this.getFormatBlockValue(),themeColors:this.props.themeColors,ref:"textStyle",tooltipStyleType:n,themeFonts:this.props.themeFonts,toolbarMode:true,hasSmallArrow:true,tooltipValue:"text_editor_theme_label",optionsWidth:264,onChange:o.bind(this,n)}),a.createElement(e,{ref:"fontFamily",tooltipStyleType:n,value:this.getValue("fontFamily"),onChange:p.bind(this,n),tooltipValue:"text_editor_font_label",fonts:this.props.fonts,toolbarMode:true}),a.createElement(g,{label:this.getValue("fontSize")+" px",width:71,ref:"fontSizePopUp"},a.createElement(m.slider,{label:"text_editor_font_size_label",id:"font-size-slider",value:this.getValue("fontSize"),min:6,max:176,stepperMax:999,onChange:q.bind(this,n),onSlideEnd:this.focus})),a.createElement(m.toggleButton,this.getBoldProps()),a.createElement(m.toggleButton,this.getItalicProps()),a.createElement(m.toggleButton,this.getUnderlineProps()),a.createElement(d,{value:this.getForeColorValue(),onClick:r.bind(this,n),tooltipValue:this.getTooltipValue("text_color"),tooltipStyleType:n,ref:"foreColorButton"}),a.createElement(j,{ref:"backColorButton",color:this.getBackColorValue(),onClick:s.bind(this,n),handleNoColor:this.execNoBackColor,tooltipValue:this.getTooltipValue("text_highlight"),tooltipStyleType:n}),a.createElement(k,b.assign({},{ref:"linkDropdownOption",key:"linkDropdownOption",tooltipStyleType:n},this.getLinkProps())),a.createElement(c,{onClick:t.bind(this,n),name:"textRemoveFormat",tooltipValue:"text_editor_reset_button",tooltipStyleType:n}),a.createElement("span",{className:"expand-toolbar-button",onClick:u.bind(this,n)},!this.state.extraToolbarOpened?a.createElement("span",{className:"more-text",key:"richTextToolBarMore"},a.createElement(m.symbol,{name:"accordionClose"}),a.createElement("span",{},this.translateIfNeeded("list_dbe_edit_item_text_toolbar_more"))):null,this.state.extraToolbarOpened?a.createElement("span",{className:"less-text",key:"richTextToolBarLess"},a.createElement(m.symbol,{name:"accordionOpen"}),a.createElement("span",{},this.translateIfNeeded("list_dbe_edit_item_text_toolbar_less"))):null)),this.state.extraToolbarOpened?a.createElement("div",{key:"richTextToolBarDivider",className:"toolbar-divider"}):null,this.state.extraToolbarOpened?a.createElement("section",{key:"richTextToolBarExtraControls"},a.createElement(i,{ref:"textAlign",className:"align-dd",value:this.getTextAlignment(),onChange:v.bind(this,n),items:l.ALIGNMENT_TYPES,tooltipValue:this.getTooltipValue("alignment"),tooltipStyleType:n}),a.createElement(i,{ref:"textBullets",className:"bullets-dd",value:this.getListType(),onChange:w.bind(this,n),items:this.getBulletsItems(),tooltipValue:this.getTooltipValue("bullets_and_numbering"),tooltipStyleType:n,fixedIconName:this.getBulletsIconName()}),a.createElement(c,{onClick:x.bind(this,n),name:this.getBooleanValue("bidiltr")?"textOutdentLeft":"textOutdentRight",tooltipValue:this.getTooltipValue("decrease_indent"),tooltipStyleType:n}),a.createElement(c,{onClick:y.bind(this,n),name:this.getBooleanValue("bidiltr")?"textIndentLeft":"textIndentRight",tooltipValue:this.getTooltipValue("increase_indent"),tooltipStyleType:n}),a.createElement(g,{iconName:"textLineHeight",ref:"lineHeightPopUp"},a.createElement(h,{
value:this.getLineHeightValue(),onChange:z.bind(this,n),onSlideEnd:this.focus})),a.createElement(g,{iconName:"textCharSpacing",ref:"charSpacingPopUp"},a.createElement(m.slider,{value:this.getLetterSpacingValue(),min:-.1,max:.7,stepperMin:-.4,stepperMax:3,step:.05,stepperStep:.01,onChange:A.bind(this,n),label:"text_editor_character_spacing_label",onSlideEnd:this.focus})),this.getBooleanValue("bidirtl")?a.createElement(c,{onClick:B.bind(this,n),key:"richTextWriteLTR",name:"textWriteDirectionLeft",tooltipValue:this.getTooltipValue("text_direction"),tooltipStyleType:n}):null,this.getBooleanValue("bidiltr")?a.createElement(c,{onClick:C.bind(this,n),key:"richTextWriteRTL",name:"textWriteDirectionRight",tooltipValue:this.getTooltipValue("text_direction"),tooltipStyleType:n}):null):null)}return function(){return!this.props.hideToolbar?D.apply(this,[]):null}});define("textControls/comps/textToolBar",["reactDOM","react","lodash","jquery","util","textControls/mixins/textEditorMixin","textControls/mixins/textTooltipMixin","baseUI","textControls/comps/textToolBar.rt"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(a){return c.some(a,function(a){return a&&a.isExpanded()})}return b.createClass({displayName:"textToolBar",mixins:[e.translationMixin,f,g,h.inputMixin],render:i,getInitialState:function(){this.richTextInput=this.props.richTextInput;return{extraToolbarOpened:false}},componentWillUnmount:function(){if(this.state.extraToolbarOpened){this.changeRichTextHeight(false)}},isAnyDropdownOpen:function(){return j([this.refs.textStyle,this.refs.fontFamily,this.refs.textBullets,this.refs.textAlign,this.refs.backColorButton&&this.refs.backColorButton.refs.dropdown,this.refs.linkDropdownOption&&this.refs.linkDropdownOption.refs.dropdown])},toggleToolbar:function(){var a=!this.state.extraToolbarOpened;this.setState({extraToolbarOpened:a});this.changeRichTextHeight(a)},getColorPickerPosition:function(b){var c=b?a.findDOMNode(this.refs.foreColorButton):a.findDOMNode(this.refs.backColorButton);var e=d(c).offset();var f=e.top-d(window.document).scrollTop();var g=e.left;return{top:f<=370?f+40:f-370,left:g}},changeRichTextHeight:function(a){var b=this.richTextInput.editor.getResizable().getSize("height");if(a){b-=50}else{b+=50}this.richTextInput.editor.resize("100%",b)}})});define("textControls/comps/richTextInput.rt",["react","lodash","textControls/comps/textToolBar","baseUI"],function(a,b,c,d){"use strict";return function(){return a.createElement("div",{className:this.getClassName("rich-text-input-control")+" "+(this.props.hideToolbar?"":"with-toolbar")+" "+(this.props.isResizing?"resizing":""),style:this.props.layout,ref:"textStyle"},!this.props.hideToolbar?a.createElement(c,b.assign({},{key:"textToolbar",ref:"toolbar",richTextInput:this},this.getToolbarProps())):null,a.createElement("div",{className:"rich-text-content"},a.createElement("div",{ref:"editorContainer"})))}});define("textControls/utils/textLimitsUtils",["lodash","textControls/utils/ckUtils","panels","textControls/utils/constants"],function(a,b,c,d){"use strict";var e="panels.focusPanels.createNewTextBoxPanel";var f;function g(a){return a>d.MAX_TEXT_LENGTH}function h(a){return Math.max(a,f)>f}function i(d){a.defer(function(){b.execUndoCommand(d);b.setCkReadOnly(d,true,true)});j(d);c.panelManager.openPanel(e,{isSingleInstance:true},true);c.panelManager.registerObserver(f);function f(){if(k(e)){b.setCkReadOnly(d,false,true);b.focus(d);c.panelManager.unregisterObserver(f)}}}function j(a){a.on("key",function a(b){if(k(e)){b.removeListener()}else if(b.data.keyCode===27){c.panelManager.closePanelByName(e);b.removeListener()}})}function k(){return!a.find(c.panelManager.getOpenPanels(),{name:e})}function l(a){f=a}function m(a){return g(a)&&h(a)}return{handleTextLengthExceeded:i,setCachedTextReadableLength:l,isNewTextLengthLimitExceeded:m}});define("textControls/comps/richTextInput",["reactDOM","react","lodash","textControls/utils/richTextManager","textControls/comps/richTextInput.rt","util","textControls/utils/ckUtils","textControls/utils/constants","textControls/utils/fontUtils","textControls/utils/dataUtils","textControls/utils/textLimitsUtils","experiment"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";var m=false;var n=l.isOpen("se_fontsRefactor");return b.createClass({displayName:"richTextInput",render:e,mixins:[f.outerClickMixin,f.valueLinkMixin],propTypes:{colorPickerPanelName:b.PropTypes.string,documentType:b.PropTypes.string.isRequired,fonts:b.PropTypes.array.isRequired,hideToolbar:b.PropTypes.bool,isFixedHeight:b.PropTypes.bool,isFocusOnInit:b.PropTypes.bool,isTextEditorOpen:b.PropTypes.bool,languages:b.PropTypes.array.isRequired,linkDialogPanelName:b.PropTypes.string,onFocus:b.PropTypes.func,onBlur:b.PropTypes.func,openLinkDialog:b.PropTypes.func.isRequired,openColorPicker:b.PropTypes.func.isRequired,panelManager:b.PropTypes.object.isRequired,selectAllOnInit:b.PropTypes.bool,shouldLimitTextLength:b.PropTypes.bool,testCKContainer:b.PropTypes.object,themeColors:b.PropTypes.object.isRequired,themeFonts:b.PropTypes.object.isRequired,nonPasteableLinkTypes:b.PropTypes.object},getClassName:function(a){return f.inheritClassName(this.props,a)},getToolbarProps:function(){return c.assign({},c.pick(this.props,["themeColors","themeFonts","fonts","hideToolbar"]))},showScroll:function(){g.removeOverflowCss(this.editor)},hideScroll:function(){g.setOverflowCss(this.editor);g.scrollCkToTop(this.editor)},onOuterClick:function(){if(!this.props.hideToolbar&&this._isFocused&&!this.isAnySubPanelOpen()){this._isFocused=false;if(this.props.onBlur){this.props.onBlur();if(this.editor.focusManager){this.editor.focusManager.blur(true)}}}},handleFocus:function(){if(this.props.hideToolbar&&!this._isFocused){this._isFocused=true;if(this.props.onFocus){this.props.onFocus()}}},isAnySubPanelOpen:function(){return this.isColorPickerOpen||this.isLinkDialogOpen||this.refs.toolbar.isAnyDropdownOpen()},handleHeightChange:function(a){if(this.isReadyAndVisible()&&c.isFunction(this.props.onHeightChange)){this.props.onHeightChange(a)}},handleCKCreated:function(){if(this.props.onShow){this.props.onShow(this.showEditor)}else{this.showEditor()}},fontsDataGetter:function(a){var b=i.getFontsUrlWithParams(a,this.props.documentType,this.props.languages);return{fonts:a,urls:[b]}},createCK:function(){if(g.isCKLoaded()){var b=j.wrapOrphans(this.getValueFromProps().text);this.editor=g.createCKInstance({handleDataChange:this.handleDataChange,handleHeightChange:this.handleHeightChange,handleSelectionChange:this.handleSelectionChange,handleCKCreated:this.handleCKCreated,handleFocus:this.handleFocus,handlePaste:this.fixLinks,handleCutOrCopy:this.onCutOrCopy},this.props.testCKContainer||a.findDOMNode(this.refs.editorContainer),this.props.isFixedHeight,b,h.DEFAULT_STYLES_MAP,this.props,this.fontsDataGetter)}else{setTimeout(this.createCK,50)}},onCutOrCopy:function(){d.latestCopiedLinks=c.clone(this._links)},focus:function(){g.focus(this.editor)},selectAll:function(){g.selectAll(this.editor)},showEditor:function(){this.editor.container.show();if(this.props.isFocusOnInit){this.focus()}if(this.props.selectAllOnInit){this.selectAll()}},getDefaultProps:function(){return{isFocusOnInit:true}},findCopiedLinkById:function(a){return c.find(d.latestCopiedLinks,{id:a})},hasLink:function(a){return c.find(this._links,{id:a})},cloneLink:function(a){var b=c.clone(a);b.id=f.guidUtils.getUniqueId("textLink","_");return b},removeLinkWithDataQuery:function(a,b){var c=new RegExp(""+"(<span .*?text-decoration.*?>)?"+"<a dataquery=['\"]#"+b+"[^>]*>"+"(<span .*?text-decoration.*?>)?"+"(.*?)"+"(</span>)?"+"</a>"+"(</span>)?","m");return a.replace(c,function(a,b,c,d,e,f){var g=d||"";var h=function(a,b,c){if(a&&c){a=a.replace(/text-decoration:underline;?/,"").replace(/style=['"]\s*['"]/,"").replace(/<span\s*>/,"");return a?a+b+c:b}return(a||"")+b+(c||"")};g=h(c,g,e);g=h(b,g,f);return g})},fixPasteInternalLinks:function(a){var b=a.data.pasteString;c.forEach(b.match(/dataquery="#[^"]+/g),function(a){var d=a.split("#")[1];if(this.hasLink(d)){return}var e=this.findCopiedLinkById(d);var f=e&&!c.includes(this.props.nonPasteableLinkTypes,e.type);if(f){b=this.recoverMissingLinkFromCopiedData(b,e,d)}else{b=this.removeLinkWithDataQuery(b,d)}},this);a.data.pasteString=b},recoverMissingLinkFromCopiedData:function(a,b,c){var d=this.cloneLink(b);this._links.push(d);var e=new RegExp("#"+c,"g");return a.replace(e,"#"+d.id)},fixExternalLinks:function(a){var b=a.data.pasteString;var c=""+"(?:"+"(?:\\s+[-_A-Za-z0-9]+"+"(?:\\s*=\\s*"+"(?:"+"(?:\"[^\"]*\")|(?:'[^']*')|[^>\\s]+"+")"+")?"+")*"+")";var d=function(a,b){var c={type:"ExternalLink",target:"_blank",url:a,id:f.guidUtils.getUniqueId("textLink","_")};this._links.push(c);return'<span style="text-decoration:underline"><a dataquery="#'+c.id+'">'+b+"</a></span>"};var e=function(a,b){if(!/^mailto:/i.test(a)){return null}var c=a.replace(/mailto:/i,"").split("?");if(!f.validationExpressions.validEmailReg.test(c[0])){return null}var d=c[0];var e=c[1];if(/^subject=/i.test(e)){e=e.replace(/^subject=/i,"")}else{e=""}var g={type:"EmailLink",recipient:d,subject:e,id:f.guidUtils.getUniqueId("textLink","_")};this._links.push(g);return'<span style="text-decoration:underline"><a dataquery="#'+g.id+'">'+b+"</a></span>"};var g=new RegExp(""+"<a\\s*"+c+"(href\\s*=\\s*('|\")(?:(?!\\2).)+\\2)?"+c+">(.*?)</a>","gim");b=b.replace(g,function(a,b,c,g){if(!b){return g}var h=b.replace(/href\s*=\s*/,"");h=h.substring(1,h.length-1);var i=f.validationExpressions.validUrlReg.test(h);if(i){return d.call(this,h,g)}var j=e.call(this,h,g);return j||g}.bind(this));a.data.pasteString=b},fixLinks:function(a){if(a.data.isExternalSourceData){this.fixExternalLinks(a)}else{this.fixPasteInternalLinks(a)}},lockChangeHandler:function(){m=true},unlockChangeHandler:function(){m=false;this.handleDataChange()},handleDataChange:function(){if(!this.isReadyAndVisible()){return}if(m){return}var a=g.getData(this.editor);if(!c.isEqual(a,this._internalTextValue)){this._internalTextValue=a;this.callOnChangeIfExists({text:a,linkList:this._links});var b=j.getTextContentFromHtml(a).length;if(this.props.shouldLimitTextLength&&k.isNewTextLengthLimitExceeded(b)){k.handleTextLengthExceeded(this.editor)}k.setCachedTextReadableLength(b)}},cacheLinks:function(){if(this.getValueFromProps().linkList){this._links=c.cloneDeep(this.getValueFromProps().linkList)}else{this._links=[]}},shouldComponentUpdate:function(){return!!(this.editor&&this.editor.editable())},componentDidMount:function(){this.createCK();this.fontsMaps=i.calcFontsMaps(this.props.fonts,this.props.documentType);if(this.props.layout&&this.props.layout.height){this.originalHeight=this.props.layout.height}this._internalTextValue=this.getValueFromProps().text;k.setCachedTextReadableLength(j.getTextContentFromHtml(this._internalTextValue).length);this.cacheLinks()},clearUnusedLinks:function(){var a=this;var b=c.remove(a._links,function(b){return!c.includes(a._internalTextValue,'<a dataquery="#'+b.id+'"')});if(b.length>0){this.callOnChangeIfExists({text:this._internalTextValue,linkList:this._links})}},componentWillUnmount:function(){if(g.isEditorReady(this.editor)){this.editor.destroy()}},getSelectionChangeCallbacks:function(){if(!this.selectionChangeCallbacks){this.selectionChangeCallbacks=[]}return this.selectionChangeCallbacks},registerOnSelectionChange:function(a){this.getSelectionChangeCallbacks().push(a)},unregisterOnSelectionChange:function(a){c.remove(this.getSelectionChangeCallbacks(),function(b){return b===a})},handleSelectionChange:function(){c.forEach(this.getSelectionChangeCallbacks(),function(a){a()})},setCkDataFromProps:function(){if(this.isReady()){g.setData(this.editor,this.getValueFromProps().text,h.DEFAULT_STYLES_MAP,this.props);this._internalTextValue=this.getValueFromProps().text}else{setTimeout(function(){this.setCkDataFromProps()}.bind(this),50)}},componentDidUpdate:function(a){if(!n){var b=c.difference(this.props.languages,a.languages);if(b.length>0){var d=i.getWixStoredFontsCss(b);g.loadFontsToCK(this.editor,{urls:d})}if(!c.isEqual(a.themeFonts,this.props.themeFonts)||!c.isEqual(a.themeColors,this.props.themeColors)){g.updateThemeStyles(this.props.themeColors,h.DEFAULT_STYLES_MAP,this.props.themeFonts,this.editor)}}if(n){if(!c.isEqual(a.fontsUrls,this.props.fontsUrls)){g.loadLinksToCK(this.editor,this.props.fontsUrls)}if(!c.isEqual(a.themeFontsCss,this.props.themeFontsCss)||!c.isEqual(a.themeColorsCss,this.props.themeColorsCss)){g.loadColorsAndThemeCssToCK(this.editor,this.props.themeFontsCss,this.props.themeColorsCss)}}if(!c.isEqual(a.fonts,this.props.fonts)){this.fontsMaps=i.calcFontsMaps(this.props.fonts,this.props.documentType)}if(this.isOpeningTextEditor(a)){this.setCkDataFromProps();this.cacheLinks()}if((this.isReady()||this.props.isResizing)&&!c.isEqual(this.props.layout,a.layout)){this.editor.resize(this.props.layout.width,this.props.layout.height);this.editor.config.autoGrow_minHeight=this.props.layout.height;g.refreshHeightConfig()}},isOpeningTextEditor:function(a){return!a.isTextEditorOpen&&this.props.isTextEditorOpen},isReadyAndVisible:function(){return this.isReady()&&this.editor.container.isVisible()},isReady:function(){return g.isEditorReady(this.editor)},resetUndo:function(){g.resetUndo(this.editor)}})});define("textControls/comps/textEffectButton.rt",["react","lodash"],function(a,b){"use strict";return function(){return a.createElement("span",{className:this.props.className},a.createElement("button",{className:b({"text-effect-button":true,selected:this.props.isSelected}).transform(function(a,b,c){if(b){a.push(c)}},[]).join(" "),onClick:this.props.onClick},a.createElement("span",{},this.props.children)))}});define("textControls/comps/textEffectButton",["react","lodash","textControls/comps/textEffectButton.rt"],function(a,b,c){"use strict";return a.createClass({displayName:"textEffectButton",render:c})});define("textControls/comps/textEffects.rt",["react","lodash","textControls/comps/textEffectButton","symbols","baseUI","textControls/utils/constants"],function(a,b,c,d,e,f){"use strict";function g(){this.handleOnChange(f.CK_OFF)}function h(a,b){this.handleOnChange(a.value,b)}function i(b,d){return a.createElement(c,{isSelected:this.props.value===d,onClick:h.bind(this,b,d),key:d,className:d},a.createElement("span",{className:"text-shadow-effect",style:{textShadow:b.value}},this.translateIfNeeded("text_editor_"+d)))}return function(){return a.createElement.apply(this,["div",{className:"text-effect-container"},a.createElement(e.tooltip,{value:"text_editor_effects_tooltip_no_effect",styleType:e.uiConstants.TOOLTIP.STYLE_TYPE.SMALL},a.createElement("span",{onClick:g.bind(this),className:"text-none-icon "+(this.props.value==="EFFECT_0"?"selected":"")})),b.map(this.getShadowEffects(),i.bind(this))])}});define("textControls/comps/textEffects",["react","lodash","textControls/comps/textEffects.rt","util","textControls/utils/constants","baseUI"],function(a,b,c,d,e,f){"use strict";return a.createClass({displayName:"textEffects",mixins:[d.translationMixin,f.reportUIChangeMixin],render:c,getDefaultProps:function(){return{value:"effect_0",onChange:function(){}}},contextTypes:{reportUIChange:a.PropTypes.func},getShadowEffects:function(){var a=e.EFFECTS;if(a.effect_0){delete a.effect_0}return a},handleOnChange:function(a,b){this.props.onChange(a);var c=a===2?"none":b;this.reportUIChange({value:c,control_name:"text_effects"})}})});define("textControls/comps/textLinkButton.rt",["react","lodash","textControls/comps/iconButton"],function(a,b,c){"use strict";return function(){return a.createElement(c,b.assign({},{name:"Link",onClick:this.openLinkDialog},this.props))}});define("textControls/comps/textLinkButton",["react","lodash","textControls/comps/textLinkButton.rt","panels"],function(a,b,c,d){"use strict";return a.createClass({displayName:"textLinkButton",mixins:[d.linkToMixin],render:c})});define("textControls/comps/themeFontsLoader.rt",["react","lodash","experiment"],function(a,b,c){"use strict";function d(b,c){return a.createElement("link",{type:"text/css",key:c,href:b,rel:"stylesheet"})}function e(b,c){return a.createElement("style",{key:c,dangerouslySetInnerHTML:{__html:b.fontFace}})}function f(b,c){return a.createElement("style",{key:c,dangerouslySetInnerHTML:{__html:this.createUploadedFontFace(b)}})}return function(){return a.createElement.apply(this,["div",{},b.map(this.getCssLinks(),d.bind(this)),c.isOpen("fontsUpload")?b.map(this.state.uploadedFonts,e.bind(this)):null,c.isOpen("fontsUpload")?b.map(this.getUploadedThemeFonts(this.props.themeFonts),f.bind(this)):null])}});define("textControls/comps/themeFontsLoader",["react","lodash","textControls/utils/fontUtils","core","experiment","util","textControls/comps/themeFontsLoader.rt"],function(a,b,c,d,e,f,g){"use strict";var h=e.isOpen("fontsUpload");return a.createClass({displayName:"themeFontsLoader",mixins:[d.mixins.editorAPIMixin],getCssLinks:function(){if(e.isOpen("se_fontsRefactor")){return this.getEditorAPI().fonts.css.getUrls()}return c.getAllCssLinks(this.props.languages,this.props.documentType,this.props.themeFonts)},render:g,shouldComponentUpdate:function(a,c){return!b.isEqual(a,this.props)||!b.isEqual(c,this.state)},getInitialState:function(){if(h){this.fontsManager=this.getEditorAPI().mediaServices.fontsManager;return{uploadedFonts:this.fontsManager.getList()}}return{}},onUploadedFontsChange:function(a){if(a){this.setState({uploadedFonts:a})}},componentWillMount:function(){if(h){this.fontsManager.registerObserver(f.fontsManagerUtils.constants.FONT_EVENTS_NAMES.LIST_CHANGED,this.onUploadedFontsChange)}},componentWillUnmount:function(){if(h){this.fontsManager.unregisterObserver(f.fontsManagerUtils.constants.FONT_EVENTS_NAMES.LIST_CHANGED,this.onUploadedFontsChange)}},createUploadedFontFace:function(a){return c.getUploadedFontFace([a])},getUploadedThemeFonts:function(){if(h){return b.filter(c.getThemeFontFamilies(this.props.themeFonts),function(a){return c.isUploadedFont(a)})}return{}}})});define("textControls/comps/saveTextStyleConfirmation.rt",["react","lodash","panels","baseUI"],function(a,b,c,d){"use strict";return function(){return a.createElement(c.frames.focusPanelFrame,{ref:"frame",key:"saveTextConfirmationPanel",helpId:"1df23b96-45a4-41e0-b356-e1ee05308c9b",className:"text-style-save-confirm-panel",title:this.translateIfNeeded("text_editor_save_theme_dialog_header"),panelName:this.props.panelName},a.createElement("div",{className:"text-style-save-confirm-content"},a.createElement("div",{className:"image-container",key:"save-your-theme-clipart"},a.createElement(d.symbol,{name:"save-your-theme-clipart"})),a.createElement("div",{className:"description-container"},a.createElement("span",{className:"description-text"},this.translateIfNeeded("text_editor_save_theme_dialog_text_1")),a.createElement("span",{className:"description-text bold"}," '",this.props.textStyleName,"' "),a.createElement("span",{className:"description-text"},this.translateIfNeeded("text_editor_save_theme_dialog_text_2")),a.createElement("div",{className:"learn-more-link-container"},a.createElement("a",{className:"learn-more-link",onClick:this.openLearnMore},this.translateIfNeeded("text_editor_save_theme_dialog_learn_more")))),a.createElement("div",{className:"footer-buttons"},a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:true,key:"dontShowAgainCheckbox",label:"text_editor_save_theme_dialog_dont_show",valueLink:this.linkDontShowAgainValue()}),a.createElement(d.button,{onClick:this.handleOnSave,className:"save-button btn-md",label:"text_editor_save_theme_confirm_button"}))))}});define("textControls/comps/saveTextStyleConfirmation",["react","panels","util","core","textControls/comps/saveTextStyleConfirmation.rt"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"saveTextStyleConfirmation",propTypes:{editorAPI:a.PropTypes.object.isRequired,panelName:a.PropTypes.string.isRequired,dontShowAgainKey:a.PropTypes.string.isRequired,onConfirm:a.PropTypes.func.isRequired,textStyleName:a.PropTypes.string.isRequired,userPrefType:a.PropTypes.oneOf(["site","session","global"])},mixins:[c.translationMixin,d.mixins.editorAPIMixin,b.mixins.reportBiEventOnUiChangeMixin,b.mixins.dontShowAgainMixin],getDefaultProps:function(){return{userPrefType:"session"}},getInitialState:function(){return{dontShowAgain:this.getDontShowAgain()}},handleOnSave:function(){this.props.onConfirm();this.close()},close:function(){b.panelManager.closePanelByName(this.props.panelName)},openLearnMore:function(){var a={panel_name:this.props.panelName,origin:d.constants.BI.HELP.ORIGIN.PANEL,component:this.props.editorAPI.selection.getSelectedComponentType(),learn_more:true};var c="1df23b96-45a4-41e0-b356-e1ee05308c9b";b.panelManager.openHelpCenter(c,null,a)},render:e})});define("textControls/utils/mobileUtils",["lodash","jquery","textControls/utils/fontUtils"],function(a,b,c){"use strict";function d(a,b){var c={};var d=window.document.createElement("div");d.innerHTML=a;g(d,c,b,"");return parseInt(f(c),10)}function e(b){return a.isString(b)&&a.get(b.match(/text\-align:\s((left|center|right|justify))/),1,"left")}function f(b){var c;var d="";a.forEach(b,function(a,b){if(c===undefined||c<a){c=a;d=b}});return d}function g(b,c,d,e){if(b.nodeName==="#text"){return}e=h(b,d)?h(b,d):e;a.forEach(b.childNodes,function(a){if(a.nodeName==="#text"){if(e){var b=a.textContent.replace(/ /g,"").length;if(!c[e]){c[e]=0}c[e]+=b}}else{g(a,c,d,e)}})}function h(d,e){var f=b(d).css("fontSize");if(!f){a.forEach(d.classList,function(a){if(e[a]){f=c.parseStyleFont(a,e).size}})}return f}return{getMostCommonTextSize:d,getFirstTextAlignment:e}});define("textControls/utils/textMigrationDomHelper",["lodash","jquery"],function(a,b){"use strict";var c=["audio","dd","dt","li","video","address","article","aside","blockquote","details","div","dl","fieldset","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","menu","nav","ol","p","pre","section","table","ul","center","dir","noframes"];function d(a){if(a===null){return"null"}if(a.$family){return a.$family()}if(a.nodeName){if(a.nodeType===1){return"element"}if(a.nodeType===3){return/\S/.test(a.nodeValue)?"textnode":"whitespace"}}else if(typeof a.length==="number"){if(a.callee){return"arguments"}if("item"in a){return"collection"}}return typeof a}function e(b){var c=b.attributes;var d=[];if(c.length<20){d=g(c)}else{var e=b.getProperties("class","style","dir","href","background","action","src","data","align","alt","color","face","label","for","link","id","name","value");a.forEach(e,function(a,b){if(b&&a){d.push({name:b,value:a})}})}return d}function f(a,b){if(a===b){return}var c;while(c=a.firstChild){b.appendChild(a.removeChild(c))}}function g(a){function b(a){var b=[];for(var c=a.length;c--;){b.unshift(a[c])}return b}return b(a)}function h(b,c){if(b.tagName.toLowerCase()===c.toLowerCase()){return b}var d=window.document.createElement(c);var g=e(b);a.forEach(g,function(a){d.setAttribute(a.name,a.value)});f(b,d);if(b.parentNode){b.parentNode.replaceChild(d,b)}return d}function i(b){var d=b.tagName&&b.tagName.toLowerCase();return a.includes(c,d)}function j(a){return a.every(function(a){return d(a)==="whitespace"})}function k(a){return d(a)==="element"}function l(a){return d(a)==="textnode"}function m(b){return a.some(b.children,i)}function n(b){var c=b.parentNode;var d=g(b.childNodes);a.forEach(d,function(a){c.insertBefore(a,b)});c.removeChild(b)}function o(a){var b=e(a);if(!b){return false}for(var c=0;c<b.length;c++){var d=b[c].value;if(d){return true}}return false}function p(a,c){var d=b(a);d.removeClass(c);if(d.prop("class").length===0){d.removeAttr("class")}}function q(a,c){b(a).css(c);var d=a.getAttribute("style");if(d&&d.charAt(d.length-1)===" "){a.setAttribute("style",d.substr(0,d.length-1))}}return{moveChildren:f,collectionToArray:g,isBlockElement:i,hasBlockElementChildren:m,isDomElement:k,isTextNode:l,isElementHasAttributes:o,replaceElementWithItsChildren:n,renameNode:h,isOnlyWhiteSpace:j,removeClass:p,setStyle:q}});define("textControls/utils/textMigrationStylesHelper",["jquery","lodash","textControls/utils/textMigrationDomHelper","textControls/utils/fontUtils"],function(a,b,c,d){"use strict";function e(a){return b.find(a.classList,function(a){return b.includes(a,"font_")})||null}function f(b,d){if(e(b)){return b}var g=a(b).clone();g.empty();var i=c.collectionToArray(b.childNodes);for(var j=0;j<i.length;j++){var k=i[j];if(!e(k)&&!h(k)){a(d).append(a(k))}else{var l=a(k).clone();l.empty();var m=f(k,l.get(0));g.append(a(m));if(l.get(0).firstChild){a(d).append(l)}return g.get(0)}}return g.get(0)}function g(b){if(!h(b)){return}var d=a(b).clone(false);d.empty();var i=c.collectionToArray(b.childNodes);for(var k=0;k<i.length;k++){var l=i[k];if(!e(l)&&!h(l)){d.append(a(l))}else{var m=a(l).clone(false);m.empty();var n=f(l,m);if(m.get(0).firstChild){d.append(m)}a(b).before(d);a(b).before(a(n));j(n);g(b);return}}}function h(b){return c.isDomElement(b)&&a(b).find('span[class*="font_"]').length}function i(a,d){if(c.isDomElement(a)){var f=e(a);if(f&&a.tagName.toLowerCase()==="span"){d.push(a)}else{b.forEach(a.children,function(a){d.concat(i(a,d))})}}return d}function j(a){if(e(a)){g(a)}if(!h(a)){return}var c=i(a,[]);b.forEach(c,g)}function k(a){if(c.isTextNode(a)){return true}if(e(a)){return false}var b=c.collectionToArray(a.childNodes);for(var d=0;d<b.length;d++){if(k(b[d])){return true}}return false}function l(a){var c=0;var d=null;b.forEach(a,function(a,b){if(a>c){c=a;d=b}});return d}function m(a){var c={};b.forEach(a,function(a){var b=e(a);c[b]=c[b]||0;c[b]+=a.textContent.length});return l(c)}function n(a,b,c,e){var f=a&&d.parseStyleFont(a,c,e);var g=d.parseStyleFont(b,c,e);if(!g){return null}if(!f||f.color!==g.color){if(g.color.charAt(0)==="#"){return{isRef:false,value:g.color}}return{isRef:true,value:g.color.replace("{","").replace("}","")}}return null}var o={"font-family":"family","font-size":"size","font-style":"style","font-variant":"variant","font-weight":"weight","line-height":"lineHeight"};function p(a,c,e,f){var g=a&&d.parseStyleFont(a,e,f);var h=d.parseStyleFont(c,e,f);var i={};b.forEach(o,function(a,b){if(!g||g[a]!==h[a]){i[b]=h[a]}});return i}return{flattenStyledSpans:j,isBlockContainUnstyledText:k,getStyledSpansRecursive:i,getMostCommonStyle:m,getElementStyleClass:e,getStyleDelta:p,getColorDelta:n}});define("textControls/utils/textStylesMigration",["lodash","jquery","textControls/utils/textMigrationDomHelper","textControls/utils/textMigrationStylesHelper","textControls/utils/fontUtils","textControls/utils/constants"],function(a,b,c,d,e,f){"use strict";var g=["h1","h2","h3","h4","h5","h6","p","div"];var h=["font_1","font_10"];var i=a.transform(f.DEFAULT_STYLES_MAP,function(a,b){a[b.cssClass]=b.seoTag});function j(b,e,f,g){a.forEach(e,function(a){var e=d.getElementStyleClass(a);if(e===b){if(a.childNodes.length===0){a.remove()}else{k(a,b)}}else{c.removeClass(a,e);l(b,e,a,f,g)}})}function k(a,d){b(a).removeClass(d);if(!c.isElementHasAttributes(a)){c.replaceElementWithItsChildren(a)}}function l(a,e,f,g,h){var i=d.getStyleDelta(a,e,g,h);var j=f;c.setStyle(j,i);var k=d.getColorDelta(a,e,g,h);if(!k){return}if(k.isRef){b(j).addClass(k.value)}else{c.setStyle(j,{color:k.value})}}function m(b,d,f,g){var h;if(a.includes(a.keys(f),d)){var i=e.parseStyleFont(d,f,g);h=i.lineHeight;c.setStyle(b,{"line-height":h});n(b,h);b=o(b,d)}return b}function n(a,b){var d=window.document.createElement("span");c.setStyle(d,{"line-height":b});c.moveChildren(a,d);a.appendChild(d)}function o(a,b){var d=i[b];return c.renameNode(a,d)}function p(b){return a.includes(h,b)}function q(a){if(p(a)){return f.FALLBACK_STYLE_CLASS}return a}function r(a,c,e){var f=d.getStyledSpansRecursive(a,[]);var g=d.getMostCommonStyle(f);var h=null;if(g){var i=q(g);if(i!==g){h=g;g=i}b(a).addClass(g);j(g,f,c,e);if(h){s(a,g,h,c,e)}return g}return null}function s(a,b,d,f,g){var h=e.parseStyleFont(d,f,g).size;var i=e.parseStyleFont(b,f,g).size;if(h<i){c.setStyle(a,{"font-size":h})}}function t(a,d,e){if(!d||!e){return null}if(a&&a.tagName===d&&a.hasClass(e)){return null}var f=c.renameNode(a,d);b(f).addClass(e);return f}function u(a,b,c,e,f){if(a.childNodes.length===0){return}d.flattenStyledSpans(a);var g=null;if(d.isBlockContainUnstyledText(a)){var h=t(a,b,c);var i=d.getStyledSpansRecursive(h,[]);j(null,i,e,f)}else{g=r(a,e,f);if(g){m(a,g,e,f)}}v(a,g,e,f)}function v(a,c,d,e){var f=b(a).find('span[class*="font_"]');if(f.length){j(c,f,d,e)}}function w(a,d,e,f,g){if(c.isOnlyWhiteSpace(a)){return}var h=window.document.createElement("p");b(a[0]).before(b(h));b(h).append(b(a));u(h,d,e,f,g)}function x(b,d,e,f,h){var i=[];var j=c.collectionToArray(b.childNodes);a.forEach(j,function(b){if(!c.isBlockElement(b)){i.push(b)}else{if(i.length>0){w(i,d,e,f,h);i=[]}var j=!a.includes(g,b.tagName.toLowerCase())||c.hasBlockElementChildren(b);if(j){x(b,d,e,f,h)}else{u(b,d,e,f,h)}}});if(i.length>0){w(i,d,e,f,h)}}return{migrateElement:x,verifyNoStyledSpans:v}});define("textControls/utils/textSimpleFormatMigration",["lodash","jquery","textControls/utils/textMigrationDomHelper","textControls/utils/textMigrationStylesHelper","textControls/utils/constants"],function(a,b,c,d,e){"use strict";function f(a){g(a);h(a);i(a);j(a);k(a);l(a);m(a)}function g(a){var c=b(a).find(".bold");n(c,"bold","strong")}function h(a){var c=b(a).find(".italic");n(c,"italic","em")}function i(a){var c=b(a).find(".underline");n(c,"underline","u")}function j(a){var c=b(a).find(".alignRight");o(c,"alignRight","text-align","right")}function k(a){var c=b(a).find(".alignCenter");o(c,"alignCenter","text-align","center")}function l(a){var c=b(a).find(".alignJustify");o(c,"alignJustify","text-align","justify")}function m(c){var f=b(c).find("ul, ol");a.forEach(f,function(a){if(!d.getElementStyleClass(a)){b(a).addClass(e.DEFAULT_STYLE_CLASS)}})}function n(d,e,f){a.forEach(d,function(a){var d=window.document.createElement(f);c.moveChildren(a,d);c.removeClass(a,e);if(c.isElementHasAttributes(a)||a.nodeName.toLowerCase()!=="span"){b(a).append(b(d))}else{b(a).replaceWith(b(d))}})}function o(b,d,e,f){a.forEach(b,function(a){c.removeClass(a,d);var b={};b[e]=f;c.setStyle(a,b)})}return{migrateElement:f}});define("textControls/utils/textMigrationHandler",["lodash","textControls/utils/textStylesMigration","textControls/utils/textSimpleFormatMigration"],function(a,b,c){"use strict";function d(d,e,f,g,h){g=g||"p";h=h||"font_8";if(!a.isString(d)){return null}if(d===""){return a.template('<<%= defaultTag %> class="<%= defaultClass %>"></<%= defaultTag %>>')({defaultTag:g,defaultClass:h})}var i=window.document.createElement("div");i.innerHTML=d;b.migrateElement(i,g,h,e,f);c.migrateElement(i);return i.innerHTML}return{migrateText:d}});define("textControls/utils/migrationUtils",["lodash","textControls/utils/textMigrationHandler"],function(a,b){"use strict";function c(a,b){var c=b.components.data.get(a);return c.type!=="StyledText"&&c.type!=="MediaRichText"}function d(c,d,e,f,g){var h=b.migrateText(c.text,d,e,f,g);function i(b,c){return!a.includes(["id","metaData"],c)}var j=a.omit(c,i);j.type="StyledText";j.stylesMapId="CK_EDITOR_PARAGRAPH_STYLES";j.text=h;return j}function e(a,b){var c=b.components.data.get(a);c=d(c,b.theme.fonts.getAll(),b.theme.colors.getAll());b.components.data.update(a,c,true);b.components.style.setId(a,"txtNew")}return{isOldTextComponent:c,migrateComponent:e}});define("textControls/mixins/textBiMixin",["core","lodash"],function(a,b){"use strict";return{sendTextBiEvent:function(b,c){this.getEditorAPI().bi.event(a.bi.events.textControls[b],c)},sendTextBiEventWithPanelName:function(a,c){var d=this.constructor.displayName;var e=b.merge({panel_name:d},c);this.sendTextBiEvent(a,e)}}});define("textControls/mixins/textPanelMixin",["core"],function(a){"use strict";return{mixins:[a.mixins.editorAPIMixin],componentDidMount:function(){if(!this.richTextInput){this.getEditorAPI().text.startEditing()}}}});define("textControls",["textControls/comps/richTextInput","textControls/comps/iconButton","textControls/comps/fontFamily","textControls/comps/iconsDropDown","textControls/comps/textBackgroundColor","textControls/comps/textLinkControl","textControls/comps/textStyle","textControls/comps/textColor","textControls/comps/textEffects","textControls/comps/lineHeight","textControls/comps/textLinkButton","textControls/comps/textPopup","textControls/comps/themeFontsLoader","textControls/comps/saveTextStyleConfirmation","textControls/utils/constants","textControls/utils/fontUtils","textControls/utils/dataUtils","textControls/utils/mobileUtils","textControls/utils/shadowUtils","textControls/utils/migrationUtils","textControls/mixins/textTooltipMixin","textControls/mixins/textEditorMixin","textControls/mixins/textBiMixin","textControls/mixins/textPanelMixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){
"use strict";return{textStyle:g,fontFamily:c,iconButton:b,iconsDropDown:d,textBackgroundColor:e,textLinkControl:f,richTextInput:a,textColor:h,textEffects:i,lineHeight:j,textLinkButton:k,textPopup:l,themeFontsLoader:m,constants:o,fontUtils:p,dataUtils:q,mobileUtils:r,shadowUtils:s,textTooltipMixin:u,saveTextStyleConfirmation:n,textEditorMixin:v,migrationUtils:t,textBiMixin:w,textPanelMixin:x}});